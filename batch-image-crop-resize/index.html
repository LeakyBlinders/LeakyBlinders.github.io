<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><script data-goatcounter="https://splungefoo.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script><title>Batch Image Processor</title><meta http-equiv="Cross-Origin-Opener-Policy" content="same-origin"><meta http-equiv="Cross-Origin-Embedder-Policy" content="credentialless"><meta http-equiv="origin-trial" content=""><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet"><style>:root {
            --bg-primary: #0a0a0b;
            --bg-secondary: #151518;
            --bg-tertiary: #1e1e22;
            --accent-primary: #00d9ff;
            --accent-secondary: #7c3aed;
            --text-brighter: #fff;
            --text-primary: #e8e8ea;
            --text-secondary: #a1a1a8;
            --border: #2a2a2f;
            --border-hover: #3a3a40;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            color-scheme: dark;
        }

        .light {
            --bg-primary: #f7f7f8;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f0f0f3;
            --accent-primary: #0ea5e9;
            --accent-secondary: #2563eb;
            --text-brighter: #000;
            --text-primary: #111827;
            --text-secondary: #6b7280;
            --border: #e5e7eb;
            --border-hover: #d1d5db;
            color-scheme: light;
        }

        .no-theme-transition * {
            transition: none !important;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow: hidden;
            height: 100vh;
        }

        body.app-initializing .header,
        body.app-initializing .main-container {
            visibility: hidden;
        }
        
        body.resizing {
            user-select: none;
            cursor: col-resize;
        }

        body.resizing-vertical {
            user-select: none;
            cursor: row-resize;
        }

        html,
        body {
            -webkit-user-select: none;
            user-select: none;
        }
        
        /* Header Bar */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: 16px 18px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 100;
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 0;
        }

        .theme-toggle {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            user-select: none;
        }

        .theme-toggle input {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }

        .theme-toggle-pill {
            width: 36px;
            height: 20px;
            background: var(--border);
            border-radius: 999px;
            position: relative;
            transition: background 0.2s ease;
            flex: 0 0 auto;
        }

        .theme-toggle-pill::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 16px;
            height: 16px;
            background: var(--bg-secondary);
            border-radius: 50%;
            transition: transform 0.2s ease, background 0.2s ease;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.35);
        }

        .theme-toggle input:checked + .theme-toggle-pill {
            background: var(--accent-primary);
        }

        .theme-toggle input:checked + .theme-toggle-pill::after {
            transform: translateX(16px);
            background: #fff;
        }

        .light .theme-toggle-pill {
            background: var(--accent-primary);
        }

        .light .theme-toggle-pill::after {
            transform: translateX(16px);
            background: #fff;
        }

        .theme-toggle-label {
            color: var(--text-secondary);
        }

        .export-progress-wrapper {
            flex: 1;
            margin: 0 32px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .fallback-warning {
            display: none;
            flex: 1;
            align-items: center;
            gap: 12px;
            padding: 8px 12px;
            border-radius: 10px;
            border: 1px solid rgba(245, 158, 11, 0.55);
            background: rgba(245, 158, 11, 0.12);
            color: var(--text-primary);
            font-size: 12px;
            line-height: 1.35;
        }

        .fallback-warning-title {
            font-weight: 700;
            letter-spacing: 0.6px;
            text-transform: uppercase;
            color: var(--warning);
            flex: 0 0 auto;
        }

        .fallback-warning-message {
            font-weight: 600;
            color: var(--text-primary);
        }

        .fallback-warning-message a {
            color: var(--warning);
            text-decoration: underline;
        }

        .fallback-warning-message a:hover {
            color: var(--text-brighter);
        }

        .export-progress {
            flex: 1;
            height: 22px;
            border: 1px solid var(--border);
            background: #2b2f36;
            position: relative;
            overflow: hidden;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .export-progress.active {
            opacity: 1;
        }

        .export-progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            transition: width 0.2s ease;
        }

        .export-progress-text {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            color: #e8e8ea;
            text-shadow: 0 1px 6px rgba(0, 0, 0, 0.45);
            pointer-events: none;
        }

        .export-cancel {
            display: none;
            padding: 6px 12px;
            font-size: 11px;
        }

        body.exporting .export-cancel {
            display: inline-flex;
        }

        body.has-fallback-warning .fallback-warning {
            display: flex;
        }

        body.has-fallback-warning .export-progress {
            display: none;
        }

        body.exporting .main-container,
        body.exporting .header-actions,
        body.exporting .theme-toggle {
            pointer-events: none;
            opacity: 0.6;
        }

        body.exporting .main-container {
            position: relative;
        }

        body.exporting .main-container::after {
            content: '';
            position: absolute;
            inset: 0;
            background: transparent;
            pointer-events: auto;
            z-index: 300;
        }

        body.exporting {
            cursor: wait;
        }
        
        .header h1 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 19px;
            font-weight: 600;
            letter-spacing: 0.5px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
            line-height: 1.1;
            letter-spacing: -0.5px;
        }
        
        .header-actions {
            display: flex;
            gap: 12px;
        }

        @media (max-width: 980px) {
            .header {
                flex-wrap: wrap;
                row-gap: 12px;
            }

            .header-actions {
                flex: 0 0 100%;
                width: 100%;
                justify-content: flex-start;
            }
        }
        
        .btn {
            padding: 10px 20px;
            border: 1px solid var(--border);
            background: var(--bg-tertiary);
            color: var(--text-primary);
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn:hover {
            border-color: var(--border-hover);
            background: var(--bg-secondary);
            transform: translateY(-1px);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            color: #fff;
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 20px rgba(0, 217, 255, 0.3);
        }
        
        .btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .btn:disabled:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            transform: none;
        }
        
        /* Main Layout */
        .main-container {
            display: flex;
            height: calc(100vh - 65px);
        }
        
        /* Drawer */
        .drawer {
            width: 320px;
            flex: 0 0 320px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border);
            overflow: visible;
            transition: width 0.3s ease, flex-basis 0.3s ease;
            position: relative;
        }
        
        .drawer.collapsed {
            width: 24px;
            flex: 0 0 24px;
            overflow: visible;
        }
        
        .drawer-toggle {
            position: absolute;
            right: -24px;
            top: 50%;
            transform: translateY(-50%);
            width: 24px;
            height: 64px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-left: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 20;
        }
        
        .drawer.collapsed .drawer-toggle {
            right: 0;
        }
        
        .drawer.collapsed .drawer-section {
            display: none;
        }
        
        .drawer-content {
            height: 100%;
            overflow-y: auto;
        }
        
        .drawer-section {
            padding: 12px 12px 12px 24px;
            border-bottom: 1px solid var(--border);
        }
        
        .drawer-section h3 {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-brighter);
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-group {
            margin-bottom: 2px;
        }
        
        .form-group label {
            display: block;
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 6px;
        }
        
        .form-group input[type="number"],
        select {
            width: 100%;
            padding: 4px 8px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            margin-bottom: 4px;
        }

        .resize-mode-info {
            margin-top: 8px;
            border-radius: 8px;
            background: var(--bg-secondary);
            font-size: 11px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .resize-mode-info-line {
            flex: 1;
            min-width: 0;
        }

        select,
        select option {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
        }

        #aspectW::-webkit-outer-spin-button,
        #aspectW::-webkit-inner-spin-button,
        #aspectH::-webkit-outer-spin-button,
        #aspectH::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        #aspectW,
        #aspectH {
            -moz-appearance: textfield;
            appearance: textfield;
        }

        .range-input {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .range-input input[type="range"] {
            flex: 1;
        }

        .range-input input[type="number"] {
            width: 72px;
        }

        .range-input-text {
            color: var(--text-secondary);
            display: inline-flex;
            align-items: center;
            min-height: 32px;
            line-height: 1;
        }

        .profile-name-display {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            padding: 0px 10px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
        }

        .profile-name-display.muted {
            color: var(--text-secondary);
        }

        .profile-action {
            margin-left: 4px;
            color: var(--accent-primary);
            cursor: pointer;
            font-weight: 600;
            font-size: 11px;
        }

        .profile-action:hover {
            color: var(--text-primary);
        }
        
        .form-group input[type="number"]:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--accent-primary);
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .mb {
            margin-bottom: 10px;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: var(--accent-primary);
        }

        .drawer-section {
            transition: max-height 0.25s ease, opacity 0.2s ease, margin 0.2s ease, padding 0.2s ease, border-width 0.2s ease;
            max-height: 600px;
            opacity: 1;
            overflow: hidden;
        }

        .drawer-section.collapsed {
            max-height: 0;
            opacity: 0;
            margin-top: 0;
            margin-bottom: 0;
            padding-top: 0;
            padding-bottom: 0;
            border-width: 0;
            pointer-events: none;
        }
        
        .aspect-ratios {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .aspect-mismatch-warning {
            display: none;
            margin-top: 8px;
            font-size: 11px;
            font-weight: 600;
            color: var(--danger);
        }

        .aspect-mismatch-warning.visible {
            display: block;
        }

        .aspect-rounding-info {
            display: none;
            width: 16px;
            height: 16px;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--text-secondary);
            color: var(--text-secondary);
            border-radius: 999px;
            font-size: 10px;
            font-weight: 700;
            line-height: 1;
            cursor: help;
        }

        .aspect-rounding-info.visible {
            display: inline-flex;
        }
        
        .aspect-ratio-btn {
            padding: 8px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .aspect-ratio-btn.active {
            background: var(--accent-primary);
            color: #000;
            border-color: var(--accent-primary);
        }

        .scale-presets {
            display: grid;
            grid-template-columns: repeat(4, minmax(0, 1fr));
            gap: 8px;
        }

        .scale-preset-btn {
            padding: 8px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .scale-preset-btn.active {
            background: var(--accent-primary);
            color: #000;
            border-color: var(--accent-primary);
        }
        
        /* Content Area */
        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .split-container {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        .images-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border);
            min-width: 267px;
        }
        
        .toolbar {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .toolbar-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .toolbar-group {
            display: flex;
            gap: 4px;
            padding-right: 12px;
            border-right: 1px solid var(--border);
        }
        
        .toolbar-group:last-child {
            border-right: none;
        }
        
        .icon-btn {
            width: 32px;
            height: 32px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        
        .icon-btn:hover {
            background: var(--bg-primary);
            border-color: var(--border-hover);
        }

        .icon-btn.active {
            border-color: var(--accent-primary);
            color: #fff;
            background: rgba(0, 217, 255, 0.18);
        }
        
        .images-grid-container {
            flex: 1;
            overflow: auto;
            position: relative;
        }
        
        .drop-zone {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed var(--border);
            margin: 24px;
            background: var(--bg-secondary);
            transition: all 0.3s ease;
        }
        
        .drop-zone.active {
            border-color: var(--accent-primary);
            background: rgba(0, 217, 255, 0.05);
        }
        
        .drop-zone.hidden {
            display: none;
        }
        
        .drop-message {
            text-align: center;
            color: var(--text-secondary);
        }
        
        .drop-message svg {
            width: 64px;
            height: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }
        
        .images-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 16px;
            padding: 24px;
            --grid-image-size: 240px;
        }

        .profiles-panel {
            position: absolute;
            inset: 0;
            padding: 20px;
            overflow: auto;
            background: var(--bg-primary);
            display: none;
        }

        .profiles-panel.active {
            display: block;
        }

        #profilesList {
            display: block;
        }

        .profiles-list {
            display: grid;
            gap: 12px;
            grid-template-columns: repeat(auto-fit, minmax(30em, 1fr));
        }

        .profiles-section-title {
            width: 100%;
            border: 0;
            background: transparent;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 11px;
            letter-spacing: 1px;
            text-transform: uppercase;
            color: var(--text-brighter);
            margin: 6px 0 10px;
            cursor: pointer;
            text-align: left;
        }

        .profiles-section-label {
            min-width: 0;
        }

        .profiles-section-chevron {
            font-size: 12px;
            line-height: 1;
            transform: rotate(-90deg);
            transition: transform 0.2s ease;
            opacity: 0.9;
        }

        .profiles-section.expanded .profiles-section-chevron {
            transform: rotate(0deg);
        }

        .profiles-section-title:focus-visible {
            outline: 1px solid var(--accent-primary);
            outline-offset: 2px;
        }

        .profiles-section {
            margin-bottom: 16px;
        }

        .profiles-section.collapsed .profiles-section-body {
            display: none;
        }

        .profiles-import-export {
            margin-top: 16px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .profile-card {
            padding: 7px 12px;
            border: 1px solid var(--border);
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .profile-info {
            min-width: 0;
        }

        .profile-name {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .profile-meta {
            font-size: 11px;
            color: var(--text-secondary);
        }

        .profile-actions {
            display: flex;
            gap: 8px;
            flex: 0 0 auto;
        }

        .btn-saveload-profile {
            padding: 10px 5px;
        }

        .btn.active {
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px rgba(0, 217, 255, 0.25);
        }
        
        .image-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            overflow: hidden;
            transition: all 0.2s ease;
            cursor: default;
        }
        
        .image-card:hover {
            border-color: var(--border-hover);
            transform: translateY(-2px);
        }
        
        .image-card.selected {
            border-color: var(--accent-primary);
        }
        
        .image-preview-container {
            position: relative;
            width: var(--grid-image-size, 240px);
            height: var(--grid-image-size, 240px);
            margin: 0 auto;
            background: var(--bg-tertiary);
            overflow: hidden;
        }
        
        .image-preview-wrapper {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .image-preview {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: block;
            position: relative;
        }
        
        .crop-box {
            position: absolute;
            border: 3px solid var(--accent-primary);
            cursor: move;
            pointer-events: auto;
            background: transparent;
            touch-action: none;
        }
        
        .crop-box::before {
            content: '';
            position: absolute;
            inset: 0;
            background: none;
            pointer-events: none;
        }
        
        .crop-handle {
            position: absolute;
            width: 24px;
            height: 24px;
            background: var(--accent-primary);
            border: 3px solid #000;
            opacity: 0;
            transition: opacity 0.2s ease;
            pointer-events: auto;
            z-index: 10;
            touch-action: none;
        }
        
        .crop-box:hover .crop-handle,
        .crop-handle.dragging {
            opacity: 1;
        }
        
        .crop-handle.nw { top: -12px; left: -12px; cursor: nw-resize; }
        .crop-handle.ne { top: -12px; right: -12px; cursor: ne-resize; }
        .crop-handle.sw { bottom: -12px; left: -12px; cursor: sw-resize; }
        .crop-handle.se { bottom: -12px; right: -12px; cursor: se-resize; }

        @media (pointer: coarse) {
            .crop-handle {
                opacity: 1;
            }
        }
        

        .image-card.selected .image-name {
            color: red;
            font-weight: 600;
        }

        .image-name {
            padding: 12px;
            font-size: 11px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 8px;
            -webkit-user-select: text;
            user-select: text;
            cursor: pointer;
        }

        .image-name-text {
            min-width: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1 1 auto;
            -webkit-user-select: text;
            user-select: text;
        }

        .image-dimensions-x {
            padding-left: 1px;
            padding-right: 1px;
        }

        .image-remove-btn {
            border: 1px solid var(--border);
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            width: 24px;
            height: 24px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            flex: 0 0 auto;
        }

        .image-remove-btn:hover {
            color: #fff;
            border-color: var(--border-hover);
        }

        .filename-tip {
            position: absolute;
            z-index: 6;
            background: yellow;
            border: 1px solid #38bdf8;
            color: black;
            padding: 10px 12px;
            border-radius: 10px;
            box-shadow: 0 10px 24px rgba(0, 0, 0, 0.35);
            display: flex;
            align-items: center;
            gap: 12px;
            max-width: 360px;
        }

        .filename-tip.hidden {
            display: none;
        }

        .filename-tip::before {
            content: '';
            position: absolute;
            top: -10px;
            left: var(--arrow-left, 24px);
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 10px solid #38bdf8;
        }

        .filename-tip::after {
            content: '';
            position: absolute;
            top: -8px;
            left: var(--arrow-left, 24px);
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 7px solid transparent;
            border-right: 7px solid transparent;
            border-bottom: 9px solid #1b2028;
        }

        .filename-tip-text {
            font-size: 12px;
            line-height: 1.3;
            font-weight: 600;
        }
        
        /* Preview Pane */
        .preview-pane {
            width: 0;
            flex: 0 0 0;
            background: var(--bg-secondary);
            transition: none;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            min-width: 0;
            min-height: 0;
        }
        
        .preview-pane.active {
            width: auto;
            flex: 1 1 0;
            min-width: 320px;
        }

        .preview-footer {
            padding: 10px 12px;
            border-top: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            background: var(--bg-secondary);
        }

        .preview-footer.hidden {
            display: none;
        }

        .preview-nudge-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            width: 100%;
        }

        .preview-nudge-group {
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .preview-nudge-btn {
            width: 34px;
            height: 34px;
            padding: 0;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .preview-nudge-btn svg {
            width: 18px;
            height: 18px;
            display: block;
        }

        .preview-nudge-hint {
            font-size: 11px;
            color: var(--text-secondary);
            white-space: nowrap;
        }
        
        .preview-header {
            padding: 4px 8px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 12px;
            min-width: 0;
            -webkit-user-select: text;
            user-select: text;
        }

        .preview-header * {
            -webkit-user-select: text;
            user-select: text;
        }

        .preview-header-actions {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: auto;
            flex: 0 0 auto;
        }

        .preview-header-actions .icon-btn,
        .preview-header-actions .btn {
            flex: 0 0 auto;
        }

        .preview-fullscreen-btn.active {
            border-color: var(--accent-primary);
            color: #fff;
            background: rgba(0, 217, 255, 0.18);
        }

        .preview-pane:fullscreen {
            width: 100%;
            height: 100%;
            max-width: none;
            max-height: none;
            flex: 1 1 auto;
            background: var(--bg-secondary);
        }

        .preview-pane:fullscreen .preview-content {
            overflow: hidden;
        }

        body.preview-fullscreen .drawer,
        body.preview-fullscreen .images-area,
        body.preview-fullscreen .resizer {
            display: none;
        }

        body.preview-fullscreen .header,
        body.preview-fullscreen .mobile-warning {
            display: none;
        }

        body.preview-fullscreen .main-container {
            height: 100vh;
        }

        body.preview-fullscreen .content {
            flex: 1 1 auto;
            min-width: 0;
        }

        body.preview-fullscreen .preview-pane {
            flex: 1 1 auto;
            width: 100%;
            min-width: 0;
        }

        .preview-layout-toggle {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px;
            border: 1px solid var(--border);
            border-radius: 10px;
            background: var(--bg-tertiary);
        }

        .preview-layout-btn {
            width: 28px;
            height: 28px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border: 1px solid transparent;
            background: transparent;
        }

        .preview-layout-btn.active {
            border-color: var(--accent-primary);
            color: #fff;
            background: rgba(0, 217, 255, 0.18);
        }

        .layout-icon {
            width: 16px;
            height: 16px;
            display: grid;
            gap: 2px;
        }

        .layout-icon span {
            border: 1px solid currentColor;
            border-radius: 2px;
            background: currentColor;
        }

        .layout-single {
            grid-template-columns: 1fr;
            grid-template-rows: 1fr;
        }

        .layout-split-horizontal {
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: 1fr;
        }

        .layout-split-vertical {
            grid-template-columns: 1fr;
            grid-template-rows: repeat(2, 1fr);
        }
        
        .preview-title {
            font-size: 14px;
            color: var(--text-primary);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 0;
            flex: 1 1 0;
            overflow: hidden;
        }

        .preview-title-text {
            min-width: 0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .preview-title-zoom {
            flex: 0 0 auto;
            white-space: nowrap;
            color: var(--text-secondary);
        }
        
        .preview-content {
            flex: 1;
            position: relative;
            overflow: hidden;
            min-height: 0;
        }

        .preview-content.split-active {
            padding: 12px;
        }

        .preview-split {
            position: absolute;
            inset: 0;
            display: flex;
            gap: 12px;
        }

        .preview-content.split-active .preview-split {
            display: flex;
        }

        .preview-content.split-vertical .preview-split {
            flex-direction: column;
        }

        .preview-left,
        .preview-right {
            position: relative;
            overflow: hidden;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            flex: 1 1 0;
            min-width: 180px;
        }

        .preview-content:not(.split-active) .preview-right {
            display: none;
        }

        .preview-content:not(.split-active) .preview-split-resizer {
            display: none;
        }

        .preview-split-resizer {
            width: 6px;
            background: var(--border);
            cursor: col-resize;
            border-radius: 999px;
            flex: 0 0 6px;
            align-self: stretch;
            touch-action: none;
        }

        .preview-content.split-vertical .preview-split-resizer {
            width: 100%;
            height: 6px;
            cursor: row-resize;
        }

        .preview-split-resizer:hover,
        .preview-split-resizer.resizing {
            background: var(--accent-primary);
        }
        
        .preview-image-wrapper {
            position: absolute;
            inset: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-tertiary);
        }

        .preview-content.split-active .preview-image-wrapper {
            background: transparent;
            inset: 12px;
        }

        .export-preview-host {
            position: absolute;
            inset: 0;
        }

        .export-preview-placeholder {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 12px;
            background: transparent;
        }
        
        .preview-actions {
            padding: 16px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 8px;
        }
        
        /* Resizer */
        .resizer {
            width: 4px;
            background: var(--border);
            cursor: col-resize;
            transition: background 0.2s ease;
            touch-action: none;
        }

        .resizer.disabled {
            cursor: default;
        }
        
        .resizer:hover,
        .resizer.resizing {
            background: var(--accent-primary);
        }

        .resizer.disabled:hover,
        .resizer.disabled.resizing {
            background: var(--border);
        }

        body:not(.preview-active) .resizer {
            display: none;
        }
        
        /* Export Preview */
        .export-preview-overlay {
            position: absolute;
            inset: 0;
            background: var(--bg-primary);
            display: flex;
            flex-direction: column;
            z-index: 50;
        }

        .export-preview-overlay.loading .export-preview-image {
            opacity: 0.35;
            filter: blur(0.2px);
            transition: opacity 0.15s ease;
        }
        
        .export-preview-header {
            padding: 4px 8px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: flex-start;
            flex-wrap: wrap;
            gap: 8px;
        }

        .export-preview-title-row {
            font-size: 14px;
            font-weight: 500;
            display: flex;
            gap: 8px;
            align-items: center;
            min-width: 0;
            flex: 1 1 220px;
        }

        .export-preview-size {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .export-preview-header-actions {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
            margin-left: auto;
        }

        .export-preview-zoom-controls {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            flex-wrap: wrap;
        }

        .export-zoom-btn {
            padding: 4px 10px;
            font-size: 11px;
        }

        .export-zoom-btn.active {
            border-color: var(--accent-primary);
            color: #fff;
            background: rgba(0, 217, 255, 0.18);
        }
        
        .export-preview-content {
            flex: 1;
            padding: 12px;
            display: block;
            -webkit-user-select: text;
            user-select: text;
            min-width: 0;
            min-height: 0;
            height: 100%;
        }

        .export-preview-content * {
            -webkit-user-select: text;
            user-select: text;
        }

        .export-preview-scroll {
            width: 100%;
            height: 100%;
            overflow: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: grab;
            min-width: 0;
            min-height: 0;
            scrollbar-gutter: stable;
        }

        .export-preview-scroll.panning {
            cursor: grabbing;
        }

        .export-preview-scroll.zoom-actual {
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: scroll;
        }
        
        .export-preview-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border: 1px solid var(--border);
            cursor: inherit;
        }

        .export-preview-scroll.zoom-actual .export-preview-image {
            max-width: none;
            max-height: none;
            flex: 0 0 auto;
            display: block;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #2a2f36;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #5b6470;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #7a8594;
        }
        
        /* File Input */
        #fileInput {
            display: none;
        }
        
        /* Animations */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .image-card.animate-in {
            animation: slideIn 0.3s ease;
        }

        /* About Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            backdrop-filter: blur(1.5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 200;
            padding: 24px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            width: min(640px, 92vw);
            background: #4c4c4c;
            color: #fff;
            border: 1px solid var(--border);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.45);
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 18px 20px;
            border-bottom: 1px solid var(--border);
        }

        .modal-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-body {
            padding: 20px;
            color: var(--text-secondary);
            font-size: 13px;
            line-height: 1.6;
        }

        .modal-body p {
            margin-bottom: 12px;
        }

        @media (max-width: 900px) and (pointer: coarse) {
            .modal-body p:not(:first-child) {
                display: none;
            }
        }

        .modal-footer {
            padding: 16px 20px;
            border-top: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .modal-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .changelog-link {
            font-size: 12px;
            font-weight: 600;
            color: var(--accent-primary);
            text-decoration: underline;
        }

        .changelog-link:hover {
            color: var(--text-brighter);
        }

        .changelog-list {
            margin-left: 18px;
            color: var(--text-secondary);
            font-size: 12px;
            line-height: 1.6;
            margin-bottom: 6px;
        }

        #changelogModal p {
            margin-bottom: 0;
        }

        #changelogModal ul {
            margin-top: 0;
        }

        .mobile-warning {
            display: none;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            padding: 10px 14px;
            background: yellow;
            border-bottom: 1px solid #5f2a2a;
            color: black;
            font-size: 14px;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 120;
        }

        .mobile-warning.hidden {
            display: none;
        }

        .mobile-warning-message {
            line-height: 1.4;
        }

        .mobile-warning-close {
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: transparent;
            color: black;
            font-weight: 600;
            width: 26px;
            height: 26px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            line-height: 1;
        }

        .mobile-warning-close:hover {
            border-color: rgba(255, 255, 255, 0.6);
            color: #fff;
        }

        @media (max-width: 700px) and (pointer: coarse) {
            .mobile-warning {
                display: flex;
            }
        }

        @media (max-width: 700px) {
            .drawer {
                width: 214px;
                flex: 0 0 214px;
                font-size: 95%;
            }
        }</style><script>(function () {
            try {
                document.documentElement.classList.add('no-theme-transition');
                const toggle = document.getElementById('themeToggle');
                const raw = localStorage.getItem('batchImageProcessorPrefs');
                const prefs = raw ? JSON.parse(raw) : null;
                if (prefs && prefs.lightMode) {
                    document.documentElement.classList.add('light');
                    document.body && document.body.classList.add('light');
                    if (toggle) {
                        toggle.checked = true;
                    }
                }
            } catch (e) {}
        })();</script><script defer="defer" src="main.js"></script></head><body class="app-initializing"><div class="mobile-warning hidden" id="mobileWarning" role="status" aria-live="polite"><span class="mobile-warning-message">This tool is not well suited for phones, really needs a tablet or desktop browser.</span> <button class="mobile-warning-close" type="button" aria-label="Dismiss mobile warning" onclick="closeMobileWarning()">✕</button></div><div class="header"><div class="header-title"><h1>Batch Image Crop &amp; Resize<br/><a class="changelog-link" href="#" onclick="openChangelog(); return false;">V1.1 Changelog</a></h1><label class="theme-toggle"><input type="checkbox" id="themeToggle" onchange="toggleTheme()"> <span class="theme-toggle-pill"></span> <span class="theme-toggle-label">Light Mode</span></label></div><div class="export-progress-wrapper"><div class="fallback-warning" id="fallbackWarning" role="alert" aria-live="polite"><span class="fallback-warning-title">Warning</span> <span class="fallback-warning-message"><span id="fallbackWarningDetail">High-quality resize/encode failed, using canvas fallback (reduced quality).</span> <a href="docs.html#faq" target="_blank" rel="noopener">See documentation FAQ.</a></span></div><div class="export-progress" id="exportProgress"><div class="export-progress-bar" id="exportProgressBar"></div><div class="export-progress-text" id="exportProgressText"></div></div><button class="btn export-cancel btn-primary" id="exportCancelBtn" onclick="cancelExport()">Cancel</button></div><div class="header-actions"><button class="btn" onclick="openAbout()">About</button> <button class="btn" onclick="openFilesFromHeader()">Open Files</button> <button class="btn btn-primary" id="exportBtn" onclick="exportImages()" disabled="disabled">Export All</button></div></div><div class="main-container"><div class="drawer" id="drawer"><div class="drawer-toggle" onclick="toggleDrawer()"><span id="drawerToggleIcon">◀</span></div><div class="drawer-content"><div class="drawer-section"><h3>Profile <span class="profile-action" id="profileClearAction" onclick="clearProfileName()" style="display: none;">(clear)</span> <span class="profile-action" id="profileRevertAction" onclick="revertProfileSettings()" style="display: none;">(revert)</span> <span class="profile-action" id="profileResetAction" onclick="resetProfileToDefault()">(reset)</span></h3><div class="form-group mb"><div id="profileNameDisplay" class="profile-name-display">&nbsp;</div></div><div style="display: flex; gap: 8px;"><button class="btn btn-saveload-profile" style="flex: 1;" onclick="saveProfile()">Save Profile</button> <button class="btn btn-saveload-profile" style="flex: 1;" id="loadProfileBtn" onclick="toggleProfiles()">Load Profile</button></div></div><div class="drawer-section"><h3>Resize Mode</h3><div class="form-group"><select id="resizeMode"><option value="fixed_aspect" selected="selected">Fixed AR + Crop + Resize</option><option value="fixed_aspect_crop">Fixed Aspect + Crop</option><option value="static_size">Static Size</option><option value="fixed_width">Fixed Width</option><option value="fixed_height">Fixed Height</option><option value="scale_to_fit">Scale to Fit (Max Size)</option><option value="free_crop">Free Crop, no Resize</option><option value="scaled">Scaled</option><option value="no_crop">No Crop/Resize (Convert)</option></select></div><div class="resize-mode-info" id="resizeModeInfo"><div class="resize-mode-info-line" id="resizeModeInfoText">Lock aspect, then resize to export size.</div></div></div><div class="drawer-section" id="aspectRatioSection"><h3>Aspect Ratio</h3><div class="form-group"><div class="range-input"><span class="range-input-text">W</span> <input type="number" id="aspectW" min="1" value="16" style="width:4em"> <span class="range-input-text">: H</span> <input type="number" id="aspectH" min="1" value="9" style="width:4em"></div></div><h3>Aspect Ratio Presets</h3><div class="form-group"><select id="aspectPresetSelect" aria-label="Aspect ratio presets" style="width: 11em"></select></div></div><div class="drawer-section" id="exportSizeSection"><h3>Export Size</h3><div class="form-group"><label>Width x Height (pixels)</label><div class="range-input"><span class="range-input-text">W</span> <input type="number" id="exportWidth" value="1920" min="1" style="width: 6em"> <span class="range-input-text">H</span> <input type="number" id="exportHeight" value="1080" min="1" style="width: 6em"> <span class="aspect-rounding-info" id="aspectRoundingInfo" title="AR is not exact but affected by rounding" aria-label="AR rounding information">i</span></div><div class="aspect-mismatch-warning" id="aspectMismatchWarning">Aspect ratios do not match, apply one or the other</div></div></div><div class="drawer-section collapsed" id="scaleSection"><h3>Scale</h3><div class="form-group"><label>Scale (%)</label><div class="range-input"><input type="number" id="scalePercent" min="1" max="400" value="100" style="width: 6em"> <span class="range-input-text">%</span></div></div><div class="form-group"><label>Presets</label><div class="scale-presets"><button class="scale-preset-btn" data-scale="10" onclick="setScalePercentPreset(10)">10%</button> <button class="scale-preset-btn" data-scale="20" onclick="setScalePercentPreset(20)">20%</button> <button class="scale-preset-btn" data-scale="25" onclick="setScalePercentPreset(25)">25%</button> <button class="scale-preset-btn" data-scale="30" onclick="setScalePercentPreset(30)">30%</button> <button class="scale-preset-btn" data-scale="50" onclick="setScalePercentPreset(50)">50%</button> <button class="scale-preset-btn" data-scale="75" onclick="setScalePercentPreset(75)">75%</button> <button class="scale-preset-btn" data-scale="100" onclick="setScalePercentPreset(100)">100%</button> <button class="scale-preset-btn" data-scale="200" onclick="setScalePercentPreset(200)">200%</button></div></div></div><div class="drawer-section"><h3>Export Format</h3><div class="form-group"><label>File Type</label> <select id="exportFormat" onchange="updateFormatSettings()" style="width: 8em"><option value="jpeg">JPEG</option><option value="png">PNG</option><option value="webp">WebP</option><option value="gif">GIF</option></select></div></div><div class="drawer-section" id="jpegSettings"><h3>JPEG Settings</h3><div class="form-group"><label>Quality (0-100)</label><div class="range-input"><input type="range" id="jpegQuality" value="90" min="0" max="100"> <input type="number" id="jpegQualityNumber" value="90" min="0" max="100"></div></div></div><div class="drawer-section" id="pngSettings" style="display: none;"><h3>PNG Settings</h3><div class="form-group checkbox-group"><input type="checkbox" id="pngTransparency" checked="checked"> <label for="pngTransparency" style="margin: 0;">Preserve Transparency</label></div></div><div class="drawer-section" id="webpSettings" style="display: none;"><h3>WebP Settings</h3><div class="form-group"><label>Quality (0-100)</label><div class="range-input"><input type="range" id="webpQuality" value="90" min="0" max="100"> <input type="number" id="webpQualityNumber" value="90" min="0" max="100"></div></div></div><div class="drawer-section" id="gifSettings" style="display: none;"><h3>GIF Settings</h3><div class="form-group"><label>Note: GIF export is lossy</label></div></div><div class="drawer-section" id="sharpenSettings"><h3>Sharpening</h3><div class="form-group checkbox-group"><input type="checkbox" id="enableSharpening"> <label for="enableSharpening" style="margin: 0;">Enable Sharpening</label></div><div class="form-group mb checkbox-group" style="margin-top: 8px;"><input type="checkbox" id="adaptiveSharpening"> <label for="adaptiveSharpening" style="margin: 0;">Adaptive Amount</label></div><div class="form-group"><label>Unsharp Amount (0-300)</label><div class="range-input"><input type="range" id="sharpenAmount" value="120" min="0" max="300"> <input type="number" id="sharpenAmountNumber" value="120" min="0" max="300"></div></div><div class="form-group"><label>Unsharp Radius (0.3-2.5)</label><div class="range-input"><input type="range" id="sharpenRadius" value="1.0" min="0.3" max="2.5" step="0.1"> <input type="number" id="sharpenRadiusNumber" value="1.0" min="0.3" max="2.5" step="0.1"></div></div><div class="form-group"><label>Unsharp Threshold (0-255)</label><div class="range-input"><input type="range" id="sharpenThreshold" value="10" min="0" max="255"> <input type="number" id="sharpenThresholdNumber" value="10" min="0" max="255"></div></div></div><div class="drawer-section" id="appSettings"><h3>App Settings</h3><div class="form-group"><label>Update Preview Delay</label> <select id="previewDelay" style="width: 8em"><option value="off">Off</option><option value="0.5" selected="selected">0.5s</option><option value="1">1s</option><option value="1.5">1.5s</option><option value="2">2s</option></select></div><div class="form-group"><label>Resize Engine</label> <select id="resizeEngine" style="width: 8em"><option value="jsquash" selected="selected">jSquash</option><option value="photon">Photon</option></select></div><div class="form-group" id="jsquashFilterGroup"><label>jSquash Filter</label> <select id="jsquashResizeMethod" style="width: 11em"><option value="lanczos3" selected="selected">Lanczos3</option><option value="mitchell">Mitchell</option><option value="catrom">CatmullRom</option><option value="triangle">Triangle</option><option value="hqx">HQX (pixel art)</option><option value="magicKernel">Magic Kernel</option><option value="magicKernelSharp2013">Magic Kernel Sharp 2013</option><option value="magicKernelSharp2021">Magic Kernel Sharp 2021</option></select></div><div class="form-group" id="photonFilterGroup" style="display: none;"><label>Photon Filter</label> <select id="photonResizeFilter" style="width: 8em"><option value="5" selected="selected">Lanczos3</option><option value="4">Gaussian</option><option value="3">CatmullRom</option><option value="2">Triangle</option><option value="1">Nearest</option></select></div><h3></h3></div></div></div><div class="content"><div class="split-container"><div class="images-area" id="imagesArea"><div class="toolbar"><div class="toolbar-group"><button class="icon-btn" onclick="adjustZoom(-0.1)" title="Zoom Out">−</button> <button class="icon-btn" onclick="adjustZoom(0.1)" title="Zoom In">+</button> <button class="icon-btn" onclick="resetZoom()" title="Reset Zoom">⊙</button> <button class="icon-btn" id="gridInfoToggle" title="Show size info" aria-pressed="false" onclick="toggleGridInfo()">i</button></div><div class="toolbar-group"><button class="btn" style="font-size: 11px; padding: 6px 12px;" onclick="alignAllCrops('top')">All Top</button> <button class="btn" style="font-size: 11px; padding: 6px 12px;" onclick="alignAllCrops('middle')">All Middle</button> <button class="btn" style="font-size: 11px; padding: 6px 12px;" onclick="alignAllCrops('bottom')">All Bottom</button></div><div class="toolbar-group"><button class="btn" style="font-size: 11px; padding: 6px 12px;" onclick="clearAllImages()">Clear All</button></div><div class="toolbar-group"><button class="btn" style="font-size: 11px; padding: 6px 12px;" id="openProfilesBtn" onclick="toggleProfiles()">Show Profiles</button></div></div><div class="images-grid-container" id="gridContainer"><div class="drop-zone" id="dropZone"><div class="drop-message"><svg fill="currentColor" viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/></svg><div style="font-size: 14px; margin-bottom: 8px;">Drop images here</div><div style="font-size: 11px; margin-bottom: 8px;">or click "Open Files" to browse</div><div style="font-size: 11px;">or paste from the clipboard<br/>(works with files and images)</div></div></div><div class="images-grid" id="imagesGrid"></div><div class="filename-tip hidden" id="filenameTip" role="dialog" aria-live="polite"><div class="filename-tip-text">Click the filename to zoom in.</div><button class="btn btn-primary" id="filenameTipDismiss">Got It</button></div><div class="profiles-panel" id="profilesPanel"><div class="profiles-list" id="profilesList"></div><div class="profiles-import-export"><button class="btn" id="exportProfilesBtn" onclick="exportUserProfiles()">Export User Profiles</button> <button class="btn" id="importProfilesBtn" onclick="importUserProfiles()">Import User Profiles</button></div></div></div></div><div class="resizer" id="resizer"></div><div class="preview-pane" id="previewPane"><div class="preview-header"><div class="preview-title" id="previewTitle"><span class="preview-title-text" id="previewTitleText">Preview</span> <span class="preview-title-zoom" id="previewTitleZoom"></span></div><div class="preview-header-actions"><button class="btn" id="testExportBtn" style="padding: 6px 12px; font-size: 11px;" onclick="testExport()">Show Export</button> <button class="icon-btn preview-fullscreen-btn" id="previewFullscreenBtn" title="Expand preview (spacebar)" onclick="togglePreviewFullscreen()">⤢</button><div class="preview-layout-toggle" role="group" aria-label="Preview layout"><button class="icon-btn preview-layout-btn" id="previewLayoutSingle" title="Single view" onclick="setPreviewLayout('single')"><span class="layout-icon layout-single"><span></span></span></button> <button class="icon-btn preview-layout-btn" id="previewLayoutHorizontal" title="Split horizontal" onclick="setPreviewLayout('split-horizontal')"><span class="layout-icon layout-split-horizontal"><span></span><span></span></span></button> <button class="icon-btn preview-layout-btn" id="previewLayoutVertical" title="Split vertical" onclick="setPreviewLayout('split-vertical')"><span class="layout-icon layout-split-vertical"><span></span><span></span></span></button></div><button class="icon-btn" onclick="closePreview()">✕</button></div></div><div class="preview-content" id="previewContent"><div class="preview-split" id="previewSplit"><div class="preview-left" id="previewLeft"><div class="preview-image-wrapper" id="previewWrapper"></div></div><div class="preview-split-resizer" id="previewSplitResizer"></div><div class="preview-right"><div class="export-preview-host" id="exportPreviewHost"></div></div></div></div><div class="preview-footer hidden" id="previewFooter"><div class="preview-nudge-controls"><div class="preview-nudge-hint">spacebar toggles fullscreen</div><div class="preview-nudge-group"><button class="btn preview-nudge-btn" data-crop-action="up" title="Nudge up" aria-label="Nudge up"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" focusable="false"><path d="M12 19V5"/><path d="M6 11l6-6 6 6"/></svg></button> <button class="btn preview-nudge-btn" data-crop-action="down" title="Nudge down" aria-label="Nudge down"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" focusable="false"><path d="M12 5v14"/><path d="M6 13l6 6 6-6"/></svg></button> <button class="btn preview-nudge-btn" data-crop-action="left" title="Nudge left" aria-label="Nudge left"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" focusable="false"><path d="M19 12H5"/><path d="M11 6l-6 6 6 6"/></svg></button> <button class="btn preview-nudge-btn" data-crop-action="right" title="Nudge right" aria-label="Nudge right"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" focusable="false"><path d="M5 12h14"/><path d="M13 6l6 6-6 6"/></svg></button></div><div class="preview-nudge-group"><button class="btn preview-nudge-btn" data-crop-action="shrink" title="Shrink from center" aria-label="Shrink from center"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" focusable="false"><path d="M3 3l6 6"/><path d="M5 9h4V5"/><path d="M21 3l-6 6"/><path d="M19 9h-4V5"/><path d="M3 21l6-6"/><path d="M5 15h4v4"/><path d="M21 21l-6-6"/><path d="M19 15h-4v4"/></svg></button> <button class="btn preview-nudge-btn" data-crop-action="grow" title="Grow from center" aria-label="Grow from center"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" focusable="false"><path d="M9 9L3 3"/><path d="M3 7V3h4"/><path d="M15 9l6-6"/><path d="M17 3h4v4"/><path d="M9 15l-6 6"/><path d="M3 17v4h4"/><path d="M15 15l6 6"/><path d="M17 21h4v-4"/></svg></button></div><div class="preview-nudge-hint">+shift=10 pixels</div></div></div></div></div></div></div><input type="file" id="fileInput" multiple="multiple" accept="image/*"> <input type="file" id="profileImportInput" accept="application/json,.json" style="display: none;"><div class="modal-overlay" id="aboutModal" role="dialog" aria-modal="true" aria-labelledby="aboutTitle"><div class="modal"><div class="modal-header"><div class="modal-title" id="aboutTitle">Batch Image Crop &amp; Resize - V1.1 <a class="changelog-link" href="#" onclick="openChangelog(); return false;">Changelog</a></div><button class="icon-btn" onclick="closeAbout()">✕</button></div><div class="modal-body"><p>This tool helps you resize, crop, and batch-export images with consistent dimensions and formats. <b><u>All images are processed locally in your browser.</u></b></p><p>Set your resolution, lock an aspect ratio, fine-tune format options, then export everything as a single ZIP.</p><p>Your last-used settings are saved locally for fast repeat workflows, user profiles can be saved (in browser storage), or presets for specific social media platforms can be loaded.</p><p>From your friends at <a href="https://splunge.foo" target="_blank" rel="noopener">Splunge.foo</a>. For issues join us at <a href="https://discord.gg/nBhyWfQzBE" target="_blank" rel="noopener">Discord</a>.</p><p>If you're using this there is a good chance you're doing some web related work, in that case you should check out <a href="https://splunge.foo/urlstudio/" target="_blank" rel="noopener">URL Studio</a> which is useful for viewing/editing/exporting URLs.</p><p>Virtually this whole thing has been 'vibe-coded'.</p></div><div class="modal-footer"><label class="modal-checkbox"><input type="checkbox" id="aboutAutoShow" checked="checked"> Show on startup</label><div style="display: flex; gap: 8px;"><button class="btn" onclick="resetPreferences()">Reset Prefs</button> <button class="btn btn-primary" onclick="closeAbout()">Got it</button></div></div></div></div><div class="modal-overlay" id="changelogModal" role="dialog" aria-modal="true" aria-labelledby="changelogTitle"><div class="modal"><div class="modal-header"><div class="modal-title" id="changelogTitle">Changelog</div><button class="icon-btn" onclick="closeChangelog()">✕</button></div><div class="modal-body"><p><b>V1.1</b> 10th February 2026.</p><ul class="changelog-list"><li>Added a warning for mobiles.</li><li>Single image export now just exports the single image and not a zip.</li><li>If you haven't exported your images, or have changed settings, you will now be prompted if you try to close the page.</li><li>On mobile clicking a filename will now full screen on the image as the split preview isn't going to work.</li><li>Added a new resize mode 'Scale to Fit (Max Size)' which will resize the image to fit within the max width and height.</li></ul><p><b>V1</b> 9th February 2026.</p><ul class="changelog-list"><li>Initial public release of Batch Image Crop &amp; Resize.</li></ul></div><div class="modal-footer"><div></div><button class="btn btn-primary" onclick="closeChangelog()">Close</button></div></div></div></body></html>
/*! For license information please see main.js.LICENSE.txt */
(()=>{var e,t,n={710(e,t,n){e.exports=function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){return i(t[o][1][e]||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var a=void 0,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,i,o,s,c,l,u=[],d=0,h=e.length,f=h,p="string"!==r.getTypeOf(e);d<e.length;)f=h-d,i=p?(t=e[d++],n=d<h?e[d++]:0,d<h?e[d++]:0):(t=e.charCodeAt(d++),n=d<h?e.charCodeAt(d++):0,d<h?e.charCodeAt(d++):0),o=t>>2,s=(3&t)<<4|n>>4,c=1<f?(15&n)<<2|i>>6:64,l=2<f?63&i:64,u.push(a.charAt(o)+a.charAt(s)+a.charAt(c)+a.charAt(l));return u.join("")},n.decode=function(e){var t,n,r,o,s,c,l=0,u=0,d="data:";if(e.substr(0,5)===d)throw new Error("Invalid base64 input, it looks like a data url.");var h,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&f--,e.charAt(e.length-2)===a.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=i.uint8array?new Uint8Array(0|f):new Array(0|f);l<e.length;)t=a.indexOf(e.charAt(l++))<<2|(o=a.indexOf(e.charAt(l++)))>>4,n=(15&o)<<4|(s=a.indexOf(e.charAt(l++)))>>2,r=(3&s)<<6|(c=a.indexOf(e.charAt(l++))),h[u++]=t,64!==s&&(h[u++]=n),64!==c&&(h[u++]=r);return h}},{"./support":30,"./utils":32}],2:[function(e,t,n){"use strict";var r=e("./external"),i=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),o=e("./stream/DataLengthProbe");function s(e,t,n,r,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=i}s.prototype={getContentWorker:function(){var e=new i(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new i(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,n){return e.pipe(new a).pipe(new o("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){"use strict";var r=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){"use strict";var r=e("./utils"),i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==r.getTypeOf(e)?function(e,t,n){var r=i,a=0+n;e^=-1;for(var o=0;o<a;o++)e=e>>>8^r[255&(e^t[o])];return-1^e}(0|t,e,e.length):function(e,t,n){var r=i,a=0+n;e^=-1;for(var o=0;o<a;o++)e=e>>>8^r[255&(e^t.charCodeAt(o))];return-1^e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){"use strict";var r;r="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:r}},{lie:37}],7:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako"),a=e("./utils"),o=e("./stream/GenericWorker"),s=r?"uint8array":"array";function c(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",a.inherits(c,o),c.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(a.transformTo(s,e.data),!1)},c.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new c("Deflate",e)},n.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){"use strict";function r(e,t){var n,r="";for(n=0;n<t;n++)r+=String.fromCharCode(255&e),e>>>=8;return r}function i(e,t,n,i,o,u){var d,h,f=e.file,p=e.compression,m=u!==s.utf8encode,g=a.transformTo("string",u(f.name)),_=a.transformTo("string",s.utf8encode(f.name)),b=f.comment,w=a.transformTo("string",u(b)),y=a.transformTo("string",s.utf8encode(b)),v=_.length!==f.name.length,x=y.length!==b.length,E="",I="",k="",C=f.dir,z=f.date,B={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(B.crc32=e.crc32,B.compressedSize=e.compressedSize,B.uncompressedSize=e.uncompressedSize);var S=0;t&&(S|=8),m||!v&&!x||(S|=2048);var A=0,L=0;C&&(A|=16),"UNIX"===o?(L=798,A|=function(e,t){var n=e;return e||(n=t?16893:33204),(65535&n)<<16}(f.unixPermissions,C)):(L=20,A|=function(e){return 63&(e||0)}(f.dosPermissions)),d=z.getUTCHours(),d<<=6,d|=z.getUTCMinutes(),d<<=5,d|=z.getUTCSeconds()/2,h=z.getUTCFullYear()-1980,h<<=4,h|=z.getUTCMonth()+1,h<<=5,h|=z.getUTCDate(),v&&(I=r(1,1)+r(c(g),4)+_,E+="up"+r(I.length,2)+I),x&&(k=r(1,1)+r(c(w),4)+y,E+="uc"+r(k.length,2)+k);var R="";return R+="\n\0",R+=r(S,2),R+=p.magic,R+=r(d,2),R+=r(h,2),R+=r(B.crc32,4),R+=r(B.compressedSize,4),R+=r(B.uncompressedSize,4),R+=r(g.length,2),R+=r(E.length,2),{fileRecord:l.LOCAL_FILE_HEADER+R+g+E,dirRecord:l.CENTRAL_FILE_HEADER+r(L,2)+R+r(w.length,2)+"\0\0\0\0"+r(A,4)+r(i,4)+g+E+w}}var a=e("../utils"),o=e("../stream/GenericWorker"),s=e("../utf8"),c=e("../crc32"),l=e("../signature");function u(e,t,n,r){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(u,o),u.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-r-1))/n:100}}))},u.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=i(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=i(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:function(e){return l.DATA_DESCRIPTOR+r(e.crc32,4)+r(e.compressedSize,4)+r(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,i=function(e,t,n,i,o){var s=a.transformTo("string",o(i));return l.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(e,2)+r(e,2)+r(t,4)+r(n,4)+r(s.length,2)+s}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},u.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(e){var t=this._sources;if(!o.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},u.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){"use strict";var r=e("../compressions"),i=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var a=new i(t.streamFiles,n,t.platform,t.encodeFileName),o=0;try{e.forEach(function(e,n){o++;var i=function(e,t){var n=e||t,i=r[n];if(!i)throw new Error(n+" is not a valid compression method !");return i}(n.options.compression,t.compression),s=n.options.compressionOptions||t.compressionOptions||{},c=n.dir,l=n.date;n._compressWorker(i,s).withStreamInfo("file",{name:e,dir:c,date:l,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(a)}),a.entriesCount=o}catch(e){a.error(e)}return a}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=e("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./external"),a=e("./utf8"),o=e("./zipEntries"),s=e("./stream/Crc32Probe"),c=e("./nodejsUtils");function l(e){return new i.Promise(function(t,n){var r=e.decompressed.getContentWorker().pipe(new s);r.on("error",function(e){n(e)}).on("end",function(){r.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}t.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),c.isNode&&c.isStream(e)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new o(t);return n.load(e),n}).then(function(e){var n=[i.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var a=0;a<r.length;a++)n.push(l(r[a]));return i.Promise.all(n)}).then(function(e){for(var i=e.shift(),a=i.files,o=0;o<a.length;o++){var s=a[o],c=s.fileNameStr,l=r.resolve(s.fileNameStr);n.file(l,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(n.file(l).unsafeOriginalName=c)}return i.zipComment.length&&(n.comment=i.zipComment),n})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../stream/GenericWorker");function a(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(a,i),a.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},a.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){"use strict";var r=e("readable-stream").Readable;function i(e,t,n){r.call(this,t),this._helper=e;var i=this;e.on("data",function(e,t){i.push(e)||i._helper.pause(),n&&n(t)}).on("error",function(e){i.emit("error",e)}).on("end",function(){i.push(null)})}e("../utils").inherits(i,r),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){"use strict";function r(e,t,n){var r,i=a.getTypeOf(t),s=a.extend(n||{},c);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=m(e)),s.createFolders&&(r=p(e))&&g.call(this,r,!0);var d="string"===i&&!1===s.binary&&!1===s.base64;n&&void 0!==n.binary||(s.binary=!d),(t instanceof l&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",i="string");var _;_=t instanceof l||t instanceof o?t:h.isNode&&h.isStream(t)?new f(e,t):a.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var b=new u(e,_,s);this.files[e]=b}var i=e("./utf8"),a=e("./utils"),o=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),c=e("./defaults"),l=e("./compressedObject"),u=e("./zipObject"),d=e("./generate"),h=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:c.createFolders,e=m(e),this.files[e]||r.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function _(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var b={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,r;for(t in this.files)r=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,r)},filter:function(e){var t=[];return this.forEach(function(n,r){e(n,r)&&t.push(r)}),t},file:function(e,t,n){if(1!==arguments.length)return e=this.root+e,r.call(this,e,t,n),this;if(_(e)){var i=e;return this.filter(function(e,t){return!t.dir&&i.test(e)})}var a=this.files[this.root+e];return a&&!a.dir?a:null},folder:function(e){if(!e)return this;if(_(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=g.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=a.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");a.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var r=n.comment||this.comment||"";t=d.generateWorker(this,n,r)}catch(e){(t=new o("error")).error(e)}return new s(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=b},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),a=this.length-4;0<=a;--a)if(this.data[a]===t&&this.data[a+1]===n&&this.data[a+2]===r&&this.data[a+3]===i)return a-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),a=this.readData(4);return t===a[0]&&n===a[1]&&r===a[2]&&i===a[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){"use strict";var r=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,n){"use strict";var r=e("./Uint8ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){"use strict";var r=e("./ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../support"),a=e("./ArrayReader"),o=e("./StringReader"),s=e("./NodeBufferReader"),c=e("./Uint8ArrayReader");t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new s(e):i.uint8array?new c(r.transformTo("uint8array",e)):new a(r.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../utils");function a(e){r.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(a,r),a.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../crc32");function a(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,r),a.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function a(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(a,i),a.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function a(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}r.inherits(a,i),a.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){"use strict";function r(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=r},{}],29:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./ConvertWorker"),a=e("./GenericWorker"),o=e("../base64"),s=e("../support"),c=e("../external"),l=null;if(s.nodestream)try{l=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function u(e,t,n){var o=t;switch(t){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=t,this._mimeType=n,r.checkSupport(o),this._worker=e.pipe(new i(o)),e.lock()}catch(e){this._worker=new a("error"),this._worker.error(e)}}u.prototype={accumulate:function(e){return function(e,t){return new c.Promise(function(n,i){var a=[],s=e._internalType,c=e._outputType,l=e._mimeType;e.on("data",function(e,n){a.push(e),t&&t(n)}).on("error",function(e){a=[],i(e)}).on("end",function(){try{var e=function(e,t,n){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),n);case"base64":return o.encode(t);default:return r.transformTo(e,t)}}(c,function(e,t){var n,r=0,i=null,a=0;for(n=0;n<t.length;n++)a+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(a),n=0;n<t.length;n++)i.set(t[n],r),r+=t[n].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,a),l);n(e)}catch(e){i(e)}a=[]}).resume()})}(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,function(e){t.call(n,e.data,e.meta)}):this._worker.on(e,function(){r.delay(t,arguments,n)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new l(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var r=new ArrayBuffer(0);try{n.blob=0===new Blob([r],{type:"application/zip"}).size}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(r),n.blob=0===i.getBlob("application/zip").size}catch(e){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(e){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";for(var r=e("./utils"),i=e("./support"),a=e("./nodejsUtils"),o=e("./stream/GenericWorker"),s=new Array(256),c=0;c<256;c++)s[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function l(){o.call(this,"utf-8 decode"),this.leftOver=null}function u(){o.call(this,"utf-8 encode")}s[254]=s[254]=1,n.utf8encode=function(e){return i.nodebuffer?a.newBufferFrom(e,"utf-8"):function(e){var t,n,r,a,o,s=e.length,c=0;for(a=0;a<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),c+=n<128?1:n<2048?2:n<65536?3:4;for(t=i.uint8array?new Uint8Array(c):new Array(c),a=o=0;o<c;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?t[o++]=n:(n<2048?t[o++]=192|n>>>6:(n<65536?t[o++]=224|n>>>12:(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63),t[o++]=128|n>>>6&63),t[o++]=128|63&n);return t}(e)},n.utf8decode=function(e){return i.nodebuffer?r.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,i,a,o=e.length,c=new Array(2*o);for(t=n=0;t<o;)if((i=e[t++])<128)c[n++]=i;else if(4<(a=s[i]))c[n++]=65533,t+=a-1;else{for(i&=2===a?31:3===a?15:7;1<a&&t<o;)i=i<<6|63&e[t++],a--;1<a?c[n++]=65533:i<65536?c[n++]=i:(i-=65536,c[n++]=55296|i>>10&1023,c[n++]=56320|1023&i)}return c.length!==n&&(c.subarray?c=c.subarray(0,n):c.length=n),r.applyFromCharCode(c)}(e=r.transformTo(i.uint8array?"uint8array":"array",e))},r.inherits(l,o),l.prototype.processChunk=function(e){var t=r.transformTo(i.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var a=t;(t=new Uint8Array(a.length+this.leftOver.length)).set(this.leftOver,0),t.set(a,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var o=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}(t),c=t;o!==t.length&&(i.uint8array?(c=t.subarray(0,o),this.leftOver=t.subarray(o,t.length)):(c=t.slice(0,o),this.leftOver=t.slice(o,t.length))),this.push({data:n.utf8decode(c),meta:e.meta})},l.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=l,r.inherits(u,o),u.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){"use strict";var r=e("./support"),i=e("./base64"),a=e("./nodejsUtils"),o=e("./external");function s(e){return e}function c(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),n.newBlob=function(e,t){n.checkSupport("blob");try{return new Blob([e],{type:t})}catch(n){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(e),r.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var l={stringifyByChunk:function(e,t,n){var r=[],i=0,a=e.length;if(a<=n)return String.fromCharCode.apply(null,e);for(;i<a;)"array"===t||"nodebuffer"===t?r.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+n,a)))):r.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+n,a)))),i+=n;return r.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,a.allocBuffer(1)).length}catch(e){return!1}}()}};function u(e){var t=65536,r=n.getTypeOf(e),i=!0;if("uint8array"===r?i=l.applyCanBeUsed.uint8array:"nodebuffer"===r&&(i=l.applyCanBeUsed.nodebuffer),i)for(;1<t;)try{return l.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return l.stringifyByChar(e)}function d(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=u;var h={};h.string={string:s,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return h.string.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:function(e){return c(e,a.allocBuffer(e.length))}},h.array={string:u,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(e)}},h.arraybuffer={string:function(e){return u(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(new Uint8Array(e))}},h.uint8array={string:u,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return a.newBufferFrom(e)}},h.nodebuffer={string:u,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return h.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:s},n.transformTo=function(e,t){if(t=t||"",!e)return t;n.checkSupport(e);var r=n.getTypeOf(t);return h[r][e](t)},n.resolve=function(e){for(var t=e.split("/"),n=[],r=0;r<t.length;r++){var i=t[r];"."===i||""===i&&0!==r&&r!==t.length-1||(".."===i?n.pop():n.push(i))}return n.join("/")},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&a.isBuffer(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,r="";for(n=0;n<(e||"").length;n++)r+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return r},n.delay=function(e,t,n){setImmediate(function(){e.apply(n||null,t||[])})},n.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,a,s,l){return o.Promise.resolve(t).then(function(e){return r.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new o.Promise(function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)}):e}).then(function(t){var u=n.getTypeOf(t);return u?("arraybuffer"===u?t=n.transformTo("uint8array",t):"string"===u&&(l?t=i.decode(t):a&&!0!==s&&(t=function(e){return c(e,r.uint8array?new Uint8Array(e.length):new Array(e.length))}(t))),t):o.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),a=e("./signature"),o=e("./zipEntry"),s=e("./support");function c(e){this.files=[],this.loadOptions=e}c.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",n=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var r=t-n;if(0<r)this.isSignature(t,a.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),a=e("./compressedObject"),o=e("./crc32"),s=e("./utf8"),c=e("./compressions"),l=e("./support");function u(e,t){this.options=e,this.loadOptions=t}u.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in c)if(Object.prototype.hasOwnProperty.call(c,t)&&c[t].magic===e)return c[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,r,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),n=e.readInt(2),r=e.readData(n),this.extraFields[t]={id:t,length:n,value:r};e.setIndex(i)},handleUTF8:function(){var e=l.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var a=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||o(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||o(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){"use strict";function r(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var i=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),o=e("./utf8"),s=e("./compressedObject"),c=e("./stream/GenericWorker");r.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!r&&(t=t.pipe(new o.Utf8EncodeWorker)),!a&&r&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(e){(t=new c("error")).error(e)}return new i(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new o.Utf8EncodeWorker)),s.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof c?this._data:new a(this._data)}};for(var l=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<l.length;d++)r.prototype[l[d]]=u;t.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){"use strict";var n,r,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var a=0,o=new i(u),s=e.document.createTextNode("");o.observe(s,{characterData:!0}),n=function(){s.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var c=new e.MessageChannel;c.port1.onmessage=u,n=function(){c.port2.postMessage(0)}}var l=[];function u(){var e,t;r=!0;for(var n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}r=!1}t.exports=function(e){1!==l.push(e)||r||n()}}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){"use strict";var r=e("immediate");function i(){}var a={},o=["REJECTED"],s=["FULFILLED"],c=["PENDING"];function l(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==i&&f(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){r(function(){var r;try{r=t(n)}catch(r){return a.reject(e,r)}r===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,r)})}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function r(t){n||(n=!0,a.reject(e,t))}function i(t){n||(n=!0,a.resolve(e,t))}var o=p(function(){t(i,r)});"error"===o.status&&r(o.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}(t.exports=l).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===o)return this;var n=new this.constructor(i);return this.state!==c?d(n,this.state===s?e:t,this.outcome):this.queue.push(new u(n,e,t)),n},u.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){a.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},a.resolve=function(e,t){var n=p(h,t);if("error"===n.status)return a.reject(e,n.value);var r=n.value;if(r)f(e,r);else{e.state=s,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},a.reject=function(e,t){e.state=o,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},l.resolve=function(e){return e instanceof this?e:a.resolve(new this(i),e)},l.reject=function(e){var t=new this(i);return a.reject(t,e)},l.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var o=new Array(n),s=0,c=-1,l=new this(i);++c<n;)u(e[c],c);return l;function u(e,i){t.resolve(e).then(function(e){o[i]=e,++s!==n||r||(r=!0,a.resolve(l,o))},function(e){r||(r=!0,a.reject(l,e))})}},l.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var r,o=-1,s=new this(i);++o<t;)r=e[o],this.resolve(r).then(function(e){n||(n=!0,a.resolve(s,e))},function(e){n||(n=!0,a.reject(s,e))});return s}},{immediate:36}],38:[function(e,t,n){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){"use strict";var r=e("./zlib/deflate"),i=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/messages"),s=e("./zlib/zstream"),c=Object.prototype.toString;function l(e){if(!(this instanceof l))return new l(e);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==n)throw new Error(o[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var u;if(u="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(n=r.deflateSetDictionary(this.strm,u)))throw new Error(o[n]);this._dict_set=!0}}function u(e,t){var n=new l(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}l.prototype.push=function(e,t){var n,o,s=this.strm,l=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=a.string2buf(e):"[object ArrayBuffer]"===c.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(l),s.next_out=0,s.avail_out=l),1!==(n=r.deflate(s,o))&&0!==n)return this.onEnd(n),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(a.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==n);return 4===o?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==o||(this.onEnd(0),!(s.avail_out=0))},l.prototype.onData=function(e){this.chunks.push(e)},l.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=l,n.deflate=u,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,u(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){"use strict";var r=e("./zlib/inflate"),i=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/constants"),s=e("./zlib/messages"),c=e("./zlib/zstream"),l=e("./zlib/gzheader"),u=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==o.Z_OK)throw new Error(s[n]);this.header=new l,r.inflateGetHeader(this.strm,this.header)}function h(e,t){var n=new d(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}d.prototype.push=function(e,t){var n,s,c,l,d,h,f=this.strm,p=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?f.input=a.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new i.Buf8(p),f.next_out=0,f.avail_out=p),(n=r.inflate(f,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&m&&(h="string"==typeof m?a.string2buf(m):"[object ArrayBuffer]"===u.call(m)?new Uint8Array(m):m,n=r.inflateSetDictionary(this.strm,h)),n===o.Z_BUF_ERROR&&!0===g&&(n=o.Z_OK,g=!1),n!==o.Z_STREAM_END&&n!==o.Z_OK)return this.onEnd(n),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&n!==o.Z_STREAM_END&&(0!==f.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(c=a.utf8border(f.output,f.next_out),l=f.next_out-c,d=a.buf2string(f.output,c),f.next_out=l,f.avail_out=p-l,l&&i.arraySet(f.output,f.output,c,l,0),this.onData(d)):this.onData(i.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(g=!0)}while((0<f.avail_in||0===f.avail_out)&&n!==o.Z_STREAM_END);return n===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(f.avail_out=0))},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=d,n.inflate=h,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},n.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){var t,n,r,i,a,o;for(t=r=0,n=e.length;t<n;t++)r+=e[t].length;for(o=new Uint8Array(r),t=i=0,n=e.length;t<n;t++)a=e[t],o.set(a,i),i+=a.length;return o}},a={arraySet:function(e,t,n,r,i){for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,a))},n.setTyped(r)},{}],42:[function(e,t,n){"use strict";var r=e("./common"),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=!1}for(var o=new r.Buf8(256),s=0;s<256;s++)o[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function c(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",o=0;o<t;o++)n+=String.fromCharCode(e[o]);return n}o[254]=o[254]=1,n.string2buf=function(e){var t,n,i,a,o,s=e.length,c=0;for(a=0;a<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),c+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(c),a=o=0;o<c;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),n<128?t[o++]=n:(n<2048?t[o++]=192|n>>>6:(n<65536?t[o++]=224|n>>>12:(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63),t[o++]=128|n>>>6&63),t[o++]=128|63&n);return t},n.buf2binstring=function(e){return c(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,i,a,s=t||e.length,l=new Array(2*s);for(n=r=0;n<s;)if((i=e[n++])<128)l[r++]=i;else if(4<(a=o[i]))l[r++]=65533,n+=a-1;else{for(i&=2===a?31:3===a?15:7;1<a&&n<s;)i=i<<6|63&e[n++],a--;1<a?l[r++]=65533:i<65536?l[r++]=i:(i-=65536,l[r++]=55296|i>>10&1023,l[r++]=56320|1023&i)}return c(l,r)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+o[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){for(var i=65535&e,a=e>>>16&65535,o=0;0!==n;){for(n-=o=2e3<n?2e3:n;a=a+(i=i+t[r++]|0)|0,--o;);i%=65521,a%=65521}return i|a<<16}},{}],44:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){"use strict";var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,i){var a=r,o=i+n;e^=-1;for(var s=i;s<o;s++)e=e>>>8^a[255&(e^t[s])];return-1^e}},{}],46:[function(e,t,n){"use strict";var r,i=e("../utils/common"),a=e("./trees"),o=e("./adler32"),s=e("./crc32"),c=e("./messages"),l=-2,u=258,d=262,h=113;function f(e,t){return e.msg=c[t],t}function p(e){return(e<<1)-(4<e?9:0)}function m(e){for(var t=e.length;0<=--t;)e[t]=0}function g(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function _(e,t){a._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,g(e.strm)}function b(e,t){e.pending_buf[e.pending++]=t}function w(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function y(e,t){var n,r,i=e.max_chain_length,a=e.strstart,o=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-d?e.strstart-(e.w_size-d):0,l=e.window,h=e.w_mask,f=e.prev,p=e.strstart+u,m=l[a+o-1],g=l[a+o];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(l[(n=t)+o]===g&&l[n+o-1]===m&&l[n]===l[a]&&l[++n]===l[a+1]){a+=2,n++;do{}while(l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&a<p);if(r=u-(p-a),a=p-u,o<r){if(e.match_start=t,s<=(o=r))break;m=l[a+o-1],g=l[a+o]}}}while((t=f[t&h])>c&&0!=--i);return o<=e.lookahead?o:e.lookahead}function v(e){var t,n,r,a,c,l,u,h,f,p,m=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-d)){for(i.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=n=e.hash_size;r=e.head[--t],e.head[t]=m<=r?r-m:0,--n;);for(t=n=m;r=e.prev[--t],e.prev[t]=m<=r?r-m:0,--n;);a+=m}if(0===e.strm.avail_in)break;if(l=e.strm,u=e.window,h=e.strstart+e.lookahead,p=void 0,(f=a)<(p=l.avail_in)&&(p=f),n=0===p?0:(l.avail_in-=p,i.arraySet(u,l.input,l.next_in,p,h),1===l.state.wrap?l.adler=o(l.adler,u,p,h):2===l.state.wrap&&(l.adler=s(l.adler,u,p,h)),l.next_in+=p,l.total_in+=p,p),e.lookahead+=n,e.lookahead+e.insert>=3)for(c=e.strstart-e.insert,e.ins_h=e.window[c],e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+3-1])&e.hash_mask,e.prev[c&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=c,c++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<d&&0!==e.strm.avail_in)}function x(e,t){for(var n,r;;){if(e.lookahead<d){if(v(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-d&&(e.match_length=y(e,n)),e.match_length>=3)if(r=a._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(_(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(_(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?1:2}function E(e,t){for(var n,r,i;;){if(e.lookahead<d){if(v(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-d&&(e.match_length=y(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-3,r=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(_(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=a._tr_tally(e,0,e.window[e.strstart-1]))&&_(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(_(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?1:2}function I(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function k(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),m(this.dyn_ltree),m(this.dyn_dtree),m(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),m(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),m(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function C(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:h,e.adler=2===t.wrap?0:1,t.last_flush=0,a._tr_init(t),0):f(e,l)}function z(e){var t=C(e);return 0===t&&function(e){e.window_size=2*e.w_size,m(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0}(e.state),t}function B(e,t,n,r,a,o){if(!e)return l;var s=1;if(-1===t&&(t=6),r<0?(s=0,r=-r):15<r&&(s=2,r-=16),a<1||9<a||8!==n||r<8||15<r||t<0||9<t||o<0||4<o)return f(e,l);8===r&&(r=9);var c=new k;return(e.state=c).strm=e,c.wrap=s,c.gzhead=null,c.w_bits=r,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=a+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+3-1)/3),c.window=new i.Buf8(2*c.w_size),c.head=new i.Buf16(c.hash_size),c.prev=new i.Buf16(c.w_size),c.lit_bufsize=1<<a+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new i.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=o,c.method=n,z(e)}r=[new I(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(v(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,_(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-d&&(_(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(_(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(_(e,!1),e.strm.avail_out),1)}),new I(4,4,8,4,x),new I(4,5,16,8,x),new I(4,6,32,32,x),new I(4,4,16,16,E),new I(8,16,32,32,E),new I(8,16,128,128,E),new I(8,32,128,256,E),new I(32,128,258,1024,E),new I(32,258,258,4096,E)],n.deflateInit=function(e,t){return B(e,t,8,15,8,0)},n.deflateInit2=B,n.deflateReset=z,n.deflateResetKeep=C,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?l:(e.state.gzhead=t,0):l},n.deflate=function(e,t){var n,i,o,c;if(!e||!e.state||5<t||t<0)return e?f(e,l):l;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&4!==t)return f(e,0===e.avail_out?-5:l);if(i.strm=e,n=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,b(i,31),b(i,139),b(i,8),i.gzhead?(b(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),b(i,255&i.gzhead.time),b(i,i.gzhead.time>>8&255),b(i,i.gzhead.time>>16&255),b(i,i.gzhead.time>>24&255),b(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),b(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(b(i,255&i.gzhead.extra.length),b(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(b(i,0),b(i,0),b(i,0),b(i,0),b(i,0),b(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),b(i,3),i.status=h);else{var d=8+(i.w_bits-8<<4)<<8;d|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(d|=32),d+=31-d%31,i.status=h,w(i,d),0!==i.strstart&&(w(i,e.adler>>>16),w(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(o=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),g(e),o=i.pending,i.pending!==i.pending_buf_size));)b(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),g(e),o=i.pending,i.pending===i.pending_buf_size)){c=1;break}c=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,b(i,c)}while(0!==c);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===c&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),g(e),o=i.pending,i.pending===i.pending_buf_size)){c=1;break}c=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,b(i,c)}while(0!==c);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===c&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&g(e),i.pending+2<=i.pending_buf_size&&(b(i,255&e.adler),b(i,e.adler>>8&255),e.adler=0,i.status=h)):i.status=h),0!==i.pending){if(g(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&p(t)<=p(n)&&4!==t)return f(e,-5);if(666===i.status&&0!==e.avail_in)return f(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&666!==i.status){var y=2===i.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(v(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(_(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(_(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var n,r,i,o,s=e.window;;){if(e.lookahead<=u){if(v(e),e.lookahead<=u&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(r=s[i=e.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){o=e.strstart+u;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<o);e.match_length=u-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=a._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(_(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(_(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?1:2}(i,t):r[i.level].func(i,t);if(3!==y&&4!==y||(i.status=666),1===y||3===y)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===y&&(1===t?a._tr_align(i):5!==t&&(a._tr_stored_block(i,0,0,!1),3===t&&(m(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),g(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(b(i,255&e.adler),b(i,e.adler>>8&255),b(i,e.adler>>16&255),b(i,e.adler>>24&255),b(i,255&e.total_in),b(i,e.total_in>>8&255),b(i,e.total_in>>16&255),b(i,e.total_in>>24&255)):(w(i,e.adler>>>16),w(i,65535&e.adler)),g(e),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?0:1)},n.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&t!==h&&666!==t?f(e,l):(e.state=null,t===h?f(e,-3):0):l},n.deflateSetDictionary=function(e,t){var n,r,a,s,c,u,d,h,f=t.length;if(!e||!e.state)return l;if(2===(s=(n=e.state).wrap)||1===s&&42!==n.status||n.lookahead)return l;for(1===s&&(e.adler=o(e.adler,t,f,0)),n.wrap=0,f>=n.w_size&&(0===s&&(m(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new i.Buf8(n.w_size),i.arraySet(h,t,f-n.w_size,n.w_size,0),t=h,f=n.w_size),c=e.avail_in,u=e.next_in,d=e.input,e.avail_in=f,e.next_in=0,e.input=t,v(n);n.lookahead>=3;){for(r=n.strstart,a=n.lookahead-2;n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+3-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,--a;);n.strstart=r,n.lookahead=2,v(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=u,e.input=d,e.avail_in=c,n.wrap=s,0},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){"use strict";t.exports=function(e,t){var n,r,i,a,o,s,c,l,u,d,h,f,p,m,g,_,b,w,y,v,x,E,I,k,C;n=e.state,r=e.next_in,k=e.input,i=r+(e.avail_in-5),a=e.next_out,C=e.output,o=a-(t-e.avail_out),s=a+(e.avail_out-257),c=n.dmax,l=n.wsize,u=n.whave,d=n.wnext,h=n.window,f=n.hold,p=n.bits,m=n.lencode,g=n.distcode,_=(1<<n.lenbits)-1,b=(1<<n.distbits)-1;e:do{p<15&&(f+=k[r++]<<p,p+=8,f+=k[r++]<<p,p+=8),w=m[f&_];t:for(;;){if(f>>>=y=w>>>24,p-=y,0==(y=w>>>16&255))C[a++]=65535&w;else{if(!(16&y)){if(!(64&y)){w=m[(65535&w)+(f&(1<<y)-1)];continue t}if(32&y){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}v=65535&w,(y&=15)&&(p<y&&(f+=k[r++]<<p,p+=8),v+=f&(1<<y)-1,f>>>=y,p-=y),p<15&&(f+=k[r++]<<p,p+=8,f+=k[r++]<<p,p+=8),w=g[f&b];n:for(;;){if(f>>>=y=w>>>24,p-=y,!(16&(y=w>>>16&255))){if(!(64&y)){w=g[(65535&w)+(f&(1<<y)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(x=65535&w,p<(y&=15)&&(f+=k[r++]<<p,(p+=8)<y&&(f+=k[r++]<<p,p+=8)),c<(x+=f&(1<<y)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=y,p-=y,(y=a-o)<x){if(u<(y=x-y)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(I=h,(E=0)===d){if(E+=l-y,y<v){for(v-=y;C[a++]=h[E++],--y;);E=a-x,I=C}}else if(d<y){if(E+=l+d-y,(y-=d)<v){for(v-=y;C[a++]=h[E++],--y;);if(E=0,d<v){for(v-=y=d;C[a++]=h[E++],--y;);E=a-x,I=C}}}else if(E+=d-y,y<v){for(v-=y;C[a++]=h[E++],--y;);E=a-x,I=C}for(;2<v;)C[a++]=I[E++],C[a++]=I[E++],C[a++]=I[E++],v-=3;v&&(C[a++]=I[E++],1<v&&(C[a++]=I[E++]))}else{for(E=a-x;C[a++]=C[E++],C[a++]=C[E++],C[a++]=C[E++],2<(v-=3););v&&(C[a++]=C[E++],1<v&&(C[a++]=C[E++]))}break}}break}}while(r<i&&a<s);r-=v=p>>3,f&=(1<<(p-=v<<3))-1,e.next_in=r,e.next_out=a,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=a<s?s-a+257:257-(a-s),n.hold=f,n.bits=p}},{}],49:[function(e,t,n){"use strict";var r=e("../utils/common"),i=e("./adler32"),a=e("./crc32"),o=e("./inffast"),s=e("./inftrees"),c=-2;function l(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(852),t.distcode=t.distdyn=new r.Buf32(592),t.sane=1,t.back=-1,0):c}function h(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,d(e)):c}function f(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?c:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,h(e))):c}function p(e,t){var n,r;return e?(r=new u,(e.state=r).window=null,0!==(n=f(e,t))&&(e.state=null),n):c}var m,g,_=!0;function b(e){if(_){var t;for(m=new r.Buf32(512),g=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,m,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,g,0,e.work,{bits:5}),_=!1}e.lencode=m,e.lenbits=9,e.distcode=g,e.distbits=5}function w(e,t,n,i){var a,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new r.Buf8(o.wsize)),i>=o.wsize?(r.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(i<(a=o.wsize-o.wnext)&&(a=i),r.arraySet(o.window,t,n-i,a,o.wnext),(i-=a)?(r.arraySet(o.window,t,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}n.inflateReset=h,n.inflateReset2=f,n.inflateResetKeep=d,n.inflateInit=function(e){return p(e,15)},n.inflateInit2=p,n.inflate=function(e,t){var n,u,d,h,f,p,m,g,_,y,v,x,E,I,k,C,z,B,S,A,L,R,T,F,M=0,P=new r.Buf8(4),N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return c;12===(n=e.state).mode&&(n.mode=13),f=e.next_out,d=e.output,m=e.avail_out,h=e.next_in,u=e.input,p=e.avail_in,g=n.hold,_=n.bits,y=p,v=m,R=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;_<16;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}if(2&n.wrap&&35615===g){P[n.check=0]=255&g,P[1]=g>>>8&255,n.check=a(n.check,P,2,0),_=g=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&g)<<8)+(g>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&g)){e.msg="unknown compression method",n.mode=30;break}if(_-=4,L=8+(15&(g>>>=4)),0===n.wbits)n.wbits=L;else if(L>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<L,e.adler=n.check=1,n.mode=512&g?10:12,_=g=0;break;case 2:for(;_<16;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}if(n.flags=g,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=g>>8&1),512&n.flags&&(P[0]=255&g,P[1]=g>>>8&255,n.check=a(n.check,P,2,0)),_=g=0,n.mode=3;case 3:for(;_<32;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}n.head&&(n.head.time=g),512&n.flags&&(P[0]=255&g,P[1]=g>>>8&255,P[2]=g>>>16&255,P[3]=g>>>24&255,n.check=a(n.check,P,4,0)),_=g=0,n.mode=4;case 4:for(;_<16;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}n.head&&(n.head.xflags=255&g,n.head.os=g>>8),512&n.flags&&(P[0]=255&g,P[1]=g>>>8&255,n.check=a(n.check,P,2,0)),_=g=0,n.mode=5;case 5:if(1024&n.flags){for(;_<16;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}n.length=g,n.head&&(n.head.extra_len=g),512&n.flags&&(P[0]=255&g,P[1]=g>>>8&255,n.check=a(n.check,P,2,0)),_=g=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(p<(x=n.length)&&(x=p),x&&(n.head&&(L=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,u,h,x,L)),512&n.flags&&(n.check=a(n.check,u,x,h)),p-=x,h+=x,n.length-=x),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===p)break e;for(x=0;L=u[h+x++],n.head&&L&&n.length<65536&&(n.head.name+=String.fromCharCode(L)),L&&x<p;);if(512&n.flags&&(n.check=a(n.check,u,x,h)),p-=x,h+=x,L)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===p)break e;for(x=0;L=u[h+x++],n.head&&L&&n.length<65536&&(n.head.comment+=String.fromCharCode(L)),L&&x<p;);if(512&n.flags&&(n.check=a(n.check,u,x,h)),p-=x,h+=x,L)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;_<16;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}if(g!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}_=g=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;_<32;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}e.adler=n.check=l(g),_=g=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=f,e.avail_out=m,e.next_in=h,e.avail_in=p,n.hold=g,n.bits=_,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){g>>>=7&_,_-=7&_,n.mode=27;break}for(;_<3;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}switch(n.last=1&g,_-=1,3&(g>>>=1)){case 0:n.mode=14;break;case 1:if(b(n),n.mode=20,6!==t)break;g>>>=2,_-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}g>>>=2,_-=2;break;case 14:for(g>>>=7&_,_-=7&_;_<32;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}if((65535&g)!=(g>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&g,_=g=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(x=n.length){if(p<x&&(x=p),m<x&&(x=m),0===x)break e;r.arraySet(d,u,h,x,f),p-=x,h+=x,m-=x,f+=x,n.length-=x;break}n.mode=12;break;case 17:for(;_<14;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}if(n.nlen=257+(31&g),g>>>=5,_-=5,n.ndist=1+(31&g),g>>>=5,_-=5,n.ncode=4+(15&g),g>>>=4,_-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;_<3;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}n.lens[N[n.have++]]=7&g,g>>>=3,_-=3}for(;n.have<19;)n.lens[N[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,T={bits:n.lenbits},R=s(0,n.lens,0,19,n.lencode,0,n.work,T),n.lenbits=T.bits,R){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;C=(M=n.lencode[g&(1<<n.lenbits)-1])>>>16&255,z=65535&M,!((k=M>>>24)<=_);){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}if(z<16)g>>>=k,_-=k,n.lens[n.have++]=z;else{if(16===z){for(F=k+2;_<F;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}if(g>>>=k,_-=k,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}L=n.lens[n.have-1],x=3+(3&g),g>>>=2,_-=2}else if(17===z){for(F=k+3;_<F;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}_-=k,L=0,x=3+(7&(g>>>=k)),g>>>=3,_-=3}else{for(F=k+7;_<F;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}_-=k,L=0,x=11+(127&(g>>>=k)),g>>>=7,_-=7}if(n.have+x>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;x--;)n.lens[n.have++]=L}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,T={bits:n.lenbits},R=s(1,n.lens,0,n.nlen,n.lencode,0,n.work,T),n.lenbits=T.bits,R){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,T={bits:n.distbits},R=s(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,T),n.distbits=T.bits,R){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=p&&258<=m){e.next_out=f,e.avail_out=m,e.next_in=h,e.avail_in=p,n.hold=g,n.bits=_,o(e,v),f=e.next_out,d=e.output,m=e.avail_out,h=e.next_in,u=e.input,p=e.avail_in,g=n.hold,_=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;C=(M=n.lencode[g&(1<<n.lenbits)-1])>>>16&255,z=65535&M,!((k=M>>>24)<=_);){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}if(C&&!(240&C)){for(B=k,S=C,A=z;C=(M=n.lencode[A+((g&(1<<B+S)-1)>>B)])>>>16&255,z=65535&M,!(B+(k=M>>>24)<=_);){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}g>>>=B,_-=B,n.back+=B}if(g>>>=k,_-=k,n.back+=k,n.length=z,0===C){n.mode=26;break}if(32&C){n.back=-1,n.mode=12;break}if(64&C){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&C,n.mode=22;case 22:if(n.extra){for(F=n.extra;_<F;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}n.length+=g&(1<<n.extra)-1,g>>>=n.extra,_-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;C=(M=n.distcode[g&(1<<n.distbits)-1])>>>16&255,z=65535&M,!((k=M>>>24)<=_);){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}if(!(240&C)){for(B=k,S=C,A=z;C=(M=n.distcode[A+((g&(1<<B+S)-1)>>B)])>>>16&255,z=65535&M,!(B+(k=M>>>24)<=_);){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}g>>>=B,_-=B,n.back+=B}if(g>>>=k,_-=k,n.back+=k,64&C){e.msg="invalid distance code",n.mode=30;break}n.offset=z,n.extra=15&C,n.mode=24;case 24:if(n.extra){for(F=n.extra;_<F;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}n.offset+=g&(1<<n.extra)-1,g>>>=n.extra,_-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===m)break e;if(x=v-m,n.offset>x){if((x=n.offset-x)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}E=x>n.wnext?(x-=n.wnext,n.wsize-x):n.wnext-x,x>n.length&&(x=n.length),I=n.window}else I=d,E=f-n.offset,x=n.length;for(m<x&&(x=m),m-=x,n.length-=x;d[f++]=I[E++],--x;);0===n.length&&(n.mode=21);break;case 26:if(0===m)break e;d[f++]=n.length,m--,n.mode=21;break;case 27:if(n.wrap){for(;_<32;){if(0===p)break e;p--,g|=u[h++]<<_,_+=8}if(v-=m,e.total_out+=v,n.total+=v,v&&(e.adler=n.check=n.flags?a(n.check,d,v,f-v):i(n.check,d,v,f-v)),v=m,(n.flags?g:l(g))!==n.check){e.msg="incorrect data check",n.mode=30;break}_=g=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;_<32;){if(0===p)break e;p--,g+=u[h++]<<_,_+=8}if(g!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}_=g=0}n.mode=29;case 29:R=1;break e;case 30:R=-3;break e;case 31:return-4;default:return c}return e.next_out=f,e.avail_out=m,e.next_in=h,e.avail_in=p,n.hold=g,n.bits=_,(n.wsize||v!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&w(e,e.output,e.next_out,v-e.avail_out)?(n.mode=31,-4):(y-=e.avail_in,v-=e.avail_out,e.total_in+=y,e.total_out+=v,n.total+=v,n.wrap&&v&&(e.adler=n.check=n.flags?a(n.check,d,v,e.next_out-v):i(n.check,d,v,e.next_out-v)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==y&&0===v||4===t)&&0===R&&(R=-5),R)},n.inflateEnd=function(e){if(!e||!e.state)return c;var t=e.state;return t.window&&(t.window=null),e.state=null,0},n.inflateGetHeader=function(e,t){var n;return e&&e.state&&2&(n=e.state).wrap?((n.head=t).done=!1,0):c},n.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?c:11===n.mode&&i(1,t,r,0)!==n.check?-3:w(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,0):c},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){"use strict";var r=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,c,l,u,d,h){var f,p,m,g,_,b,w,y,v,x=h.bits,E=0,I=0,k=0,C=0,z=0,B=0,S=0,A=0,L=0,R=0,T=null,F=0,M=new r.Buf16(16),P=new r.Buf16(16),N=null,W=0;for(E=0;E<=15;E++)M[E]=0;for(I=0;I<c;I++)M[t[n+I]]++;for(z=x,C=15;1<=C&&0===M[C];C--);if(C<z&&(z=C),0===C)return l[u++]=20971520,l[u++]=20971520,h.bits=1,0;for(k=1;k<C&&0===M[k];k++);for(z<k&&(z=k),E=A=1;E<=15;E++)if(A<<=1,(A-=M[E])<0)return-1;if(0<A&&(0===e||1!==C))return-1;for(P[1]=0,E=1;E<15;E++)P[E+1]=P[E]+M[E];for(I=0;I<c;I++)0!==t[n+I]&&(d[P[t[n+I]]++]=I);if(b=0===e?(T=N=d,19):1===e?(T=i,F-=257,N=a,W-=257,256):(T=o,N=s,-1),E=k,_=u,S=I=R=0,m=-1,g=(L=1<<(B=z))-1,1===e&&852<L||2===e&&592<L)return 1;for(;;){for(w=E-S,v=d[I]<b?(y=0,d[I]):d[I]>b?(y=N[W+d[I]],T[F+d[I]]):(y=96,0),f=1<<E-S,k=p=1<<B;l[_+(R>>S)+(p-=f)]=w<<24|y<<16|v,0!==p;);for(f=1<<E-1;R&f;)f>>=1;if(0!==f?(R&=f-1,R+=f):R=0,I++,0==--M[E]){if(E===C)break;E=t[n+d[I]]}if(z<E&&(R&g)!==m){for(0===S&&(S=z),_+=k,A=1<<(B=E-S);B+S<C&&!((A-=M[B+S])<=0);)B++,A<<=1;if(L+=1<<B,1===e&&852<L||2===e&&592<L)return 1;l[m=R&g]=z<<24|B<<16|_-u}}return 0!==R&&(l[_+R]=E-S<<24|64<<16),h.bits=z,0}},{"../utils/common":41}],51:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){"use strict";var r=e("../utils/common");function i(e){for(var t=e.length;0<=--t;)e[t]=0}var a=256,o=286,s=30,c=15,l=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],u=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],h=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=new Array(576);i(f);var p=new Array(60);i(p);var m=new Array(512);i(m);var g=new Array(256);i(g);var _=new Array(29);i(_);var b,w,y,v=new Array(s);function x(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function E(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function I(e){return e<256?m[e]:m[256+(e>>>7)]}function k(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function C(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,k(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function z(e,t,n){C(e,n[2*t],n[2*t+1])}function B(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function S(e,t,n){var r,i,a=new Array(16),o=0;for(r=1;r<=c;r++)a[r]=o=o+n[r-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=B(a[s]++,s))}}function A(e){var t;for(t=0;t<o;t++)e.dyn_ltree[2*t]=0;for(t=0;t<s;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function L(e){8<e.bi_valid?k(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function R(e,t,n,r){var i=2*t,a=2*n;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]}function T(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&R(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!R(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function F(e,t,n){var r,i,o,s,c=0;if(0!==e.last_lit)for(;r=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],i=e.pending_buf[e.l_buf+c],c++,0===r?z(e,i,t):(z(e,(o=g[i])+a+1,t),0!==(s=l[o])&&C(e,i-=_[o],s),z(e,o=I(--r),n),0!==(s=u[o])&&C(e,r-=v[o],s)),c<e.last_lit;);z(e,256,t)}function M(e,t){var n,r,i,a=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<l;n++)0!==a[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)a[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=o[2*i+1]);for(t.max_code=u,n=e.heap_len>>1;1<=n;n--)T(e,a,n);for(i=l;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],T(e,a,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,a[2*i]=a[2*n]+a[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,a[2*n+1]=a[2*r+1]=i,e.heap[1]=i++,T(e,a,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,a,o,s,l=t.dyn_tree,u=t.max_code,d=t.stat_desc.static_tree,h=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,m=t.stat_desc.max_length,g=0;for(a=0;a<=c;a++)e.bl_count[a]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)m<(a=l[2*l[2*(r=e.heap[n])+1]+1]+1)&&(a=m,g++),l[2*r+1]=a,u<r||(e.bl_count[a]++,o=0,p<=r&&(o=f[r-p]),s=l[2*r],e.opt_len+=s*(a+o),h&&(e.static_len+=s*(d[2*r+1]+o)));if(0!==g){do{for(a=m-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[m]--,g-=2}while(0<g);for(a=m;0!==a;a--)for(r=e.bl_count[a];0!==r;)u<(i=e.heap[--n])||(l[2*i+1]!==a&&(e.opt_len+=(a-l[2*i+1])*l[2*i],l[2*i+1]=a),r--)}}(e,t),S(a,u,e.bl_count)}function P(e,t,n){var r,i,a=-1,o=t[1],s=0,c=7,l=4;for(0===o&&(c=138,l=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=t[2*(r+1)+1],++s<c&&i===o||(s<l?e.bl_tree[2*i]+=s:0!==i?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=i,l=(s=0)===o?(c=138,3):i===o?(c=6,3):(c=7,4))}function N(e,t,n){var r,i,a=-1,o=t[1],s=0,c=7,l=4;for(0===o&&(c=138,l=3),r=0;r<=n;r++)if(i=o,o=t[2*(r+1)+1],!(++s<c&&i===o)){if(s<l)for(;z(e,i,e.bl_tree),0!=--s;);else 0!==i?(i!==a&&(z(e,i,e.bl_tree),s--),z(e,16,e.bl_tree),C(e,s-3,2)):s<=10?(z(e,17,e.bl_tree),C(e,s-3,3)):(z(e,18,e.bl_tree),C(e,s-11,7));a=i,l=(s=0)===o?(c=138,3):i===o?(c=6,3):(c=7,4)}}i(v);var W=!1;function O(e,t,n,i){C(e,0+(i?1:0),3),function(e,t,n){L(e),k(e,n),k(e,~n),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n)}n._tr_init=function(e){W||(function(){var e,t,n,r,i,a=new Array(16);for(r=n=0;r<28;r++)for(_[r]=n,e=0;e<1<<l[r];e++)g[n++]=r;for(g[n-1]=r,r=i=0;r<16;r++)for(v[r]=i,e=0;e<1<<u[r];e++)m[i++]=r;for(i>>=7;r<s;r++)for(v[r]=i<<7,e=0;e<1<<u[r]-7;e++)m[256+i++]=r;for(t=0;t<=c;t++)a[t]=0;for(e=0;e<=143;)f[2*e+1]=8,e++,a[8]++;for(;e<=255;)f[2*e+1]=9,e++,a[9]++;for(;e<=279;)f[2*e+1]=7,e++,a[7]++;for(;e<=287;)f[2*e+1]=8,e++,a[8]++;for(S(f,287,a),e=0;e<s;e++)p[2*e+1]=5,p[2*e]=B(e,5);b=new x(f,l,257,o,c),w=new x(p,u,0,s,c),y=new x(new Array(0),d,0,19,7)}(),W=!0),e.l_desc=new E(e.dyn_ltree,b),e.d_desc=new E(e.dyn_dtree,w),e.bl_desc=new E(e.bl_tree,y),e.bi_buf=0,e.bi_valid=0,A(e)},n._tr_stored_block=O,n._tr_flush_block=function(e,t,n,r){var i,o,s=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<a;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),M(e,e.l_desc),M(e,e.d_desc),s=function(e){var t;for(P(e,e.dyn_ltree,e.l_desc.max_code),P(e,e.dyn_dtree,e.d_desc.max_code),M(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*h[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=n+5,n+4<=i&&-1!==t?O(e,t,n,r):4===e.strategy||o===i?(C(e,2+(r?1:0),3),F(e,f,p)):(C(e,4+(r?1:0),3),function(e,t,n,r){var i;for(C(e,t-257,5),C(e,n-1,5),C(e,r-4,4),i=0;i<r;i++)C(e,e.bl_tree[2*h[i]+1],3);N(e,e.dyn_ltree,t-1),N(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),F(e,e.dyn_ltree,e.dyn_dtree)),A(e),r&&L(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(g[n]+a+1)]++,e.dyn_dtree[2*I(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){C(e,2,3),z(e,256,f),function(e){16===e.bi_valid?(k(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){(function(e){!function(e){"use strict";if(!e.setImmediate){var t,n,r,i,a=1,o={},s=!1,c=e.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(e);l=l&&l.setTimeout?l:e,t="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick(function(){d(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(i="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",h,!1):e.attachEvent("onmessage",h),function(t){e.postMessage(i+t,"*")}):e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){d(e.data)},function(e){r.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){d(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):function(e){setTimeout(d,0,e)},l.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var n=new Array(arguments.length-1),r=0;r<n.length;r++)n[r]=arguments[r+1];var i={callback:e,args:n};return o[a]=i,t(a),a++},l.clearImmediate=u}function u(e){delete o[e]}function d(e){if(s)setTimeout(d,0,e);else{var t=o[e];if(t){s=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{u(e),s=!1}}}}function h(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(i)&&d(+t.data.slice(i.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},640(e,t,n){"use strict";e.exports=n.p+"aceedeb416c3ef67d1dd.wasm"},482(e,t,n){"use strict";e.exports=n.p+"d8d500e523bf0431d020.wasm"},147(e,t,n){"use strict";e.exports=n.p+"98c86cc689f471d8c402.wasm"},281(e,t,n){"use strict";e.exports=n.p+"70d14377bae88f32e492.wasm"},192(e,t,n){"use strict";e.exports=n.p+"13a21edca08a3be3abd8.wasm"},901(e,t,n){"use strict";e.exports=n.p+"3802306e7b58a11862fb.wasm"}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var a=r[e]={exports:{}};return n[e](a,a.exports,i),a.exports}i.m=n,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce((t,n)=>(i.f[n](e,t),t),[])),i.u=e=>e+".main.js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="batch-image-resizer:",i.l=(n,r,a,o)=>{if(e[n])e[n].push(r);else{var s,c;if(void 0!==a)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+a){s=d;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+a),s.src=n),e[n]=[r];var h=(t,r)=>{s.onerror=s.onload=null,clearTimeout(f);var i=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach(e=>e(r)),t)return t(r)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),c&&document.head.appendChild(s)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{i.b="undefined"!=typeof document&&document.baseURI||self.location.href;var e={792:0};i.f.j=(t,n)=>{var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var a=new Promise((n,i)=>r=e[t]=[n,i]);n.push(r[2]=a);var o=i.p+i.u(t),s=new Error;i.l(o,n=>{if(i.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,r[1](s)}},"chunk-"+t,t)}};var t=(t,n)=>{var r,a,[o,s,c]=n,l=0;if(o.some(t=>0!==e[t])){for(r in s)i.o(s,r)&&(i.m[r]=s[r]);c&&c(i)}for(t&&t(n);l<o.length;l++)a=o[l],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0},n=self.webpackChunkbatch_image_resizer=self.webpackChunkbatch_image_resizer||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";var e={};i.r(e),i.d(e,{PhotonImage:()=>vr,Rgb:()=>Er,Rgba:()=>kr,SamplingFilter:()=>wr,add_noise_rand:()=>Zt,adjust_brightness:()=>Un,adjust_contrast:()=>qn,alter_blue_channel:()=>Se,alter_channel:()=>Ce,alter_channels:()=>Le,alter_green_channel:()=>Be,alter_red_channel:()=>ze,alter_two_channels:()=>Ae,apply_gradient:()=>Vt,b_grayscale:()=>et,base64_to_image:()=>hr,base64_to_vec:()=>fr,blend:()=>Xt,box_blur:()=>Tt,cali:()=>on,color_horizontal_strips:()=>Qn,color_vertical_strips:()=>Yn,colorize:()=>On,create_gradient:()=>Yt,crop:()=>gn,crop_img_browser:()=>_n,darken_hsl:()=>xt,darken_hsluv:()=>vt,darken_hsv:()=>Et,darken_lch:()=>yt,dec_brightness:()=>Hn,decompose_max:()=>Ye,decompose_min:()=>Xe,default:()=>Ar,desaturate:()=>Qe,desaturate_hsl:()=>kt,desaturate_hsluv:()=>zt,desaturate_hsv:()=>It,desaturate_lch:()=>Ct,detect_135_deg_lines:()=>Wt,detect_45_deg_lines:()=>Nt,detect_horizontal_lines:()=>Mt,detect_vertical_lines:()=>Pt,dither:()=>tr,dramatic:()=>sn,draw_text:()=>ir,draw_text_with_border:()=>rr,duotone:()=>nr,duotone_horizon:()=>un,duotone_lilac:()=>hn,duotone_ochre:()=>fn,duotone_tint:()=>dn,duotone_violette:()=>ln,edge_detection:()=>Lt,edge_one:()=>Dt,emboss:()=>jt,filter:()=>tn,firenze:()=>pn,fliph:()=>bn,flipv:()=>wn,frosted_glass:()=>Kn,g_grayscale:()=>Je,gamma_correction:()=>rt,gaussian_blur:()=>Ft,get_image_data:()=>cr,golden:()=>an,grayscale:()=>Ze,grayscale_human_corrected:()=>Ge,grayscale_shades:()=>Ve,halftone:()=>Nn,horizontal_strips:()=>Gn,hsl:()=>ot,hsluv:()=>it,hsv:()=>st,hue_rotate_hsl:()=>ct,hue_rotate_hsluv:()=>dt,hue_rotate_hsv:()=>lt,hue_rotate_lch:()=>ut,identity:()=>Rt,inc_brightness:()=>$n,initSync:()=>Br,invert:()=>Ne,laplace:()=>Ot,lch:()=>at,lighten_hsl:()=>bt,lighten_hsluv:()=>_t,lighten_hsv:()=>wt,lighten_lch:()=>gt,lix:()=>Jt,lofi:()=>nn,mix_with_colour:()=>Bt,monochrome:()=>He,monochrome_tint:()=>cn,multiple_offsets:()=>Pn,neue:()=>Kt,noise_reduction:()=>St,normalize:()=>er,obsidian:()=>mn,offset:()=>Rn,offset_blue:()=>Mn,offset_green:()=>Fn,offset_red:()=>Tn,oil:()=>Vn,open_image:()=>ur,padding_bottom:()=>Sn,padding_left:()=>Cn,padding_right:()=>zn,padding_top:()=>Bn,padding_uniform:()=>kn,pastel_pink:()=>rn,pink_noise:()=>Gt,pixelize:()=>Jn,prewitt_horizontal:()=>$t,primary:()=>Wn,putImageData:()=>lr,r_grayscale:()=>Ke,remove_blue_channel:()=>Me,remove_channel:()=>Re,remove_green_channel:()=>Fe,remove_red_channel:()=>Te,resample:()=>Ln,resize:()=>vn,resize_img_browser:()=>yn,rotate:()=>An,run:()=>sr,ryo:()=>en,saturate_hsl:()=>ht,saturate_hsluv:()=>pt,saturate_hsv:()=>mt,saturate_lch:()=>ft,seam_carve:()=>xn,selective_color_convert:()=>Oe,selective_desaturate:()=>je,selective_greyscale:()=>$e,selective_hue_rotate:()=>We,selective_lighten:()=>De,selective_saturate:()=>Ue,sepia:()=>qe,sharpen:()=>At,shearx:()=>En,sheary:()=>In,single_channel_grayscale:()=>tt,sobel_global:()=>qt,sobel_horizontal:()=>Ut,sobel_vertical:()=>Ht,solarize:()=>Dn,solarize_retimg:()=>jn,swap_channels:()=>Pe,threshold:()=>nt,tint:()=>Zn,to_image_data:()=>pr,to_raw_pixels:()=>dr,vertical_strips:()=>Xn,watermark:()=>Qt});var t=i(710),n=i.n(t);let r,a=null,o=0;let s=null;function c(){return null!==s&&0!==s.byteLength||(s=new Int32Array(r.memory.buffer)),s}let l=null;async function u(e){if(void 0!==r)return r;void 0===e&&(e=new URL(i(192),i.b));const t={wbg:{}};("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:o}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return function(e,t){return r=e.exports,u.__wbindgen_wasm_module=t,s=null,a=null,l=null,r}(n,o)}const d=u,h=void 0!==globalThis.ServiceWorkerGlobalScope&&"undefined"!=typeof self&&globalThis.caches&&void 0!==globalThis.caches.default,f="object"==typeof process&&process.release&&"node"===process.release.name;let p;(h||f)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(e,t,n){this.data=e,this.width=t,this.height=n}}),"undefined"!=typeof self&&void 0===self.location&&(self.location={href:""}));let m=null;function g(){return null!==m&&0!==m.byteLength||(m=new Uint32Array(p.memory.buffer)),m}let _=0,b=null;function w(){return null!==b&&0!==b.byteLength||(b=new Int32Array(p.memory.buffer)),b}async function y(e){if(void 0!==p)return p;void 0===e&&(e=new URL(i(147),i.b));const t={wbg:{}};("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return function(e,t){return p=e.exports,y.__wbindgen_wasm_module=t,b=null,m=null,p}(n,r)}const v=y,x=void 0!==globalThis.ServiceWorkerGlobalScope&&"undefined"!=typeof self&&globalThis.caches&&void 0!==globalThis.caches.default,E="object"==typeof process&&process.release&&"node"===process.release.name;let I;(x||E)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(e,t,n){this.data=e,this.width=t,this.height=n}}),"undefined"!=typeof self&&void 0===self.location&&(self.location={href:""}));let k=null;function C(){return null!==k&&0!==k.byteLength||(k=new Uint8Array(I.memory.buffer)),k}let z=null;const B=new TextEncoder;"encodeInto"in B||(B.encodeInto=function(e,t){const n=B.encode(e);return t.set(n),{read:e.length,written:n.length}});let S=0;const A=new Set(["basic","cors","default"]);function L(){const e={wbg:{}};return e.wbg.__wbg_new_with_owned_u8_clamped_array_and_sh_e8143e95833a3ec3=function(e,t,n,r){var i,a,o=(i=e,a=t,i>>>=0,(null!==z&&0!==z.byteLength||(z=new Uint8ClampedArray(I.memory.buffer)),z).subarray(i/1,i/1+a)).slice();return I.__wbindgen_free(e,1*t,1),new ImageData(o,n>>>0,r>>>0)},e.wbg.__wbindgen_init_externref_table=function(){const e=I.__wbindgen_externrefs,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},e}async function R(e){if(void 0!==I)return I;void 0!==e&&(Object.getPrototypeOf(e)===Object.prototype?({module_or_path:e}=e):console.warn("using deprecated parameters for the initialization function; pass a single object instead")),void 0===e&&(e=new URL(i(281),i.b));const t=L();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if(!e.ok||!A.has(e.type)||"application/wasm"===e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return function(e,t){return I=e.exports,R.__wbindgen_wasm_module=t,k=null,z=null,I.__wbindgen_start(),I}(n,r)}const T=R,F=void 0!==globalThis.ServiceWorkerGlobalScope&&"undefined"!=typeof self&&globalThis.caches&&void 0!==globalThis.caches.default,M="object"==typeof process&&process.release&&"node"===process.release.name;(F||M)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(e,t,n){this.data=e,this.width=t,this.height=n}}),"undefined"!=typeof self&&void 0===self.location&&(self.location={href:""}));const P={width:1,height:1,method:"lanczos3",fitMethod:"stretch",premultiply:!0,linearRGB:!0},N=["magicKernel","magicKernelSharp2013","magicKernelSharp2021"];let W,O,D;const j=["triangle","catrom","mitchell","lanczos3"];async function U(e,t){await(O||(O=v(void 0)),O);const n=t.width/e.width,r=t.height/e.height,i=Math.max(n,r),a=function(e,{min:t=Number.MIN_VALUE,max:n=Number.MAX_VALUE}){return Math.min(Math.max(e,t),n)}(Math.ceil(i),{min:1,max:4});if(1===a)return e;const o=function(e,t,n,r){try{const l=p.__wbindgen_add_to_stack_pointer(-16),u=function(e,t){const n=t(4*e.length,4)>>>0;return g().set(e,n/4),_=e.length,n}(e,p.__wbindgen_malloc),d=_;p.resize(l,u,d,t,n,r);var i=w()[l/4+0],a=w()[l/4+1],o=(s=i,c=a,s>>>=0,g().subarray(s/4,s/4+c)).slice();return p.__wbindgen_free(i,4*a,4),o}finally{p.__wbindgen_add_to_stack_pointer(16)}var s,c}(new Uint32Array(e.data.buffer),e.width,e.height,a);return new ImageData(new Uint8ClampedArray(o.buffer),e.width*a,e.height*a)}async function $(e,t){return await(D||(D=T(void 0)),D),function(e,t,n,r,i,a){const o=function(e,t){const n=t(1*e.length,1)>>>0;return C().set(e,n/1),S=e.length,n}(e,I.__wbindgen_malloc),s=S,c=function(e,t,n){if(void 0===n){const n=B.encode(e),r=t(n.length,1)>>>0;return C().subarray(r,r+n.length).set(n),S=n.length,r}let r=e.length,i=t(r,1)>>>0;const a=C();let o=0;for(;o<r;o++){const t=e.charCodeAt(o);if(t>127)break;a[i+o]=t}if(o!==r){0!==o&&(e=e.slice(o)),i=n(i,r,r=o+3*e.length,1)>>>0;const t=C().subarray(i+o,i+r);o+=B.encodeInto(e,t).written,i=n(i,r,o,1)>>>0}return S=o,i}(a,I.__wbindgen_malloc,I.__wbindgen_realloc),l=S;return I.resize(o,s,t,n,r,i,c,l)}(new Uint8Array(e.data.buffer),e.width,e.height,t.width,t.height,t.method)}async function H(e,t){let n={...P,...t},i=e;var s;if(W||(W=d(void 0)),"hqx"===n.method&&(i=await U(i,n),n={...n,method:"catrom"}),await W,"contain"===n.fitMethod){const{sx:t,sy:r,sw:a,sh:o}=function(e,t,n,r){const i=n/r;if(i>e/t){const n=e/i;return{sw:e,sh:n,sx:0,sy:(t-n)/2}}const a=t*i;return{sh:t,sw:a,sx:(e-a)/2,sy:0}}(e.width,e.height,n.width,n.height);i=function(e,t,n,r,i){const a=new Uint32Array(e.data.buffer);for(let o=0;o<i;o+=1){const i=(o+n)*e.width+t;a.copyWithin(o*r,i,i+r)}return new ImageData(new Uint8ClampedArray(a.buffer.slice(0,r*i*4)),r,i)}(i,Math.round(t),Math.round(r),Math.round(a),Math.round(o))}if(s=n,N.includes(s.method))return $(i,n);const u=function(e,t,n,i,s,u,d,h){try{const b=r.__wbindgen_add_to_stack_pointer(-16),w=function(e,t){const n=t(1*e.length,1)>>>0;return(null!==a&&0!==a.byteLength||(a=new Uint8Array(r.memory.buffer)),a).set(e,n/1),o=e.length,n}(e,r.__wbindgen_malloc),y=o;r.resize(b,w,y,t,n,i,s,u,d,h);var f=c()[b/4+0],p=c()[b/4+1],m=(g=f,_=p,g>>>=0,(null!==l&&0!==l.byteLength||(l=new Uint8ClampedArray(r.memory.buffer)),l).subarray(g/1,g/1+_)).slice();return r.__wbindgen_free(f,1*p,1),m}finally{r.__wbindgen_add_to_stack_pointer(16)}var g,_}(new Uint8Array(i.data.buffer),i.width,i.height,n.width,n.height,j.indexOf(n.method),n.premultiply,n.linearRGB);return new ImageData(new Uint8ClampedArray(u.buffer),n.width,n.height)}var q,Z=(q="file:///home/ian/code/newgit/batch-image-resizer/node_modules/@jsquash/jpeg/codec/enc/mozjpeg_enc.js",function(e={}){var t,n,r=e,a=new Promise((e,r)=>{t=e,n=r});const o=void 0!==globalThis.ServiceWorkerGlobalScope&&"undefined"!=typeof self&&globalThis.caches&&void 0!==globalThis.caches.default,s="object"==typeof process&&process.release&&"node"===process.release.name;(o||s)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(e,t,n){this.data=e,this.width=t,this.height=n}}),"undefined"!=typeof self&&void 0===self.location&&(self.location={href:""}));var c,l=Object.assign({},r),u="./this.program",d=(e,t)=>{throw t},h="object"==typeof window,f="function"==typeof importScripts,p=("object"==typeof process&&"object"==typeof process.versions&&process.versions.node,"");(h||f)&&(f?p=self.location.href:"undefined"!=typeof document&&document.currentScript&&(p=document.currentScript.src),q&&(p=q),p=p.startsWith("blob:")?"":p.substr(0,p.replace(/[?#].*/,"").lastIndexOf("/")+1),f&&(c=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}));var m,g,_=r.print||console.log.bind(console),b=r.printErr||console.error.bind(console);Object.assign(r,l),l=null,r.arguments&&r.arguments,r.thisProgram&&(u=r.thisProgram),r.quit&&(d=r.quit),r.wasmBinary&&(m=r.wasmBinary);var w,y,v,x,E,I,k,C,z=!1;function B(){var e=g.buffer;r.HEAP8=w=new Int8Array(e),r.HEAP16=v=new Int16Array(e),r.HEAPU8=y=new Uint8Array(e),r.HEAPU16=x=new Uint16Array(e),r.HEAP32=E=new Int32Array(e),r.HEAPU32=I=new Uint32Array(e),r.HEAPF32=k=new Float32Array(e),r.HEAPF64=C=new Float64Array(e)}var S=[],A=[],L=[];function R(e){S.unshift(e)}function T(e){L.unshift(e)}var F=0,M=null,P=null;function N(e){r.onAbort?.(e),b(e="Aborted("+e+")"),z=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw n(t),t}var W,O,D=e=>e.startsWith("data:application/octet-stream;base64,");function j(e){if(e==W&&m)return new Uint8Array(m);if(c)return c(e);throw"both async and sync fetching of the wasm failed"}function U(e,t,n){return function(e){return m||!h&&!f||"function"!=typeof fetch?Promise.resolve().then(()=>j(e)):fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw`failed to load wasm binary file at '${e}'`;return t.arrayBuffer()}).catch(()=>j(e))}(e).then(e=>WebAssembly.instantiate(e,t)).then(n,e=>{b(`failed to asynchronously prepare wasm: ${e}`),N(e)})}function $(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}r.locateFile?D(W="mozjpeg_enc.wasm")||(O=W,W=r.locateFile?r.locateFile(O,p):p+O):W=new URL(i(640),i.b).href;var H=e=>{for(;e.length>0;)e.shift()(r)},Z=r.noExitRuntime||!0;class G{constructor(e){this.excPtr=e,this.ptr=e-24}set_type(e){I[this.ptr+4>>2]=e}get_type(){return I[this.ptr+4>>2]}set_destructor(e){I[this.ptr+8>>2]=e}get_destructor(){return I[this.ptr+8>>2]}set_caught(e){e=e?1:0,w[this.ptr+12]=e}get_caught(){return 0!=w[this.ptr+12]}set_rethrown(e){e=e?1:0,w[this.ptr+13]=e}get_rethrown(){return 0!=w[this.ptr+13]}init(e,t){this.set_adjusted_ptr(0),this.set_type(e),this.set_destructor(t)}set_adjusted_ptr(e){I[this.ptr+16>>2]=e}get_adjusted_ptr(){return I[this.ptr+16>>2]}get_exception_ptr(){if(Ye(this.get_type()))return I[this.excPtr>>2];var e=this.get_adjusted_ptr();return 0!==e?e:this.excPtr}}var Q={},X=e=>{for(;e.length;){var t=e.pop();e.pop()(t)}};function Y(e){return this.fromWireType(I[e>>2])}var V,K,J,ee={},te={},ne={},re=e=>{throw new V(e)},ie=(e,t,n)=>{function r(t){var r=n(t);r.length!==e.length&&re("Mismatched type converter count");for(var i=0;i<e.length;++i)se(e[i],r[i])}e.forEach(function(e){ne[e]=t});var i=new Array(t.length),a=[],o=0;t.forEach((e,t)=>{te.hasOwnProperty(e)?i[t]=te[e]:(a.push(e),ee.hasOwnProperty(e)||(ee[e]=[]),ee[e].push(()=>{i[t]=te[e],++o===a.length&&r(i)}))}),0===a.length&&r(i)},ae=e=>{for(var t="",n=e;y[n];)t+=K[y[n++]];return t},oe=e=>{throw new J(e)};function se(e,t,n={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");return function(e,t,n={}){var r=t.name;if(e||oe(`type "${r}" must have a positive integer typeid pointer`),te.hasOwnProperty(e)){if(n.ignoreDuplicateRegistrations)return;oe(`Cannot register type '${r}' twice`)}if(te[e]=t,delete ne[e],ee.hasOwnProperty(e)){var i=ee[e];delete ee[e],i.forEach(e=>e())}}(e,t,n)}var ce,le,ue,de,he=[],fe=[],pe=e=>{e>9&&0===--fe[e+1]&&(fe[e]=void 0,he.push(e))},me=e=>(e||oe("Cannot use deleted val. handle = "+e),fe[e]),ge=e=>{switch(e){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const t=he.pop()||fe.length;return fe[t]=e,fe[t+1]=1,t}}},_e={name:"emscripten::val",fromWireType:e=>{var t=me(e);return pe(e),t},toWireType:(e,t)=>ge(t),argPackAdvance:8,readValueFromPointer:Y,destructorFunction:null},be=(e,t)=>{switch(t){case 4:return function(e){return this.fromWireType(k[e>>2])};case 8:return function(e){return this.fromWireType(C[e>>3])};default:throw new TypeError(`invalid float width (${t}): ${e}`)}},we=(e,t)=>Object.defineProperty(t,"name",{value:e}),ye=(e,t,n)=>{if(void 0===e[t].overloadTable){var r=e[t];e[t]=function(...r){return e[t].overloadTable.hasOwnProperty(r.length)||oe(`Function '${n}' called with an invalid number of arguments (${r.length}) - expects one of (${e[t].overloadTable})!`),e[t].overloadTable[r.length].apply(this,r)},e[t].overloadTable=[],e[t].overloadTable[r.argCount]=r}},ve=[],xe=e=>{var t=ve[e];return t||(e>=ve.length&&(ve.length=e+1),ve[e]=t=ce.get(e)),t},Ee=(e,t)=>{var n,i,a=(e=ae(e)).includes("j")?(n=e,i=t,(...e)=>((e,t,n=[])=>e.includes("j")?((e,t,n)=>(e=e.replace(/p/g,"i"),(0,r["dynCall_"+e])(t,...n)))(e,t,n):xe(t)(...n))(n,i,e)):xe(t);return"function"!=typeof a&&oe(`unknown function pointer with signature ${e}: ${t}`),a},Ie=e=>{var t=Ge(e),n=ae(t);return Xe(t),n},ke=(e,t,n)=>{switch(t){case 1:return n?e=>w[e]:e=>y[e];case 2:return n?e=>v[e>>1]:e=>x[e>>1];case 4:return n?e=>E[e>>2]:e=>I[e>>2];default:throw new TypeError(`invalid integer width (${t}): ${e}`)}},Ce=(e,t,n)=>{for(var r=t+n,i="";!(t>=r);){var a=e[t++];if(!a)return i;if(128&a){var o=63&e[t++];if(192!=(224&a)){var s=63&e[t++];if((a=224==(240&a)?(15&a)<<12|o<<6|s:(7&a)<<18|o<<12|s<<6|63&e[t++])<65536)i+=String.fromCharCode(a);else{var c=a-65536;i+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else i+=String.fromCharCode((31&a)<<6|o)}else i+=String.fromCharCode(a)}return i},ze=(e,t)=>e?Ce(y,e,t):"",Be=(e,t)=>{for(var n="",r=0;!(r>=t/2);++r){var i=v[e+2*r>>1];if(0==i)break;n+=String.fromCharCode(i)}return n},Se=(e,t,n)=>{if(n??=2147483647,n<2)return 0;for(var r=t,i=(n-=2)<2*e.length?n/2:e.length,a=0;a<i;++a){var o=e.charCodeAt(a);v[t>>1]=o,t+=2}return v[t>>1]=0,t-r},Ae=e=>2*e.length,Le=(e,t)=>{for(var n=0,r="";!(n>=t/4);){var i=E[e+4*n>>2];if(0==i)break;if(++n,i>=65536){var a=i-65536;r+=String.fromCharCode(55296|a>>10,56320|1023&a)}else r+=String.fromCharCode(i)}return r},Re=(e,t,n)=>{if(n??=2147483647,n<4)return 0;for(var r=t,i=r+n-4,a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++a)),E[t>>2]=o,(t+=4)+4>i)break}return E[t>>2]=0,t-r},Te=e=>{for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r>=55296&&r<=57343&&++n,t+=4}return t},Fe=[],Me={},Pe=()=>{if("object"==typeof globalThis)return globalThis;function e(e){e.$$$embind_global$$$=e;var t="object"==typeof $$$embind_global$$$&&e.$$$embind_global$$$==e;return t||delete e.$$$embind_global$$$,t}if("object"==typeof $$$embind_global$$$)return $$$embind_global$$$;if("object"==typeof i.g&&e(i.g)?$$$embind_global$$$=i.g:"object"==typeof self&&e(self)&&($$$embind_global$$$=self),"object"==typeof $$$embind_global$$$)return $$$embind_global$$$;throw Error("unable to get global object.")},Ne=(e,t)=>{var n=te[e];return void 0===n&&oe(`${t} has unknown type ${Ie(e)}`),n},We=Reflect.construct,Oe=e=>{var t=(e-g.buffer.byteLength+65535)/65536;try{return g.grow(t),B(),1}catch(e){}},De={},je=()=>{if(!je.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:u||"./this.program"};for(var t in De)void 0===De[t]?delete e[t]:e[t]=De[t];var n=[];for(var t in e)n.push(`${t}=${e[t]}`);je.strings=n}return je.strings},Ue=[null,[],[]],$e=(e,t)=>{var n=Ue[e];0===t||10===t?((1===e?_:b)(Ce(n,0)),n.length=0):n.push(t)};V=r.InternalError=class extends Error{constructor(e){super(e),this.name="InternalError"}},(()=>{for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);K=e})(),J=r.BindingError=class extends Error{constructor(e){super(e),this.name="BindingError"}},fe.push(0,1,void 0,1,null,1,!0,1,!1,1),r.count_emval_handles=()=>fe.length/2-5-he.length,le=r.UnboundTypeError=(ue=Error,(de=we("UnboundTypeError",function(e){this.name="UnboundTypeError",this.message=e;var t=new Error(e).stack;void 0!==t&&(this.stack=this.toString()+"\n"+t.replace(/^Error(:[^\n]*)?\n/,""))})).prototype=Object.create(ue.prototype),de.prototype.constructor=de,de.prototype.toString=function(){return void 0===this.message?this.name:`${this.name}: ${this.message}`},de);var He,qe={j:(e,t,n)=>{throw new G(e).init(t,n),e},k:e=>{var t=Q[e];delete Q[e];var n=t.rawConstructor,r=t.rawDestructor,i=t.fields,a=i.map(e=>e.getterReturnType).concat(i.map(e=>e.setterArgumentType));ie([e],a,e=>{var a={};return i.forEach((t,n)=>{var r=t.fieldName,o=e[n],s=t.getter,c=t.getterContext,l=e[n+i.length],u=t.setter,d=t.setterContext;a[r]={read:e=>o.fromWireType(s(c,e)),write:(e,t)=>{var n=[];u(d,e,l.toWireType(n,t)),X(n)}}}),[{name:t.name,fromWireType:e=>{var t={};for(var n in a)t[n]=a[n].read(e);return r(e),t},toWireType:(e,t)=>{for(var i in a)if(!(i in t))throw new TypeError(`Missing field: "${i}"`);var o=n();for(i in a)a[i].write(o,t[i]);return null!==e&&e.push(r,o),o},argPackAdvance:8,readValueFromPointer:Y,destructorFunction:r}]})},n:(e,t,n,r,i)=>{},h:(e,t,n,r)=>{se(e,{name:t=ae(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?n:r},argPackAdvance:8,readValueFromPointer:function(e){return this.fromWireType(y[e])},destructorFunction:null})},z:e=>se(e,_e),f:(e,t,n)=>{se(e,{name:t=ae(t),fromWireType:e=>e,toWireType:(e,t)=>t,argPackAdvance:8,readValueFromPointer:be(t,n),destructorFunction:null})},e:(e,t,n,i,a,o,s)=>{var c=((e,t)=>{for(var n=[],r=0;r<e;r++)n.push(I[t+4*r>>2]);return n})(t,n);e=(e=>{const t=(e=e.trim()).indexOf("(");return-1!==t?e.substr(0,t):e})(e=ae(e)),a=Ee(i,a),((e,t,n)=>{r.hasOwnProperty(e)?((void 0===n||void 0!==r[e].overloadTable&&void 0!==r[e].overloadTable[n])&&oe(`Cannot register public name '${e}' twice`),ye(r,e,e),r.hasOwnProperty(n)&&oe(`Cannot register multiple overloads of a function with the same number of arguments (${n})!`),r[e].overloadTable[n]=t):(r[e]=t,void 0!==n&&(r[e].numArguments=n))})(e,function(){((e,t)=>{var n=[],r={};throw t.forEach(function e(t){r[t]||te[t]||(ne[t]?ne[t].forEach(e):(n.push(t),r[t]=!0))}),new le(`${e}: `+n.map(Ie).join([", "]))})(`Cannot call ${e} due to unbound types`,c)},t-1),ie([],c,n=>{var i=[n[0],null].concat(n.slice(1));return((e,t,n)=>{r.hasOwnProperty(e)||re("Replacing nonexistent public symbol"),void 0!==r[e].overloadTable&&void 0!==n?r[e].overloadTable[n]=t:(r[e]=t,r[e].argCount=n)})(e,function(e,t,n,r,i){var a=t.length;a<2&&oe("argTypes array size mismatch! Must at least get return value and 'this' types!");var o=null!==t[1]&&!1,s=function(e){for(var t=1;t<e.length;++t)if(null!==e[t]&&void 0===e[t].destructorFunction)return!0;return!1}(t),c="void"!==t[0].name,l=a-2,u=new Array(l),d=[],h=[];return we(e,function(...n){var a;n.length!==l&&oe(`function ${e} called with ${n.length} arguments, expected ${l}`),h.length=0,d.length=o?2:1,d[0]=i,o&&(a=t[1].toWireType(h,this),d[1]=a);for(var f=0;f<l;++f)u[f]=t[f+2].toWireType(h,n[f]),d.push(u[f]);return function(e){if(s)X(h);else for(var n=o?1:2;n<t.length;n++){var r=1===n?a:u[n-2];null!==t[n].destructorFunction&&t[n].destructorFunction(r)}if(c)return t[0].fromWireType(e)}(r(...d))})}(e,i,0,a,o),t-1),[]})},c:(e,t,n,r,i)=>{t=ae(t),-1===i&&(i=4294967295);var a=e=>e;if(0===r){var o=32-8*n;a=e=>e<<o>>>o}var s=t.includes("unsigned");se(e,{name:t,fromWireType:a,toWireType:s?function(e,t){return this.name,t>>>0}:function(e,t){return this.name,t},argPackAdvance:8,readValueFromPointer:ke(t,n,0!==r),destructorFunction:null})},a:(e,t,n)=>{var r=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];function i(e){var t=I[e>>2],n=I[e+4>>2];return new r(w.buffer,n,t)}se(e,{name:n=ae(n),fromWireType:i,argPackAdvance:8,readValueFromPointer:i},{ignoreDuplicateRegistrations:!0})},g:(e,t)=>{var n="std::string"===(t=ae(t));se(e,{name:t,fromWireType(e){var t,r=I[e>>2],i=e+4;if(n)for(var a=i,o=0;o<=r;++o){var s=i+o;if(o==r||0==y[s]){var c=ze(a,s-a);void 0===t?t=c:(t+=String.fromCharCode(0),t+=c),a=s+1}}else{var l=new Array(r);for(o=0;o<r;++o)l[o]=String.fromCharCode(y[i+o]);t=l.join("")}return Xe(e),t},toWireType(e,t){var r;t instanceof ArrayBuffer&&(t=new Uint8Array(t));var i="string"==typeof t;i||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||oe("Cannot pass non-string to std::string"),r=n&&i?(e=>{for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r<=127?t++:r<=2047?t+=2:r>=55296&&r<=57343?(t+=4,++n):t+=3}return t})(t):t.length;var a=Qe(4+r+1),o=a+4;if(I[a>>2]=r,n&&i)((e,t,n,r)=>{if(!(r>0))return 0;for(var i=n+r-1,a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++a)),o<=127){if(n>=i)break;t[n++]=o}else if(o<=2047){if(n+1>=i)break;t[n++]=192|o>>6,t[n++]=128|63&o}else if(o<=65535){if(n+2>=i)break;t[n++]=224|o>>12,t[n++]=128|o>>6&63,t[n++]=128|63&o}else{if(n+3>=i)break;t[n++]=240|o>>18,t[n++]=128|o>>12&63,t[n++]=128|o>>6&63,t[n++]=128|63&o}}t[n]=0})(t,y,o,r+1);else if(i)for(var s=0;s<r;++s){var c=t.charCodeAt(s);c>255&&(Xe(o),oe("String has UTF-16 code units that do not fit in 8 bits")),y[o+s]=c}else for(s=0;s<r;++s)y[o+s]=t[s];return null!==e&&e.push(Xe,a),a},argPackAdvance:8,readValueFromPointer:Y,destructorFunction(e){Xe(e)}})},d:(e,t,n)=>{var r,i,a,o;n=ae(n),2===t?(r=Be,i=Se,o=Ae,a=e=>x[e>>1]):4===t&&(r=Le,i=Re,o=Te,a=e=>I[e>>2]),se(e,{name:n,fromWireType:e=>{for(var n,i=I[e>>2],o=e+4,s=0;s<=i;++s){var c=e+4+s*t;if(s==i||0==a(c)){var l=r(o,c-o);void 0===n?n=l:(n+=String.fromCharCode(0),n+=l),o=c+t}}return Xe(e),n},toWireType:(e,r)=>{"string"!=typeof r&&oe(`Cannot pass non-string to C++ string type ${n}`);var a=o(r),s=Qe(4+a+t);return I[s>>2]=a/t,i(r,s+4,a+t),null!==e&&e.push(Xe,s),s},argPackAdvance:8,readValueFromPointer:Y,destructorFunction(e){Xe(e)}})},l:(e,t,n,r,i,a)=>{Q[e]={name:ae(t),rawConstructor:Ee(n,r),rawDestructor:Ee(i,a),fields:[]}},b:(e,t,n,r,i,a,o,s,c,l)=>{Q[e].fields.push({fieldName:ae(t),getterReturnType:n,getter:Ee(r,i),getterContext:a,setterArgumentType:o,setter:Ee(s,c),setterContext:l})},i:(e,t)=>{se(e,{isVoid:!0,name:t=ae(t),argPackAdvance:0,fromWireType:()=>{},toWireType:(e,t)=>{}})},s:(e,t,n)=>y.copyWithin(e,t,t+n),y:(e,t,n,r)=>(e=Fe[e])(null,t=me(t),n,r),u:pe,A:e=>{return 0===e?ge(Pe()):(e=void 0===(n=Me[t=e])?ae(t):n,ge(Pe()[e]));var t,n},x:(e,t,n)=>{var r=((e,t)=>{for(var n=new Array(e),r=0;r<e;++r)n[r]=Ne(I[t+4*r>>2],"parameter "+r);return n})(e,t),i=r.shift();e--;var a,o,s=new Array(e),c=`methodCaller<(${r.map(e=>e.name).join(", ")}) => ${i.name}>`;return a=we(c,(t,a,o,c)=>{for(var l=0,u=0;u<e;++u)s[u]=r[u].readValueFromPointer(c+l),l+=r[u].argPackAdvance;var d=1===n?We(a,s):a.apply(t,s);return((e,t,n)=>{var r=[],i=e.toWireType(r,n);return r.length&&(I[t>>2]=ge(r)),i})(i,o,d)}),o=Fe.length,Fe.push(a),o},w:e=>{var t=me(e);X(t),pe(e)},o:()=>{N("")},p:e=>{var t=y.length,n=2147483648;if((e>>>=0)>n)return!1;for(var r=(e,t)=>e+(t-e%t)%t,i=1;i<=4;i*=2){var a=t*(1+.2/i);a=Math.min(a,e+100663296);var o=Math.min(n,r(Math.max(e,a),65536));if(Oe(o))return!0}return!1},q:(e,t)=>{var n=0;return je().forEach((r,i)=>{var a=t+n;I[e+4*i>>2]=a,((e,t)=>{for(var n=0;n<e.length;++n)w[t++]=e.charCodeAt(n);w[t]=0})(r,a),n+=r.length+1}),0},r:(e,t)=>{var n=je();I[e>>2]=n.length;var r=0;return n.forEach(e=>r+=e.length+1),I[t>>2]=r,0},B:(e,t)=>{var n;n=e,Z||(r.onExit?.(n),z=!0),d(n,new $(n))},t:e=>52,m:function(e,t,n,r,i){return 70},v:(e,t,n,r)=>{for(var i=0,a=0;a<n;a++){var o=I[t>>2],s=I[t+4>>2];t+=8;for(var c=0;c<s;c++)$e(e,y[o+c]);i+=s}return I[r>>2]=i,0}},Ze=function(){var e,t,i,a,o={a:qe};function s(e,t){var n;return Ze=e.exports,g=Ze.C,B(),ce=Ze.H,n=Ze.D,A.unshift(n),function(){if(F--,r.monitorRunDependencies?.(F),0==F&&(null!==M&&(clearInterval(M),M=null),P)){var e=P;P=null,e()}}(),Ze}if(F++,r.monitorRunDependencies?.(F),r.instantiateWasm)try{return r.instantiateWasm(o,s)}catch(e){b(`Module.instantiateWasm callback failed with error: ${e}`),n(e)}return(e=m,t=W,i=o,a=function(e){s(e.instance)},e||"function"!=typeof WebAssembly.instantiateStreaming||D(t)||"function"!=typeof fetch?U(t,i,a):fetch(t,{credentials:"same-origin"}).then(e=>WebAssembly.instantiateStreaming(e,i).then(a,function(e){return b(`wasm streaming compile failed: ${e}`),b("falling back to ArrayBuffer instantiation"),U(t,i,a)}))).catch(n),{}}(),Ge=e=>(Ge=Ze.E)(e),Qe=e=>(Qe=Ze.F)(e),Xe=e=>(Xe=Ze.G)(e),Ye=e=>(Ye=Ze.I)(e);function Ve(){function e(){He||(He=!0,r.calledRun=!0,z||(H(A),t(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),function(){if(r.postRun)for("function"==typeof r.postRun&&(r.postRun=[r.postRun]);r.postRun.length;)T(r.postRun.shift());H(L)}()))}F>0||(function(){if(r.preRun)for("function"==typeof r.preRun&&(r.preRun=[r.preRun]);r.preRun.length;)R(r.preRun.shift());H(S)}(),F>0||(r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),e()},1)):e()))}if(r.dynCall_jiji=(e,t,n,i,a)=>(r.dynCall_jiji=Ze.J)(e,t,n,i,a),P=function e(){He||Ve(),He||(P=e)},r.preInit)for("function"==typeof r.preInit&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return Ve(),a});const G=Z,Q={quality:75,baseline:!1,arithmetic:!1,progressive:!0,optimize_coding:!0,smoothing:0,color_space:3,quant_table:3,trellis_multipass:!1,trellis_opt_zero:!1,trellis_opt_table:!1,trellis_loops:1,auto_subsample:!0,chroma_subsample:2,separate_chroma_quality:!1,chroma_quality:75};let X;async function Y(e,t={}){X||async function(e,t){let n=e,r=t;1!==arguments.length||e instanceof WebAssembly.Module||(n=void 0,r=e),X=function(e,t,n={}){let r;return t&&(r=(e,n)=>{const r=new WebAssembly.Instance(t,e);return n(r),r.exports}),e({noInitialRun:!0,instantiateWasm:r,...n})}(G,n,r)}();const n=await X,r={...Q,...t};return n.encode(e.data,e.width,e.height,r).buffer}const V={quality:75,target_size:0,target_PSNR:0,method:4,sns_strength:50,filter_strength:60,filter_sharpness:0,filter_type:1,partitions:0,segments:4,pass:1,show_compressed:0,preprocessing:0,autofilter:0,partition_limit:0,alpha_compression:1,alpha_filtering:1,alpha_quality:100,lossless:0,exact:0,image_hint:0,emulate_jpeg_size:0,thread_level:0,low_memory:0,near_lossless:100,use_delta_palette:0,use_sharp_yuv:0};function K(e,t,n={}){let r;return t&&(r=(e,n)=>{const r=new WebAssembly.Instance(t,e);return n(r),r.exports}),e({noInitialRun:!0,instantiateWasm:r,...n})}let J,ee;async function te(e,t={}){J||(J=async function(e,t){let n=e,r=t;if(1!==arguments.length||e instanceof WebAssembly.Module||(n=void 0,r=e),await(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])))()){const e=await i.e(899).then(i.bind(i,899));return J=K(e.default,n,r),J}const a=await i.e(227).then(i.bind(i,227));return J=K(a.default,n,r),J}());const n={...V,...t},r=(await J).encode(e.data,e.width,e.height,n);if(!r)throw new Error("Encoding error.");return r.buffer}const ne="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&ne.decode();let re=null;function ie(){return null!==re&&0!==re.byteLength||(re=new Uint8Array(ee.memory.buffer)),re}let ae=0;let oe=null;function se(){return null!==oe&&0!==oe.byteLength||(oe=new Int32Array(ee.memory.buffer)),oe}function ce(e,t,n,r,i,a){try{const d=ee.__wbindgen_add_to_stack_pointer(-16),h=function(e,t){const n=t(1*e.length,1)>>>0;return ie().set(e,n/1),ae=e.length,n}(e,ee.__wbindgen_malloc),f=ae;ee.optimise_raw(d,h,f,t,n,r,i,a);var o=se()[d/4+0],s=se()[d/4+1],c=(l=o,u=s,l>>>=0,ie().subarray(l/1,l/1+u)).slice();return ee.__wbindgen_free(o,1*s,1),c}finally{ee.__wbindgen_add_to_stack_pointer(16)}var l,u}async function le(e){if(void 0!==ee)return ee;void 0===e&&(e=new URL(i(482),i.b));const t=function(){const e={wbg:{}};return e.wbg.__wbindgen_throw=function(e,t){throw new Error((n=e,r=t,n>>>=0,ne.decode(ie().subarray(n,n+r))));var n,r},e}();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return function(e,t){return ee=e.exports,le.__wbindgen_wasm_module=t,oe=null,re=null,ee}(n,r)}const ue=le,de=void 0!==globalThis.ServiceWorkerGlobalScope&&"undefined"!=typeof self&&globalThis.caches&&void 0!==globalThis.caches.default,he="object"==typeof process&&process.release&&"node"===process.release.name;let fe;function pe(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let n="[";t>0&&(n+=pe(e[0]));for(let r=1;r<t;r++)n+=", "+pe(e[r]);return n+="]",n}const n=/\[object ([^\]]+)\]/.exec(toString.call(e));let r;if(!(n.length>1))return toString.call(e);if(r=n[1],"Object"==r)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:r}(de||he)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(e,t,n){this.data=e,this.width=t,this.height=n}}),"undefined"!=typeof self&&void 0===self.location&&(self.location={href:""}));let me=0,ge=null;function _e(){return null!==ge&&0!==ge.byteLength||(ge=new Uint8Array(fe.memory.buffer)),ge}const be="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},we="function"==typeof be.encodeInto?function(e,t){return be.encodeInto(e,t)}:function(e,t){const n=be.encode(e);return t.set(n),{read:e.length,written:n.length}};function ye(e,t,n){if(void 0===n){const n=be.encode(e),r=t(n.length,1)>>>0;return _e().subarray(r,r+n.length).set(n),me=n.length,r}let r=e.length,i=t(r,1)>>>0;const a=_e();let o=0;for(;o<r;o++){const t=e.charCodeAt(o);if(t>127)break;a[i+o]=t}if(o!==r){0!==o&&(e=e.slice(o)),i=n(i,r,r=o+3*e.length,1)>>>0;const t=_e().subarray(i+o,i+r);o+=we(e,t).written,i=n(i,r,o,1)>>>0}return me=o,i}let ve=null;function xe(){return(null===ve||!0===ve.buffer.detached||void 0===ve.buffer.detached&&ve.buffer!==fe.memory.buffer)&&(ve=new DataView(fe.memory.buffer)),ve}const Ee="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};function Ie(e,t){return e>>>=0,Ee.decode(_e().subarray(e,e+t))}function ke(e,t){if(!(e instanceof t))throw new Error(`expected instance of ${t.name}`);return e.ptr}function Ce(e,t,n){ke(e,vr),fe.alter_channel(e.__wbg_ptr,t,n)}function ze(e,t){ke(e,vr),fe.alter_red_channel(e.__wbg_ptr,t)}function Be(e,t){ke(e,vr),fe.alter_green_channel(e.__wbg_ptr,t)}function Se(e,t){ke(e,vr),fe.alter_blue_channel(e.__wbg_ptr,t)}function Ae(e,t,n,r,i){ke(e,vr),fe.alter_two_channels(e.__wbg_ptr,t,n,r,i)}function Le(e,t,n,r){ke(e,vr),fe.alter_channels(e.__wbg_ptr,t,n,r)}function Re(e,t,n){ke(e,vr),fe.remove_channel(e.__wbg_ptr,t,n)}function Te(e,t){ke(e,vr),fe.remove_red_channel(e.__wbg_ptr,t)}function Fe(e,t){ke(e,vr),fe.remove_green_channel(e.__wbg_ptr,t)}function Me(e,t){ke(e,vr),fe.remove_blue_channel(e.__wbg_ptr,t)}function Pe(e,t,n){ke(e,vr),fe.swap_channels(e.__wbg_ptr,t,n)}function Ne(e){ke(e,vr),fe.invert(e.__wbg_ptr)}function We(e,t,n){ke(e,vr),ke(t,Er);var r=t.__destroy_into_raw();fe.selective_hue_rotate(e.__wbg_ptr,r,n)}function Oe(e,t,n,r){ke(e,vr),ke(t,Er);var i=t.__destroy_into_raw();ke(n,Er);var a=n.__destroy_into_raw();fe.selective_color_convert(e.__wbg_ptr,i,a,r)}function De(e,t,n){ke(e,vr),ke(t,Er);var r=t.__destroy_into_raw();fe.selective_lighten(e.__wbg_ptr,r,n)}function je(e,t,n){ke(e,vr),ke(t,Er);var r=t.__destroy_into_raw();fe.selective_desaturate(e.__wbg_ptr,r,n)}function Ue(e,t,n){ke(e,vr),ke(t,Er);var r=t.__destroy_into_raw();fe.selective_saturate(e.__wbg_ptr,r,n)}function $e(e,t){ke(e,vr);var n=e.__destroy_into_raw();ke(t,Er);var r=t.__destroy_into_raw();fe.selective_greyscale(n,r)}function He(e,t,n,r){ke(e,vr),fe.monochrome(e.__wbg_ptr,t,n,r)}function qe(e){ke(e,vr),fe.sepia(e.__wbg_ptr)}function Ze(e){ke(e,vr),fe.grayscale(e.__wbg_ptr)}function Ge(e){ke(e,vr),fe.grayscale_human_corrected(e.__wbg_ptr)}function Qe(e){ke(e,vr),fe.desaturate(e.__wbg_ptr)}function Xe(e){ke(e,vr),fe.decompose_min(e.__wbg_ptr)}function Ye(e){ke(e,vr),fe.decompose_max(e.__wbg_ptr)}function Ve(e,t){ke(e,vr),fe.grayscale_shades(e.__wbg_ptr,t)}function Ke(e){ke(e,vr),fe.r_grayscale(e.__wbg_ptr)}function Je(e){ke(e,vr),fe.g_grayscale(e.__wbg_ptr)}function et(e){ke(e,vr),fe.b_grayscale(e.__wbg_ptr)}function tt(e,t){ke(e,vr),fe.single_channel_grayscale(e.__wbg_ptr,t)}function nt(e,t){ke(e,vr),fe.threshold(e.__wbg_ptr,t)}function rt(e,t,n,r){ke(e,vr),fe.gamma_correction(e.__wbg_ptr,t,n,r)}function it(e,t,n){ke(e,vr);const r=ye(t,fe.__wbindgen_malloc,fe.__wbindgen_realloc),i=me;fe.hsluv(e.__wbg_ptr,r,i,n)}function at(e,t,n){ke(e,vr);const r=ye(t,fe.__wbindgen_malloc,fe.__wbindgen_realloc),i=me;fe.lch(e.__wbg_ptr,r,i,n)}function ot(e,t,n){ke(e,vr);const r=ye(t,fe.__wbindgen_malloc,fe.__wbindgen_realloc),i=me;fe.hsl(e.__wbg_ptr,r,i,n)}function st(e,t,n){ke(e,vr);const r=ye(t,fe.__wbindgen_malloc,fe.__wbindgen_realloc),i=me;fe.hsv(e.__wbg_ptr,r,i,n)}function ct(e,t){ke(e,vr),fe.hue_rotate_hsl(e.__wbg_ptr,t)}function lt(e,t){ke(e,vr),fe.hue_rotate_hsv(e.__wbg_ptr,t)}function ut(e,t){ke(e,vr),fe.hue_rotate_lch(e.__wbg_ptr,t)}function dt(e,t){ke(e,vr),fe.hue_rotate_hsluv(e.__wbg_ptr,t)}function ht(e,t){ke(e,vr),fe.saturate_hsl(e.__wbg_ptr,t)}function ft(e,t){ke(e,vr),fe.saturate_lch(e.__wbg_ptr,t)}function pt(e,t){ke(e,vr),fe.saturate_hsluv(e.__wbg_ptr,t)}function mt(e,t){ke(e,vr),fe.saturate_hsv(e.__wbg_ptr,t)}function gt(e,t){ke(e,vr),fe.lighten_lch(e.__wbg_ptr,t)}function _t(e,t){ke(e,vr),fe.lighten_hsluv(e.__wbg_ptr,t)}function bt(e,t){ke(e,vr),fe.lighten_hsl(e.__wbg_ptr,t)}function wt(e,t){ke(e,vr),fe.lighten_hsv(e.__wbg_ptr,t)}function yt(e,t){ke(e,vr),fe.darken_lch(e.__wbg_ptr,t)}function vt(e,t){ke(e,vr),fe.darken_hsluv(e.__wbg_ptr,t)}function xt(e,t){ke(e,vr),fe.darken_hsl(e.__wbg_ptr,t)}function Et(e,t){ke(e,vr),fe.darken_hsv(e.__wbg_ptr,t)}function It(e,t){ke(e,vr),fe.desaturate_hsv(e.__wbg_ptr,t)}function kt(e,t){ke(e,vr),fe.desaturate_hsl(e.__wbg_ptr,t)}function Ct(e,t){ke(e,vr),fe.desaturate_lch(e.__wbg_ptr,t)}function zt(e,t){ke(e,vr),fe.desaturate_hsluv(e.__wbg_ptr,t)}function Bt(e,t,n){ke(e,vr),ke(t,Er);var r=t.__destroy_into_raw();fe.mix_with_colour(e.__wbg_ptr,r,n)}function St(e){ke(e,vr),fe.noise_reduction(e.__wbg_ptr)}function At(e){ke(e,vr),fe.sharpen(e.__wbg_ptr)}function Lt(e){ke(e,vr),fe.edge_detection(e.__wbg_ptr)}function Rt(e){ke(e,vr),fe.identity(e.__wbg_ptr)}function Tt(e){ke(e,vr),fe.box_blur(e.__wbg_ptr)}function Ft(e,t){ke(e,vr),fe.gaussian_blur(e.__wbg_ptr,t)}function Mt(e){ke(e,vr),fe.detect_horizontal_lines(e.__wbg_ptr)}function Pt(e){ke(e,vr),fe.detect_vertical_lines(e.__wbg_ptr)}function Nt(e){ke(e,vr),fe.detect_45_deg_lines(e.__wbg_ptr)}function Wt(e){ke(e,vr),fe.detect_135_deg_lines(e.__wbg_ptr)}function Ot(e){ke(e,vr),fe.laplace(e.__wbg_ptr)}function Dt(e){ke(e,vr),fe.edge_one(e.__wbg_ptr)}function jt(e){ke(e,vr),fe.emboss(e.__wbg_ptr)}function Ut(e){ke(e,vr),fe.sobel_horizontal(e.__wbg_ptr)}function $t(e){ke(e,vr),fe.prewitt_horizontal(e.__wbg_ptr)}function Ht(e){ke(e,vr),fe.sobel_vertical(e.__wbg_ptr)}function qt(e){ke(e,vr),fe.sobel_global(e.__wbg_ptr)}function Zt(e){ke(e,vr),fe.add_noise_rand(e.__wbg_ptr)}function Gt(e){ke(e,vr),fe.pink_noise(e.__wbg_ptr)}function Qt(e,t,n,r){ke(e,vr),ke(t,vr),fe.watermark(e.__wbg_ptr,t.__wbg_ptr,n,r)}function Xt(e,t,n){ke(e,vr),ke(t,vr);const r=ye(n,fe.__wbindgen_malloc,fe.__wbindgen_realloc),i=me;fe.blend(e.__wbg_ptr,t.__wbg_ptr,r,i)}function Yt(e,t){const n=fe.create_gradient(e,t);return vr.__wrap(n)}function Vt(e){ke(e,vr),fe.apply_gradient(e.__wbg_ptr)}function Kt(e){ke(e,vr),fe.neue(e.__wbg_ptr)}function Jt(e){ke(e,vr),fe.lix(e.__wbg_ptr)}function en(e){ke(e,vr),fe.ryo(e.__wbg_ptr)}function tn(e,t){ke(e,vr);const n=ye(t,fe.__wbindgen_malloc,fe.__wbindgen_realloc),r=me;fe.filter(e.__wbg_ptr,n,r)}function nn(e){ke(e,vr),fe.lofi(e.__wbg_ptr)}function rn(e){ke(e,vr),fe.pastel_pink(e.__wbg_ptr)}function an(e){ke(e,vr),fe.golden(e.__wbg_ptr)}function on(e){ke(e,vr),fe.cali(e.__wbg_ptr)}function sn(e){ke(e,vr),fe.dramatic(e.__wbg_ptr)}function cn(e,t){ke(e,vr),ke(t,Er);var n=t.__destroy_into_raw();fe.monochrome_tint(e.__wbg_ptr,n)}function ln(e){ke(e,vr),fe.duotone_violette(e.__wbg_ptr)}function un(e){ke(e,vr),fe.duotone_horizon(e.__wbg_ptr)}function dn(e,t){ke(e,vr),ke(t,Er);var n=t.__destroy_into_raw();fe.duotone_tint(e.__wbg_ptr,n)}function hn(e){ke(e,vr),fe.duotone_lilac(e.__wbg_ptr)}function fn(e){ke(e,vr),fe.duotone_ochre(e.__wbg_ptr)}function pn(e){ke(e,vr),fe.firenze(e.__wbg_ptr)}function mn(e){ke(e,vr),fe.obsidian(e.__wbg_ptr)}function gn(e,t,n,r,i){ke(e,vr);const a=fe.crop(e.__wbg_ptr,t,n,r,i);return vr.__wrap(a)}function _n(e,t,n,r,i){return fe.crop_img_browser(e,t,n,r,i)}function bn(e){ke(e,vr),fe.fliph(e.__wbg_ptr)}function wn(e){ke(e,vr),fe.flipv(e.__wbg_ptr)}function yn(e,t,n,r){return ke(e,vr),fe.resize_img_browser(e.__wbg_ptr,t,n,r)}function vn(e,t,n,r){ke(e,vr);const i=fe.resize(e.__wbg_ptr,t,n,r);return vr.__wrap(i)}function xn(e,t,n){ke(e,vr);const r=fe.seam_carve(e.__wbg_ptr,t,n);return vr.__wrap(r)}function En(e,t){ke(e,vr);const n=fe.shearx(e.__wbg_ptr,t);return vr.__wrap(n)}function In(e,t){ke(e,vr);const n=fe.sheary(e.__wbg_ptr,t);return vr.__wrap(n)}function kn(e,t,n){ke(e,vr),ke(n,kr);var r=n.__destroy_into_raw();const i=fe.padding_uniform(e.__wbg_ptr,t,r);return vr.__wrap(i)}function Cn(e,t,n){ke(e,vr),ke(n,kr);var r=n.__destroy_into_raw();const i=fe.padding_left(e.__wbg_ptr,t,r);return vr.__wrap(i)}function zn(e,t,n){ke(e,vr),ke(n,kr);var r=n.__destroy_into_raw();const i=fe.padding_right(e.__wbg_ptr,t,r);return vr.__wrap(i)}function Bn(e,t,n){ke(e,vr),ke(n,kr);var r=n.__destroy_into_raw();const i=fe.padding_top(e.__wbg_ptr,t,r);return vr.__wrap(i)}function Sn(e,t,n){ke(e,vr),ke(n,kr);var r=n.__destroy_into_raw();const i=fe.padding_bottom(e.__wbg_ptr,t,r);return vr.__wrap(i)}function An(e,t){ke(e,vr);const n=fe.rotate(e.__wbg_ptr,t);return vr.__wrap(n)}function Ln(e,t,n){ke(e,vr);const r=fe.resample(e.__wbg_ptr,t,n);return vr.__wrap(r)}function Rn(e,t,n){ke(e,vr),fe.offset(e.__wbg_ptr,t,n)}function Tn(e,t){ke(e,vr),fe.offset_red(e.__wbg_ptr,t)}function Fn(e,t){ke(e,vr),fe.offset_green(e.__wbg_ptr,t)}function Mn(e,t){ke(e,vr),fe.offset_blue(e.__wbg_ptr,t)}function Pn(e,t,n,r){ke(e,vr),fe.multiple_offsets(e.__wbg_ptr,t,n,r)}function Nn(e){ke(e,vr),fe.halftone(e.__wbg_ptr)}function Wn(e){ke(e,vr),fe.primary(e.__wbg_ptr)}function On(e){ke(e,vr),fe.colorize(e.__wbg_ptr)}function Dn(e){ke(e,vr),fe.solarize(e.__wbg_ptr)}function jn(e){ke(e,vr);const t=fe.solarize_retimg(e.__wbg_ptr);return vr.__wrap(t)}function Un(e,t){ke(e,vr),fe.adjust_brightness(e.__wbg_ptr,t)}function $n(e,t){ke(e,vr),fe.inc_brightness(e.__wbg_ptr,t)}function Hn(e,t){ke(e,vr),fe.dec_brightness(e.__wbg_ptr,t)}function qn(e,t){ke(e,vr),fe.adjust_contrast(e.__wbg_ptr,t)}function Zn(e,t,n,r){ke(e,vr),fe.tint(e.__wbg_ptr,t,n,r)}function Gn(e,t){ke(e,vr),fe.horizontal_strips(e.__wbg_ptr,t)}function Qn(e,t,n){ke(e,vr),ke(n,Er);var r=n.__destroy_into_raw();fe.color_horizontal_strips(e.__wbg_ptr,t,r)}function Xn(e,t){ke(e,vr),fe.vertical_strips(e.__wbg_ptr,t)}function Yn(e,t,n){ke(e,vr),ke(n,Er);var r=n.__destroy_into_raw();fe.color_vertical_strips(e.__wbg_ptr,t,r)}function Vn(e,t,n){ke(e,vr),fe.oil(e.__wbg_ptr,t,n)}function Kn(e){ke(e,vr),fe.frosted_glass(e.__wbg_ptr)}function Jn(e,t){ke(e,vr),fe.pixelize(e.__wbg_ptr,t)}function er(e){ke(e,vr),fe.normalize(e.__wbg_ptr)}function tr(e,t){ke(e,vr),fe.dither(e.__wbg_ptr,t)}function nr(e,t,n){ke(e,vr),ke(t,Er);var r=t.__destroy_into_raw();ke(n,Er);var i=n.__destroy_into_raw();fe.duotone(e.__wbg_ptr,r,i)}function rr(e,t,n,r,i){ke(e,vr);const a=ye(t,fe.__wbindgen_malloc,fe.__wbindgen_realloc),o=me;fe.draw_text_with_border(e.__wbg_ptr,a,o,n,r,i)}function ir(e,t,n,r,i){ke(e,vr);const a=ye(t,fe.__wbindgen_malloc,fe.__wbindgen_realloc),o=me;fe.draw_text(e.__wbg_ptr,a,o,n,r,i)}function ar(e,t){const n=t(1*e.length,1)>>>0;return _e().set(e,n/1),me=e.length,n}function or(e,t){return e>>>=0,_e().subarray(e/1,e/1+t)}function sr(){const e=fe.run();if(e[1])throw function(e){const t=fe.__wbindgen_export_2.get(e);return fe.__externref_table_dealloc(e),t}(e[0])}function cr(e,t){return fe.get_image_data(e,t)}function lr(e,t,n){ke(n,vr);var r=n.__destroy_into_raw();fe.putImageData(e,t,r)}function ur(e,t){const n=fe.open_image(e,t);return vr.__wrap(n)}function dr(e){const t=fe.to_raw_pixels(e);var n=or(t[0],t[1]).slice();return fe.__wbindgen_free(t[0],1*t[1],1),n}function hr(e){const t=ye(e,fe.__wbindgen_malloc,fe.__wbindgen_realloc),n=me,r=fe.base64_to_image(t,n);return vr.__wrap(r)}function fr(e){const t=ye(e,fe.__wbindgen_malloc,fe.__wbindgen_realloc),n=me,r=fe.base64_to_vec(t,n);var i=or(r[0],r[1]).slice();return fe.__wbindgen_free(r[0],1*r[1],1),i}function pr(e){ke(e,vr);var t=e.__destroy_into_raw();return fe.to_image_data(t)}function mr(e){return null==e}function gr(e){const t=fe.__externref_table_alloc();return fe.__wbindgen_export_2.set(t,e),t}function _r(e,t){try{return e.apply(this,t)}catch(e){const t=gr(e);fe.__wbindgen_exn_store(t)}}"undefined"!=typeof TextDecoder&&Ee.decode();let br=null;const wr=Object.freeze({Nearest:1,1:"Nearest",Triangle:2,2:"Triangle",CatmullRom:3,3:"CatmullRom",Gaussian:4,4:"Gaussian",Lanczos3:5,5:"Lanczos3"}),yr="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>fe.__wbg_photonimage_free(e>>>0,1));class vr{static __wrap(e){e>>>=0;const t=Object.create(vr.prototype);return t.__wbg_ptr=e,yr.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,yr.unregister(this),e}free(){const e=this.__destroy_into_raw();fe.__wbg_photonimage_free(e,0)}constructor(e,t,n){const r=ar(e,fe.__wbindgen_malloc),i=me,a=fe.photonimage_new(r,i,t,n);return this.__wbg_ptr=a>>>0,yr.register(this,this.__wbg_ptr,this),this}static new_from_base64(e){const t=ye(e,fe.__wbindgen_malloc,fe.__wbindgen_realloc),n=me,r=fe.base64_to_image(t,n);return vr.__wrap(r)}static new_from_byteslice(e){const t=ar(e,fe.__wbindgen_malloc),n=me,r=fe.photonimage_new_from_byteslice(t,n);return vr.__wrap(r)}static new_from_blob(e){const t=fe.photonimage_new_from_blob(e);return vr.__wrap(t)}static new_from_image(e){const t=fe.photonimage_new_from_image(e);return vr.__wrap(t)}get_width(){return fe.photonimage_get_width(this.__wbg_ptr)>>>0}get_raw_pixels(){const e=fe.photonimage_get_raw_pixels(this.__wbg_ptr);var t=or(e[0],e[1]).slice();return fe.__wbindgen_free(e[0],1*e[1],1),t}get_height(){return fe.photonimage_get_height(this.__wbg_ptr)>>>0}get_base64(){let e,t;try{const n=fe.photonimage_get_base64(this.__wbg_ptr);return e=n[0],t=n[1],Ie(n[0],n[1])}finally{fe.__wbindgen_free(e,t,1)}}get_bytes(){const e=fe.photonimage_get_bytes(this.__wbg_ptr);var t=or(e[0],e[1]).slice();return fe.__wbindgen_free(e[0],1*e[1],1),t}get_bytes_jpeg(e){const t=fe.photonimage_get_bytes_jpeg(this.__wbg_ptr,e);var n=or(t[0],t[1]).slice();return fe.__wbindgen_free(t[0],1*t[1],1),n}get_bytes_webp(){const e=fe.photonimage_get_bytes_webp(this.__wbg_ptr);var t=or(e[0],e[1]).slice();return fe.__wbindgen_free(e[0],1*e[1],1),t}get_image_data(){return fe.photonimage_get_image_data(this.__wbg_ptr)}set_imgdata(e){fe.photonimage_set_imgdata(this.__wbg_ptr,e)}get_estimated_filesize(){const e=fe.photonimage_get_estimated_filesize(this.__wbg_ptr);return BigInt.asUintN(64,e)}}const xr="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>fe.__wbg_rgb_free(e>>>0,1));class Er{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,xr.unregister(this),e}free(){const e=this.__destroy_into_raw();fe.__wbg_rgb_free(e,0)}constructor(e,t,n){const r=fe.rgb_new(e,t,n);return this.__wbg_ptr=r>>>0,xr.register(this,this.__wbg_ptr,this),this}set_red(e){fe.rgb_set_red(this.__wbg_ptr,e)}set_green(e){fe.rgb_set_green(this.__wbg_ptr,e)}set_blue(e){fe.rgb_set_blue(this.__wbg_ptr,e)}get_red(){return fe.rgb_get_red(this.__wbg_ptr)}get_green(){return fe.rgb_get_green(this.__wbg_ptr)}get_blue(){return fe.rgb_get_blue(this.__wbg_ptr)}}const Ir="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>fe.__wbg_rgba_free(e>>>0,1));class kr{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Ir.unregister(this),e}free(){const e=this.__destroy_into_raw();fe.__wbg_rgba_free(e,0)}constructor(e,t,n,r){const i=fe.rgba_new(e,t,n,r);return this.__wbg_ptr=i>>>0,Ir.register(this,this.__wbg_ptr,this),this}set_red(e){fe.rgb_set_red(this.__wbg_ptr,e)}set_green(e){fe.rgb_set_green(this.__wbg_ptr,e)}set_blue(e){fe.rgb_set_blue(this.__wbg_ptr,e)}set_alpha(e){fe.rgba_set_alpha(this.__wbg_ptr,e)}get_red(){return fe.rgb_get_red(this.__wbg_ptr)}get_green(){return fe.rgb_get_green(this.__wbg_ptr)}get_blue(){return fe.rgb_get_blue(this.__wbg_ptr)}get_alpha(){return fe.rgba_get_alpha(this.__wbg_ptr)}}function Cr(){const e={wbg:{}};return e.wbg.__wbg_new_abda76e883ba8a5f=function(){return new Error},e.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const n=ye(t.stack,fe.__wbindgen_malloc,fe.__wbindgen_realloc),r=me;xe().setInt32(e+4,r,!0),xe().setInt32(e+0,n,!0)},e.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let n,r;try{n=e,r=t,console.error(Ie(e,t))}finally{fe.__wbindgen_free(n,r,1)}},e.wbg.__wbg_instanceof_Window_c4b70662a0d2c5ec=function(e){let t;try{t=e instanceof Window}catch(e){t=!1}return t},e.wbg.__wbg_document_e5c1786dea6542e4=function(e){const t=e.document;return mr(t)?0:gr(t)},e.wbg.__wbg_body_e70ae6abd01ae584=function(e){const t=e.body;return mr(t)?0:gr(t)},e.wbg.__wbg_createElement_5d4c76f218b78145=function(){return _r(function(e,t,n){return e.createElement(Ie(t,n))},arguments)},e.wbg.__wbg_width_4c6f0048d64cf86b=function(e){return e.width},e.wbg.__wbg_height_21f0d3fd8f753394=function(e){return e.height},e.wbg.__wbg_width_79e0847ed5883b03=function(e){return e.width},e.wbg.__wbg_height_e4e4e4779f8feac0=function(e){return e.height},e.wbg.__wbg_data_fda507064d127f5b=function(e,t){const n=ar(t.data,fe.__wbindgen_malloc),r=me;xe().setInt32(e+4,r,!0),xe().setInt32(e+0,n,!0)},e.wbg.__wbg_newwithu8clampedarrayandsh_1fddccb3a94a5e05=function(){return _r(function(e,t,n,r){return new ImageData((i=e,a=t,i>>>=0,(null!==br&&0!==br.byteLength||(br=new Uint8ClampedArray(fe.memory.buffer)),br).subarray(i/1,i/1+a)),n>>>0,r>>>0);var i,a},arguments)},e.wbg.__wbg_instanceof_CanvasRenderingContext2d_3abbe7ec7af32cae=function(e){let t;try{t=e instanceof CanvasRenderingContext2D}catch(e){t=!1}return t},e.wbg.__wbg_drawImage_fede06db74e39a60=function(){return _r(function(e,t,n,r){e.drawImage(t,n,r)},arguments)},e.wbg.__wbg_drawImage_f395c8e43c79a909=function(){return _r(function(e,t,n,r,i,a,o,s,c,l){e.drawImage(t,n,r,i,a,o,s,c,l)},arguments)},e.wbg.__wbg_getImageData_5e1c242046e6b59e=function(){return _r(function(e,t,n,r,i){return e.getImageData(t,n,r,i)},arguments)},e.wbg.__wbg_putImageData_a8b3e177ee06d521=function(){return _r(function(e,t,n,r){e.putImageData(t,n,r)},arguments)},e.wbg.__wbg_instanceof_HtmlCanvasElement_25d964a0dde6717e=function(e){let t;try{t=e instanceof HTMLCanvasElement}catch(e){t=!1}return t},e.wbg.__wbg_width_dc225e55343b745e=function(e){return e.width},e.wbg.__wbg_setwidth_488780db69b08846=function(e,t){e.width=t>>>0},e.wbg.__wbg_height_3a8bec2f3fe71b26=function(e){return e.height},e.wbg.__wbg_setheight_1761808c18403921=function(e,t){e.height=t>>>0},e.wbg.__wbg_getContext_fc99dbd3a9a7e318=function(){return _r(function(e,t,n){const r=e.getContext(Ie(t,n));return mr(r)?0:gr(r)},arguments)},e.wbg.__wbg_settextContent_f82a86a8df347e1c=function(e,t,n){e.textContent=0===t?void 0:Ie(t,n)},e.wbg.__wbg_appendChild_fa3b00dade9fc4cf=function(){return _r(function(e,t){return e.appendChild(t)},arguments)},e.wbg.__wbg_newnoargs_e643855c6572a4a8=function(e,t){return new Function(Ie(e,t))},e.wbg.__wbg_call_f96b398515635514=function(){return _r(function(e,t){return e.call(t)},arguments)},e.wbg.__wbg_self_b9aad7f1c618bfaf=function(){return _r(function(){return self.self},arguments)},e.wbg.__wbg_window_55e469842c98b086=function(){return _r(function(){return window.window},arguments)},e.wbg.__wbg_globalThis_d0957e302752547e=function(){return _r(function(){return globalThis.globalThis},arguments)},e.wbg.__wbg_global_ae2f87312b8987fb=function(){return _r(function(){return i.g.global},arguments)},e.wbg.__wbindgen_is_undefined=function(e){return void 0===e},e.wbg.__wbg_buffer_fcbfb6d88b2732e9=function(e){return e.buffer},e.wbg.__wbg_new_bc5d9aad3f9ac80e=function(e){return new Uint8Array(e)},e.wbg.__wbg_set_4b3aa8445ac1e91c=function(e,t,n){e.set(t,n>>>0)},e.wbg.__wbg_length_d9c4ded7e708c6a1=function(e){return e.length},e.wbg.__wbindgen_debug_string=function(e,t){const n=ye(pe(t),fe.__wbindgen_malloc,fe.__wbindgen_realloc),r=me;xe().setInt32(e+4,r,!0),xe().setInt32(e+0,n,!0)},e.wbg.__wbindgen_throw=function(e,t){throw new Error(Ie(e,t))},e.wbg.__wbindgen_memory=function(){return fe.memory},e.wbg.__wbindgen_init_externref_table=function(){const e=fe.__wbindgen_export_2,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},e}function zr(e,t){return fe=e.exports,Sr.__wbindgen_wasm_module=t,ve=null,ge=null,br=null,fe.__wbindgen_start(),fe}function Br(e){if(void 0!==fe)return fe;void 0!==e&&(Object.getPrototypeOf(e)===Object.prototype?({module:e}=e):console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));const t=Cr();return e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e)),zr(new WebAssembly.Instance(e,t),e)}async function Sr(e){if(void 0!==fe)return fe;void 0!==e&&(Object.getPrototypeOf(e)===Object.prototype?({module_or_path:e}=e):console.warn("using deprecated parameters for the initialization function; pass a single object instead")),void 0===e&&(e=new URL(i(901),i.b));const t=Cr();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return zr(n,r)}const Ar=Sr;var Lr=i(901);const Rr={Instagram:[{name:"Instagram Square Post (1:1)",exportWidth:1080,exportHeight:1080,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"Instagram Portrait Post (4:5)",exportWidth:1080,exportHeight:1350,resizeMode:"static_size",aspectRatio:{width:4,height:5}},{name:"Instagram Landscape Post (1.91:1)",exportWidth:1080,exportHeight:566,resizeMode:"static_size",aspectRatio:{width:191,height:100}},{name:"Instagram Story (9:16)",exportWidth:1080,exportHeight:1920,resizeMode:"static_size",aspectRatio:{width:9,height:16}},{name:"Instagram Profile Picture (1:1)",exportWidth:320,exportHeight:320,resizeMode:"static_size",aspectRatio:{width:1,height:1}}],Facebook:[{name:"Facebook Feed Landscape (1.91:1)",exportWidth:1200,exportHeight:630,resizeMode:"static_size",aspectRatio:{width:191,height:100}},{name:"Facebook Feed Square (1:1)",exportWidth:1080,exportHeight:1080,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"Facebook Feed Portrait (4:5)",exportWidth:1080,exportHeight:1350,resizeMode:"static_size",aspectRatio:{width:4,height:5}},{name:"Facebook Story (9:16)",exportWidth:1080,exportHeight:1920,resizeMode:"static_size",aspectRatio:{width:9,height:16}},{name:"Facebook Cover Photo (820x312)",exportWidth:820,exportHeight:312,resizeMode:"static_size",aspectRatio:{width:205,height:78}}],X:[{name:"X Feed Landscape (16:9)",exportWidth:1600,exportHeight:900,resizeMode:"static_size",aspectRatio:{width:16,height:9}},{name:"X Feed Square (1:1)",exportWidth:1080,exportHeight:1080,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"X Feed Portrait (4:5)",exportWidth:1080,exportHeight:1350,resizeMode:"static_size",aspectRatio:{width:4,height:5}},{name:"X Header Image (3:1)",exportWidth:1500,exportHeight:500,resizeMode:"static_size",aspectRatio:{width:3,height:1}},{name:"X Profile Picture (1:1)",exportWidth:400,exportHeight:400,resizeMode:"static_size",aspectRatio:{width:1,height:1}}],LinkedIn:[{name:"LinkedIn Feed Landscape (1.91:1)",exportWidth:1200,exportHeight:627,resizeMode:"static_size",aspectRatio:{width:191,height:100}},{name:"LinkedIn Feed Square (1:1)",exportWidth:1080,exportHeight:1080,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"LinkedIn Feed Portrait (4:5)",exportWidth:1080,exportHeight:1350,resizeMode:"static_size",aspectRatio:{width:4,height:5}},{name:"LinkedIn Profile Picture (1:1)",exportWidth:400,exportHeight:400,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"LinkedIn Cover Photo (4:1)",exportWidth:1584,exportHeight:396,resizeMode:"static_size",aspectRatio:{width:4,height:1}}],TikTok:[{name:"TikTok Vertical Video Cover (9:16)",exportWidth:1080,exportHeight:1920,resizeMode:"static_size",aspectRatio:{width:9,height:16}},{name:"TikTok Profile Picture (1:1)",exportWidth:200,exportHeight:200,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"TikTok Feed Preview (1:1)",exportWidth:1080,exportHeight:1080,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"TikTok Ad Vertical (9:16)",exportWidth:1080,exportHeight:1920,resizeMode:"static_size",aspectRatio:{width:9,height:16}},{name:"TikTok Carousel Image (4:5)",exportWidth:1080,exportHeight:1350,resizeMode:"static_size",aspectRatio:{width:4,height:5}}],Pinterest:[{name:"Pinterest Standard Pin (2:3)",exportWidth:1e3,exportHeight:1500,resizeMode:"static_size",aspectRatio:{width:2,height:3}},{name:"Pinterest Long Pin (1:2.1)",exportWidth:1e3,exportHeight:2100,resizeMode:"static_size",aspectRatio:{width:10,height:21}},{name:"Pinterest Square Pin (1:1)",exportWidth:1e3,exportHeight:1e3,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"Pinterest Profile Picture (1:1)",exportWidth:165,exportHeight:165,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"Pinterest Board Cover (1:1)",exportWidth:222,exportHeight:222,resizeMode:"static_size",aspectRatio:{width:1,height:1}}],YouTube:[{name:"YouTube Thumbnail (16:9)",exportWidth:1280,exportHeight:720,resizeMode:"static_size",aspectRatio:{width:16,height:9}},{name:"YouTube Channel Banner (16:9)",exportWidth:2560,exportHeight:1440,resizeMode:"static_size",aspectRatio:{width:16,height:9}},{name:"YouTube Profile Picture (1:1)",exportWidth:800,exportHeight:800,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"YouTube Community Post Square (1:1)",exportWidth:1080,exportHeight:1080,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"YouTube Community Post Landscape (16:9)",exportWidth:1200,exportHeight:675,resizeMode:"static_size",aspectRatio:{width:16,height:9}}]},Tr=[{w:1,h:1},{w:5,h:4},{w:4,h:3},{w:3,h:2},{w:7,h:5},{w:16,h:10},{w:16,h:9},{w:2,h:1},{w:21,h:9},{w:3,h:1},{w:4,h:5},{w:3,h:4},{w:2,h:3},{w:9,h:16},{w:191,h:100}],Fr={exportWidth:1920,exportHeight:1080,scalePercent:100,resizeMode:"fixed_aspect",aspectRatio:{width:16,height:9},exportFormat:"jpeg",jpegQuality:85,webpQuality:85,pngTransparency:!0,enableSharpening:!1,adaptiveSharpening:!1,sharpenAmount:120,sharpenRadius:1,sharpenThreshold:0},Mr=[[1,1],[4,3],[3,2],[16,9],[16,10],[5,4],[21,9],[2,1],[3,1],[1,2],[9,16],[3,4],[2,3]];function Pr(e,t){for(e=Math.abs(e),t=Math.abs(t);t;){const n=t;t=e%t,e=n}return e}function Nr(e,t,{canonical:n=Mr,includePortrait:r=!0}={}){if(!Number.isFinite(e)||!Number.isFinite(t)||e<=0||t<=0)throw new Error("w and h must be positive numbers");const i=Pr(e=Math.round(e),t=Math.round(t)),a=e/i,o=t/i,s=n.some(([e,t])=>e===a&&t===o||!(!r||e!==o||t!==a));return{arW:a,arH:o,isCanonical:s,approximate:!1,label:`${a}:${o}`}}function Wr(e,t){return e&&t?Nr(e,t).label:""}let Or=[],Dr=240,jr=null,Ur=16/9,$r=!1,Hr=0,qr=0;const Zr="batchImageProcessorPrefs",Gr="lanczos3",Qr="fixed_aspect",Xr="fixed_aspect_crop",Yr="static_size",Vr="fixed_width",Kr="fixed_height",Jr="scale_to_fit",ei="free_crop",ti="no_crop",ni="scaled",ri=Qr,ii=!1,ai=!1;let oi=null,si=null,ci=!1,li=0,ui=!1,di=0,hi=0,fi=0,pi=0,mi={imageId:null,cropChangeId:0,settingsChangeId:0,blobUrl:null,sizeBytes:null,width:null,height:null},gi=null,_i=!1,bi="",wi=!1,yi=!1,vi=null,xi="none",Ei=null,Ii=null,ki=null,Ci=null,zi="horizontal",Bi=ri,Si=!1,Ai=!1,Li=!1,Ri=!0,Ti=!1,Fi=!1,Mi=!1,Pi=null,Ni=!1;const Wi={resize:!1,encode:!1};let Oi=!1,Di=!0;function ji(){const e=(new URLSearchParams(window.location.search).get("forceFallback")||"").toLowerCase().trim();let t="";try{t=(localStorage.getItem("forceFallback")||"").toLowerCase().trim()}catch(e){t=""}const n=e||t;return n?"resize"===n||"encode"===n?n:"both"===n||"all"===n||"true"===n||"1"===n?"both":null:null}function Ui(e=!1){const t=document.getElementById("previewDelay");if(!t)return 500;const n=t.value;if("off"===n)return e?500:null;const r=parseFloat(n);return Number.isFinite(r)?Math.round(1e3*r):e?500:null}function $i(){return Ui(!1)}function Hi(){const e=document.getElementById("previewDelay");if(!e)return 180;const t=e.value;if("off"===t)return 180;const n=parseFloat(t);return Number.isFinite(n)?Math.round(1e3*n):180}function qi(){const e=document.getElementById("testExportBtn");e&&(ci?e.style.display="none":(e.style.display="inline-flex",e.textContent=ui?"Hide Export":"Show Export"))}async function Zi(){return gi||(gi=Ar({module_or_path:Lr})),await gi,e}function Gi(e){"resize"===e?Wi.resize=!0:"encode"===e&&(Wi.encode=!0),Ni||(Ni=!0,document.body.classList.add("has-fallback-warning"));const t=document.getElementById("fallbackWarningDetail");if(!t)return;const n=[];Wi.resize&&n.push("resize"),Wi.encode&&n.push("encode");const r=2===n.length?"resize/encode":n[0]||"processing";t.textContent=`High-quality ${r} failed, using canvas fallback (reduced quality).`}function Qi(){return document.getElementById("resizeMode")?.value||ri}function Xi(e){return Number.isFinite(e)?Math.max(1,Math.min(400,Math.round(e))):100}function Yi(){const e=document.getElementById("scalePercent");return e?Xi(parseInt(e.value,10)):100}function Vi(e=!0){const t=document.getElementById("scalePercent");if(!t)return;const n=Yi();t.value=n,function(){const e=Yi();document.querySelectorAll(".scale-preset-btn").forEach(t=>{const n=parseInt(t.dataset.scale,10);t.classList.toggle("active",Number.isFinite(n)&&n===e)})}(),e&&(Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0)))}function Ki(e=Qi()){return e===Qr||e===Xr||e===Yr}function Ji(e=Qi()){return e!==ti&&e!==ni}function ea(e){return{settingsId:pi,cropId:e?._lastCropChangeId||0}}function ta(e,t){if(function(e,t){return!!e&&(pi!==e.settingsId||(t?._lastCropChangeId||0)!==e.cropId)}(e,t)){const e=new Error("Interrupted");throw e.code="INTERRUPTED",e}}function na(e){if(e&&e()){const e=new Error("Cancelled");throw e.code="CANCELLED",e}}async function ra(e=1){await new Promise(t=>setTimeout(t,e))}function ia(){const e=document.getElementById("resizeEngine")?.value||"jsquash",t="photon"===e,n=document.getElementById("jsquashResizeMethod")?.value||Gr,r=parseInt(document.getElementById("photonResizeFilter")?.value,10);return{usePhotonResize:t,jsquashMethod:n,photonSamplingFilter:Number.isFinite(r)?Math.min(5,Math.max(1,r)):5,engine:e}}function aa(){const e=document.getElementById("resizeEngine"),t=document.getElementById("jsquashResizeMethod"),n=document.getElementById("photonResizeFilter"),r=document.getElementById("jsquashFilterGroup"),i=document.getElementById("photonFilterGroup");if(!e||!t||!n)return;const a="photon"===e.value;r&&(r.style.display=a?"none":"block"),i&&(i.style.display=a?"block":"none"),t.disabled=a,n.disabled=!a}function oa(e,t=Qi()){if(!e)return{width:0,height:0,shouldResize:!1,crop:null};if(t===ti)return{width:e.width,height:e.height,shouldResize:!1,crop:{x:0,y:0,width:e.width,height:e.height}};if(t===ni){const t=Yi(),n=Math.max(1,Math.round(e.width*t/100)),r=Math.max(1,Math.round(e.height*t/100));return{width:n,height:r,shouldResize:n!==e.width||r!==e.height,crop:{x:0,y:0,width:e.width,height:e.height}}}const n=e.crop||{x:0,y:0,width:e.width,height:e.height},r=Math.max(1,Math.round(n.width)),i=Math.max(1,Math.round(n.height)),a=r/i;if(t===ei||t===Xr)return{width:r,height:i,shouldResize:!1,crop:n};if(t===Vr){const e=parseInt(document.getElementById("exportWidth").value),t=Number.isFinite(e)&&e>0?e:r;return{width:t,height:Math.max(1,Math.round(t/a)),shouldResize:!0,crop:n}}if(t===Kr){const e=parseInt(document.getElementById("exportHeight").value),t=Number.isFinite(e)&&e>0?e:i;return{width:Math.max(1,Math.round(t*a)),height:t,shouldResize:!0,crop:n}}if(t===Jr){const e=parseInt(document.getElementById("exportWidth").value),t=parseInt(document.getElementById("exportHeight").value),a=Number.isFinite(e)&&e>0?e:r,o=Number.isFinite(t)&&t>0?t:i,s=Math.min(a/r,o/i),c=Math.max(1,Math.round(r*s)),l=Math.max(1,Math.round(i*s));return{width:c,height:l,shouldResize:c!==r||l!==i,crop:n}}const o=parseInt(document.getElementById("exportWidth").value),s=parseInt(document.getElementById("exportHeight").value);return{width:Number.isFinite(o)&&o>0?o:r,height:Number.isFinite(s)&&s>0?s:i,shouldResize:!0,crop:n}}function sa(e,t,n=null){if(e){if(t)return e.disabled=!1,void(""===e.value&&(e.dataset.stashedValue?e.value=e.dataset.stashedValue:null!==n&&(e.value=n)));""!==e.value&&(e.dataset.stashedValue=e.value),e.value="",e.disabled=!0}}function ca(){const e=Qi(),t=document.getElementById("aspectRatioSection"),n=document.getElementById("exportSizeSection"),r=document.getElementById("scaleSection"),i=document.getElementById("exportWidth"),a=document.getElementById("exportHeight"),o=Number.isFinite(Fr.exportWidth)?Fr.exportWidth:1920,s=Number.isFinite(Fr.exportHeight)?Fr.exportHeight:1080;if(t&&t.classList.toggle("collapsed",e!==Qr&&e!==Xr),n&&n.classList.toggle("collapsed",e===ti||e===ni||e===Xr||e===ei),r&&r.classList.toggle("collapsed",e!==ni),e===Qr||e===Xr||e===Yr||e===Jr?(sa(i,!0,o),sa(a,!0,s)):e===Vr?(sa(i,!0,o),sa(a,!1,s)):e===Kr?(sa(i,!1,o),sa(a,!0,s)):(sa(i,!1,o),sa(a,!1,s)),e===Yr){const e=parseInt(i.value),t=parseInt(a.value);Number.isFinite(e)&&Number.isFinite(t)&&t>0&&(Ur=e/t,$a())}else if(e===Qr){$a();const e=parseInt(i.value,10),t=parseInt(a.value,10);Number.isFinite(e)&&Number.isFinite(t)&&t>0&&(Ur=e/t)}else if(e===Xr){const e=parseFloat(document.getElementById("aspectW")?.value),t=parseFloat(document.getElementById("aspectH")?.value);if(Number.isFinite(e)&&Number.isFinite(t)&&t>0){Ur=e/t;const n=parseInt(i.value,10);Number.isFinite(n)&&n>0&&(a.value=Math.round(n/Ur))}}else e===ni&&Vi(!1);Ki(e)&&e!==Bi&&Or.forEach(e=>{e.crop=La(e.width,e.height)}),function(e){if(!e){const e=document.getElementById("imagesGrid");e&&e.querySelectorAll(".crop-box").forEach(e=>{e._resizeObserver&&"function"==typeof e._resizeObserver.disconnect&&e._resizeObserver.disconnect(),e.remove()});const t=document.getElementById("previewWrapper");return void(t&&t.querySelectorAll(".crop-box").forEach(e=>{e._resizeObserver&&"function"==typeof e._resizeObserver.disconnect&&e._resizeObserver.disconnect(),e.remove()}))}Ua()}(Ji(e)),Bi=e,Ha()}document.getElementById("fileInput").addEventListener("change",function(e){Aa(e.target.files)}),document.getElementById("aboutModal").addEventListener("click",e=>{"aboutModal"===e.target.id&&Ba()}),document.getElementById("changelogModal").addEventListener("click",e=>{"changelogModal"===e.target.id&&Sa()}),window.addEventListener("beforeunload",e=>{Li&&(e.preventDefault(),e.returnValue="Do you wish to save changes?")}),document.addEventListener("keydown",e=>{const t=e.target,n=t&&t.tagName?t.tagName.toLowerCase():"",r=Boolean(t?.isContentEditable||"input"===n||"textarea"===n||"select"===n||"button"===n);if(!("Space"!==e.code&&" "!==e.key||e.repeat||r)){if(!jr)return;const t=document.getElementById("aboutModal");if(t?.classList.contains("active"))return;e.preventDefault();const n=document.getElementById("previewPane");return n?.classList.contains("active")||lo(jr),void eo()}if("Escape"!==e.key)return;if(window.innerWidth<ya){const e=document.getElementById("previewPane");if(e&&document.fullscreenElement===e)return void document.exitFullscreen();if(Fi&&e?.classList.contains("active"))return void eo()}const i=document.getElementById("changelogModal");if(i?.classList.contains("active"))return void Sa();const a=document.getElementById("previewPane");!document.querySelector(".export-preview-overlay")||ci?a&&a.classList.contains("active")?ho():document.getElementById("aboutModal").classList.contains("active")&&Ba():po()}),document.addEventListener("paste",e=>{if(!e.clipboardData||!e.clipboardData.items)return;const t=[];for(const n of e.clipboardData.items)if(n.type&&n.type.startsWith("image/")){const e=n.getAsFile();e&&t.push(e)}t.length&&Aa(t)});const la=document.getElementById("dropZone"),ua=document.getElementById("gridContainer");function da(e){e.preventDefault(),e.stopPropagation()}["dragenter","dragover","dragleave","drop"].forEach(e=>{ua.addEventListener(e,da,!1)}),["dragenter","dragover"].forEach(e=>{ua.addEventListener(e,()=>{la.classList.add("active")},!1)}),["dragleave","drop"].forEach(e=>{ua.addEventListener(e,()=>{la.classList.remove("active")},!1)}),ua.addEventListener("drop",e=>{Aa(e.dataTransfer.files)},!1);const ha=document.getElementById("resizer"),fa=document.getElementById("imagesArea"),pa=document.getElementById("previewSplitResizer"),ma=document.getElementById("previewLeft"),ga=document.getElementById("previewSplit");let _a=!1,ba=0,wa=0;const ya=700;function va(e,t,n=180){const r=Math.floor((e-t)/2),i=Math.max(0,Math.min(n,r)),a=e-t-i;if(a<i){const e=Math.max(0,r);return{min:e,max:e}}return{min:i,max:a}}function xa(e){const t=function(){const e=document.querySelector(".split-container"),t=e?.getBoundingClientRect().width||window.innerWidth,n=ha?ha.getBoundingClientRect().width:4,r=Math.max(0,t-n-320);let i=267;return r<i&&(i=Math.max(200,r)),{min:i,max:r}}();return Math.max(t.min,Math.min(t.max,e))}function Ea(){const e=document.getElementById("previewPane");return Boolean(e?.classList.contains("active"))}function Ia(){ha&&ha.classList.toggle("disabled",!Ea())}function ka(){const e=document.getElementById("previewPane"),t=document.getElementById("previewContent");return Boolean(e?.classList.contains("active")&&t?.classList.contains("split-active"))}function Ca(){document.getElementById("fileInput").click()}function za(){Vo(),document.getElementById("aboutModal").classList.add("active")}function Ba(){document.getElementById("aboutModal").classList.remove("active"),Xo()}function Sa(){document.getElementById("changelogModal").classList.remove("active")}function Aa(e){const t=Array.from(e).filter(e=>e.type.startsWith("image/"));if(0===t.length)return;const n=[];let r=t.length;const i=()=>{r-=1,r>0||(Ra(),Ro(),ja(!0),n.length>0&&Go(!0))};t.forEach(e=>{const t=new FileReader;t.onload=t=>{const r=new Image;r.onload=()=>{const a={id:Date.now()+Math.random(),name:e.name,src:t.target.result,file:e,width:r.width,height:r.height,crop:La(r.width,r.height),justAdded:!0};Or.push(a),n.push(a),i()},r.onerror=i,r.src=t.target.result},t.onerror=i,t.readAsDataURL(e)}),la&&la.classList.add("hidden"),ja(!0)}function La(e,t){if(!Ki())return{x:0,y:0,width:e,height:t};const n=e/t,r=Number.isFinite(Ur)&&Ur>0?Ur:n;if(n>r){const n=t*r;return{x:(e-n)/2,y:0,width:n,height:t}}{const n=e/r;return{x:0,y:(t-n)/2,width:e,height:n}}}function Ra(){const e=document.getElementById("imagesGrid");e.innerHTML="",So(),Or.forEach(t=>{const n=function(e){const t=document.createElement("div");t.className="image-card",e.justAdded&&(t.classList.add("animate-in"),t.addEventListener("animationend",()=>{t.classList.remove("animate-in")},{once:!0})),t.dataset.imageId=e.id,jr===e.id&&t.classList.add("selected");const n=document.createElement("div");n.className="image-preview-container";const r=document.createElement("div");r.className="image-preview-wrapper";const i=document.createElement("div");i.style.position="relative",i.style.width="100%",i.style.height="100%",i.style.lineHeight="0";const a=document.createElement("img");a.className="image-preview",a.style.transform="scale(1)",a.style.position="relative",i.appendChild(a),a.onload=()=>{Oa(i,a,e,!1)},a.src=e.src,a.complete&&a.naturalWidth>0&&requestAnimationFrame(()=>{Oa(i,a,e,!1)}),r.appendChild(i),n.appendChild(r);const o=document.createElement("div");o.className="image-name",o.onclick=()=>lo(e.id);const s=document.createElement("span");s.className="image-name-text",s.innerHTML=Ta(e);const c=document.createElement("button");return c.className="image-remove-btn",c.title="Remove image",c.textContent="",c.onclick=t=>{t.stopPropagation(),function(e){Or=Or.filter(t=>t.id!==e);const t=document.getElementById("imagesGrid");if(t){const n=t.querySelector(`[data-image-id="${e}"]`);n&&n.remove()}jr===e&&(jr=null,po(),ho(),ci&&Ka(!1)),Ro(),0===Or.length&&(la&&la.classList.remove("hidden"),ja(),fo()),Go(!0)}(e.id)},o.appendChild(s),o.appendChild(c),t.appendChild(n),t.appendChild(o),t}(t);e.appendChild(n),t.justAdded=!1}),Ma(),ja(),Pa()}function Ta(e){if(!e)return"";const t=(n=e.name,String(n??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"));var n;if(!Oi)return t;const{width:r,height:i}=oa(e),a=e.width,o=e.height;return Number.isFinite(r)&&Number.isFinite(i)?`${a}<span class="image-dimensions-x">x</span>${o}<span class="image-dimensions-x">-></span>${r}<span class="image-dimensions-x">x</span>${i} ${t}`:t}function Fa(e){const t=document.getElementById("imagesGrid");if(!t||!e)return;const n=t.querySelector(`[data-image-id="${e.id}"]`);if(!n)return;const r=n.querySelector(".image-name-text");r&&(r.innerHTML=Ta(e))}function Ma(){const e=document.getElementById("gridInfoToggle");e&&(e.classList.toggle("active",Oi),e.setAttribute("aria-pressed",String(Oi)),e.title=Oi?"Show filenames":"Show size info"),Or.forEach(e=>Fa(e))}function Pa(){const e=document.getElementById("filenameTip");if(!e)return;const t=Di&&Or.length>0&&!_i;e.classList.toggle("hidden",!t),t&&Na()}function Na(){const e=document.getElementById("filenameTip"),t=document.getElementById("imagesGrid"),n=document.getElementById("gridContainer");if(!e||!t||!n)return;const r=t.querySelector(".image-card");if(!r)return void e.classList.add("hidden");const i=r.querySelector(".image-name");if(!i)return void e.classList.add("hidden");e.classList.remove("hidden");const a=n.getBoundingClientRect(),o=r.getBoundingClientRect(),s=i.getBoundingClientRect(),c=o.bottom-a.top+8+n.scrollTop,l=s.left-a.left+n.scrollLeft,u=e.offsetWidth||260,d=n.clientWidth||a.width,h=Math.max(12,Math.min(l,d-u-12));e.style.top=`${Math.round(c)}px`,e.style.left=`${Math.round(h)}px`;const f=s.left-a.left+s.width/2+n.scrollLeft,p=Math.max(16,Math.min(u-16,f-h));e.style.setProperty("--arrow-left",`${Math.round(p)}px`)}function Wa(){const e=document.getElementById("resizeModeInfoText");if(!e)return;const t=function(e=Qi()){switch(e){case Qr:return"Export size locked to aspect ratio.";case Xr:return"Fixed aspect ratio crop at 100% (no resize).";case Yr:return"Force exact output dimensions.";case Vr:return"Lock width; height derives from crop.";case Kr:return"Lock height; width derives from crop.";case Jr:return"Resize to fit within max width/height; crop freely.";case ei:return"Crop freely; no resize.";case ni:return"Scale by percent; no crop overlay.";case ti:return"Convert only; no crop or resize.";default:return""}}();e.textContent=t||" "}function Oa(e,t,n,r){if(!Ji())return;if(!e||e.querySelector(".crop-box"))return;const i=function(e,t=!1){const n=document.createElement("div");return n.className="crop-box",to(n,e,t),["nw","ne","sw","se"].forEach(r=>{const i=document.createElement("div");i.className=`crop-handle ${r}`,n.appendChild(i),function(e,t,n,r){let i,a,o,s=!1,c=!1,l=0,u=null;e.addEventListener("mousedown",n=>{s=!0,c=!1,l=0,e.classList.add("dragging"),i=n.clientX,a=n.clientY,o={...t.crop},n.preventDefault(),n.stopPropagation()}),e.addEventListener("pointerdown",n=>{"mouse"!==n.pointerType&&(s=!0,c=!1,l=0,u=n.pointerId,e.classList.add("dragging"),i=n.clientX,a=n.clientY,o={...t.crop},e.setPointerCapture?.(n.pointerId),n.preventDefault(),n.stopPropagation())}),document.addEventListener("mousemove",u=>{if(!s)return;const d=e.parentElement,h=d.parentElement,f=(h.querySelector(".image-preview, .preview-image"),no(h,t));if(!f)return;const{scale:p}=f,m=(u.clientX-i)/p,g=(u.clientY-a)/p;let _={...o};n.includes("n")&&(_.y=o.y+g,_.height=o.height-g),n.includes("s")&&(_.height=o.height+g),n.includes("w")&&(_.x=o.x+m,_.width=o.width-m),n.includes("e")&&(_.width=o.width+m),Ki()&&(_=co(_,o,n,t,Ur)),_=ao(_,t),_.width>20&&_.height>20&&(t.crop=_,_.x===o.x&&_.y===o.y&&_.width===o.width&&_.height===o.height||(c=!0,l=++fi,t._lastCropChangeId=l),to(d,t,r),r?(io(t),c&&Eo({preserveImage:!0},$i(),l)):(jr===t.id&&ro(t),c&&jr===t.id&&Eo({preserveImage:!0},$i(),l)))}),document.addEventListener("pointermove",d=>{if("mouse"===d.pointerType)return;if(!s)return;if(null!==u&&d.pointerId!==u)return;const h=e.parentElement,f=h.parentElement,p=(f.querySelector(".image-preview, .preview-image"),no(f,t));if(!p)return;const{scale:m}=p,g=(d.clientX-i)/m,_=(d.clientY-a)/m;let b={...o};n.includes("n")&&(b.y=o.y+_,b.height=o.height-_),n.includes("s")&&(b.height=o.height+_),n.includes("w")&&(b.x=o.x+g,b.width=o.width-g),n.includes("e")&&(b.width=o.width+g),Ki()&&(b=co(b,o,n,t,Ur)),b=ao(b,t),b.width>20&&b.height>20&&(t.crop=b,b.x===o.x&&b.y===o.y&&b.width===o.width&&b.height===o.height||(c=!0,l=++fi,t._lastCropChangeId=l),to(h,t,r),r?(io(t),c&&Eo({preserveImage:!0},$i(),l)):(jr===t.id&&ro(t),c&&jr===t.id&&Eo({preserveImage:!0},$i(),l)))}),document.addEventListener("mouseup",()=>{s&&(s=!1,u=null,e.classList.remove("dragging"),r?(io(t),c&&(t._lastCropChangeId||0)>di&&Eo({preserveImage:!0},Hi(),t._lastCropChangeId||0)):(ro(t),c&&jr===t.id&&(t._lastCropChangeId||0)>di&&Eo({preserveImage:!0},Hi(),t._lastCropChangeId||0)))}),document.addEventListener("pointerup",n=>{"mouse"!==n.pointerType&&s&&(null!==u&&n.pointerId!==u||(s=!1,u=null,e.classList.remove("dragging"),r?(io(t),c&&(t._lastCropChangeId||0)>di&&Eo({preserveImage:!0},Hi(),t._lastCropChangeId||0)):(ro(t),c&&jr===t.id&&(t._lastCropChangeId||0)>di&&Eo({preserveImage:!0},Hi(),t._lastCropChangeId||0))))}),document.addEventListener("pointercancel",t=>{"mouse"!==t.pointerType&&s&&(null!==u&&t.pointerId!==u||(s=!1,u=null,e.classList.remove("dragging")))})}(i,e,r,t)}),function(e,t,n){let r,i,a,o,s=!1,c=!1,l=0,u=null;e.addEventListener("mousedown",e=>{e.target.classList.contains("crop-handle")||(s=!0,c=!1,l=0,r=e.clientX,i=e.clientY,a=t.crop.x,o=t.crop.y,e.preventDefault())}),e.addEventListener("pointerdown",n=>{"mouse"!==n.pointerType&&(n.target.classList.contains("crop-handle")||(s=!0,c=!1,l=0,u=n.pointerId,r=n.clientX,i=n.clientY,a=t.crop.x,o=t.crop.y,e.setPointerCapture?.(n.pointerId),n.preventDefault()))}),document.addEventListener("mousemove",u=>{if(!s)return;const d=e.parentElement,h=(d.querySelector(".image-preview, .preview-image"),no(d,t));if(!h)return;const{scale:f}=h,p=(u.clientX-r)/f,m=(u.clientY-i)/f;let g=a+p,_=o+m;g=Math.max(0,Math.min(g,t.width-t.crop.width)),_=Math.max(0,Math.min(_,t.height-t.crop.height)),t.crop.x=g,t.crop.y=_,g===a&&_===o||(c=!0,l=++fi,t._lastCropChangeId=l),to(e,t,n),n?(io(t),c&&Eo({preserveImage:!0},$i(),l)):(jr===t.id&&ro(t),c&&jr===t.id&&Eo({preserveImage:!0},$i(),l))}),document.addEventListener("pointermove",d=>{if("mouse"===d.pointerType)return;if(!s)return;if(null!==u&&d.pointerId!==u)return;const h=e.parentElement,f=(h.querySelector(".image-preview, .preview-image"),no(h,t));if(!f)return;const{scale:p}=f,m=(d.clientX-r)/p,g=(d.clientY-i)/p;let _=a+m,b=o+g;_=Math.max(0,Math.min(_,t.width-t.crop.width)),b=Math.max(0,Math.min(b,t.height-t.crop.height)),t.crop.x=_,t.crop.y=b,_===a&&b===o||(c=!0,l=++fi,t._lastCropChangeId=l),to(e,t,n),n?(io(t),c&&Eo({preserveImage:!0},$i(),l)):(jr===t.id&&ro(t),c&&jr===t.id&&Eo({preserveImage:!0},$i(),l))}),document.addEventListener("mouseup",()=>{s&&(s=!1,u=null,n?(io(t),c&&(t._lastCropChangeId||0)>di&&Eo({preserveImage:!0},Hi(),t._lastCropChangeId||0)):(ro(t),c&&jr===t.id&&(t._lastCropChangeId||0)>di&&Eo({preserveImage:!0},Hi(),t._lastCropChangeId||0)))}),document.addEventListener("pointerup",e=>{"mouse"!==e.pointerType&&s&&(null!==u&&e.pointerId!==u||(s=!1,u=null,n?(io(t),c&&(t._lastCropChangeId||0)>di&&Eo({preserveImage:!0},Hi(),t._lastCropChangeId||0)):(ro(t),c&&jr===t.id&&(t._lastCropChangeId||0)>di&&Eo({preserveImage:!0},Hi(),t._lastCropChangeId||0))))}),document.addEventListener("pointercancel",e=>{"mouse"!==e.pointerType&&s&&(null!==u&&e.pointerId!==u||(s=!1,u=null))})}(n,e,t),n}(n,r);if(e.appendChild(i),requestAnimationFrame(()=>{to(i,n,r)}),"undefined"!=typeof ResizeObserver){const e=new ResizeObserver(()=>{to(i,n,r)});e.observe(t),i._resizeObserver=e}}function Da(){const e=document.getElementById("imagesGrid");e&&e.querySelectorAll(".image-card").forEach(e=>{const t=Number(e.dataset.imageId);jr&&t===jr?e.classList.add("selected"):e.classList.remove("selected")})}function ja(e=!1){const t=document.getElementById("imagesGrid"),n=document.getElementById("dropZone");t&&(t.style.display=_i?"none":"grid"),n&&(n.style.display=_i?"none":"",n.classList.toggle("hidden",e||Or.length>0))}function Ua(){if(Ji()&&(Or.forEach(e=>function(e){if(!Ji())return;const t=document.getElementById("imagesGrid");if(!t)return;const n=t.querySelector(`[data-image-id="${e.id}"]`);if(!n)return;const r=n.querySelector(".image-preview");if(!r)return;const i=r.parentElement;if(!i)return;i.querySelector(".crop-box")||Oa(i,r,e,!1);const a=i.querySelector(".crop-box");a&&to(a,e,!1)}(e)),jr)){const e=document.getElementById("previewWrapper");if(!e)return;const t=Or.find(e=>e.id===jr);if(!t)return;const n=e.querySelector(".preview-image"),r=n?n.parentElement:null;n&&r&&!r.querySelector(".crop-box")&&Oa(r,n,t,!0);const i=e.querySelector(".crop-box");i&&to(i,t,!0)}}function $a(){const e=document.getElementById("aspectW"),t=document.getElementById("aspectH");if(!e||!t)return;const n=parseInt(document.getElementById("exportWidth").value),r=parseInt(document.getElementById("exportHeight").value);if(Number.isFinite(n)&&Number.isFinite(r)&&0!==r){const{arW:i,arH:a}=Nr(n,r);parseFloat(e.value)!==i&&(e.value=i),parseFloat(t.value)!==a&&(t.value=a),Yo(0,i,a)}Ha()}function Ha(){const e=document.getElementById("aspectMismatchWarning"),t=document.getElementById("aspectRoundingInfo");if(!e||!t)return;const{mismatch:n,rounded:r}=function(){if(Qi()!==Qr)return{mismatch:!1,rounded:!1,classification:"exact"};const e=parseInt(document.getElementById("exportWidth")?.value,10),t=parseInt(document.getElementById("exportHeight")?.value,10),n=parseFloat(document.getElementById("aspectW")?.value),r=parseFloat(document.getElementById("aspectH")?.value);if(!Number.isFinite(e)||!Number.isFinite(t)||e<=0||t<=0)return{mismatch:!1,rounded:!1,classification:"exact"};if(!Number.isFinite(n)||!Number.isFinite(r)||n<=0||r<=0)return{mismatch:!1,rounded:!1,classification:"exact"};const i=function(e,t,n,r,i=1){const a=Pr(n,r),o=n/a,s=r/a;if(e*s===t*o)return"exact";const c=t*o/s,l=e-Math.round(c);if(Math.abs(l)<=i)return l>0?"rounded_up_width":"rounded_down_width";const u=e*s/o,d=t-Math.round(u);return Math.abs(d)<=i?d>0?"rounded_up_height":"rounded_down_height":"different"}(e,t,Math.round(n),Math.round(r));return{mismatch:"different"===i,rounded:i.startsWith("rounded_"),classification:i}}();e.classList.toggle("visible",n),t.classList.toggle("visible",r)}function qa(){const e=parseInt(document.getElementById("exportWidth").value),t=parseInt(document.getElementById("exportHeight").value);!Number.isFinite(e)||!Number.isFinite(t)||t<=0||(Ur=e/t,Or.forEach(e=>{e.crop=La(e.width,e.height)}),Ua(),Ha())}function Za(){const e=Qi();if(e!==Qr&&e!==Xr)return;const t=parseFloat(document.getElementById("aspectW").value),n=parseFloat(document.getElementById("aspectH").value);if(Number.isFinite(t)&&Number.isFinite(n)&&!(n<=0)){if(Ur=t/n,Or.forEach(e=>{e.crop=La(e.width,e.height)}),e===Qr||e===Xr){const e=parseInt(document.getElementById("exportWidth").value,10);if(Number.isFinite(e)&&e>0){const t=Math.round(e/Ur);document.getElementById("exportHeight").value=t}}Yo(0,t,n),Ha(),Xo({aspectRatio:{width:t,height:n}}),Io(),Do(),Ua(),Eo({preserveImage:!0},Ui(!0))}}function Ga(){const e=document.getElementById("previewLayoutSingle"),t=document.getElementById("previewLayoutHorizontal"),n=document.getElementById("previewLayoutVertical");e&&(e.classList.toggle("active",!ci),e.setAttribute("aria-pressed",String(!ci))),t&&(t.classList.toggle("active",ci&&"horizontal"===zi),t.setAttribute("aria-pressed",String(ci&&"horizontal"===zi))),n&&(n.classList.toggle("active",ci&&"vertical"===zi),n.setAttribute("aria-pressed",String(ci&&"vertical"===zi)))}function Qa(){const e=document.getElementById("previewFullscreenBtn");if(!e)return;const t=Boolean(document.fullscreenElement)||Fi;e.classList.toggle("active",t),e.textContent=t?"":"",e.title=t?"Exit full preview (spacebar)":"Expand preview (spacebar)"}function Xa(){const e=document.getElementById("previewPane");return Boolean(Fi||e&&document.fullscreenElement===e)}function Ya(e){if(!ci||!ma||!ga)return;if("vertical"===zi){const t=va(ga.getBoundingClientRect().height,pa?pa.getBoundingClientRect().height:6),n=ma.getBoundingClientRect().height;if(!Number.isFinite(n)||n<=0)return;const r=Math.max(t.min,Math.min(t.max,n));return void(e?Ci=r:Ii=r)}const t=va(ga.getBoundingClientRect().width,pa?pa.getBoundingClientRect().width:6),n=ma.getBoundingClientRect().width;if(!Number.isFinite(n)||n<=0)return;const r=Math.max(t.min,Math.min(t.max,n));e?ki=r:Ei=r}function Va(){if(!ci||!ma||!ga)return;const e=Xa();if("vertical"===zi){const t=ga.getBoundingClientRect().height,n=pa?pa.getBoundingClientRect().height:6,r=va(t,n);let i;if(e&&Mi)i=Math.floor((t-n)/2),Ci=i,Mi=!1;else{const r=e?Ci:Ii,a=ma.getBoundingClientRect().height,o=Number.isFinite(a)&&a>0?a:null;i=r??o??Math.floor((t-n)/2)}i=Math.max(r.min,Math.min(r.max,i)),ma.style.flex=`0 0 ${i}px`}else{const t=ga.getBoundingClientRect().width,n=pa?pa.getBoundingClientRect().width:6,r=va(t,n);let i;if(e&&Mi)i=Math.floor((t-n)/2),ki=i,Mi=!1;else{const r=e?ki:Ei,a=ma.getBoundingClientRect().width,o=Number.isFinite(a)&&a>0?a:null;i=r??o??Math.floor((t-n)/2)}i=Math.max(r.min,Math.min(r.max,i)),ma.style.flex=`0 0 ${i}px`}}function Ka(e,t=!1,n=zi){ci=e,e&&(zi="vertical"===n?"vertical":"horizontal"),li+=1;const r=document.getElementById("previewContent");if(r&&(r.classList.toggle("split-active",e),r.classList.toggle("split-vertical",e&&"vertical"===zi)),qi(),Ga(),e){if(Va(),t||(xi="vertical"===zi?"split-vertical":"split-horizontal",Xo({lastExportPreviewMode:xi})),mo(),jr){const e=Or.find(e=>e.id===jr);e&&xo(e,{preserveImage:!0})}}else po(t),ma&&(ma.style.flex=""),t||(xi=xi.startsWith("split")?"none":xi,Xo({lastExportPreviewMode:xi}));Co()}function Ja(e,t=!1){if("single"===e){if(!ci)return;return void Ka(!1,t)}const n="split-vertical"===e?"vertical":"horizontal";ci&&zi===n||Ka(!0,t,n)}function eo(){const e=document.getElementById("previewPane");if(!e||!e.classList.contains("active"))return Fi=!1,document.body.classList.remove("preview-fullscreen"),void Qa();if(document.fullscreenElement)return void(document.fullscreenElement===e&&(Ya(!0),document.exitFullscreen()));if(e.requestFullscreen)return Ya(!1),Mi=!0,ki=null,Ci=null,void e.requestFullscreen().catch(()=>{const e=Fi;Ya(!!e),Fi=!Fi,document.body.classList.toggle("preview-fullscreen",Fi),Qa(),Co(),Va(),!e&&Fi&&(Mi=!0,ki=null,Ci=null,Ya(!0))});const t=Fi;Ya(!!t),Fi=!Fi,document.body.classList.toggle("preview-fullscreen",Fi),Fi&&(Mi=!0,ki=null,Ci=null),Qa(),Va(),Co(),!t&&Fi&&Ya(!0)}function to(e,t,n){const r=e.parentElement;if(!r)return;const i=r.querySelector(".image-preview, .preview-image");if(!i)return;if(!i.complete||0===i.naturalWidth)return void setTimeout(()=>to(e,t,n),50);const a=no(r,t);if(!a)return void requestAnimationFrame(()=>to(e,t,n));const{scale:o,offsetX:s,offsetY:c}=a;e.style.position="absolute",e.style.left=`${s+t.crop.x*o}px`,e.style.top=`${c+t.crop.y*o}px`,e.style.width=t.crop.width*o+"px",e.style.height=t.crop.height*o+"px",!n&&Oi&&Fa(t)}function no(e,t){const n=e.getBoundingClientRect(),r=n.width,i=n.height;if(!r||!i)return null;const a=t.width/t.height;let o,s;return a>r/i?(o=r,s=r/a):(s=i,o=i*a),{scale:o/t.width,offsetX:(r-o)/2,offsetY:(i-s)/2}}function ro(e){if(!jr||jr!==e.id)return;const t=document.getElementById("previewWrapper");if(!t)return;const n=t.querySelector(".crop-box");n&&to(n,e,!0)}function io(e){const t=document.getElementById("imagesGrid");if(!t)return;const n=t.querySelector(`[data-image-id="${e.id}"]`);if(!n)return;const r=n.querySelector(".crop-box");r&&to(r,e,!1)}function ao(e,t){const n={...e};return n.x<0&&(n.width+=n.x,n.x=0),n.y<0&&(n.height+=n.y,n.y=0),n.x+n.width>t.width&&(n.width=t.width-n.x),n.y+n.height>t.height&&(n.height=t.height-n.y),n}function oo(e,t,n,r){const i=e.crop||{x:0,y:0,width:e.width,height:e.height},a=20,o=i.x+i.width/2,s=i.y+i.height/2;let c=i.width+2*t*n,l=i.height+2*t*n;if(r)if(r>=1){const e=Math.max(a,a*r);c=Math.max(e,c),l=c/r}else{const e=Math.max(a,a/r);l=Math.max(e,l),c=l*r}else c=Math.max(a,c),l=Math.max(a,l);let u={x:o-c/2,y:s-l/2,width:c,height:l};return u=r?function(e,t,n){const r={...e},i=t.width,a=t.height;return r.width>i&&(r.width=i,r.height=r.width/n),r.height>a&&(r.height=a,r.width=r.height*n),r.width>i&&(r.width=i,r.height=r.width/n),r.x=Math.max(0,Math.min(r.x,t.width-r.width)),r.y=Math.max(0,Math.min(r.y,t.height-r.height)),r}(u,e,r):ao(u,e),u}function so(){const e=document.getElementById("previewFooter");if(!e)return;const t=document.getElementById("previewPane"),n=Boolean(t?.classList.contains("active")&&jr&&Ji());e.classList.toggle("hidden",!n)}function co(e,t,n,r,i){const a={...e},o=n.includes("w"),s=n.includes("n"),c=n.includes("e"),l=n.includes("s");return o&&(a.width=t.x+t.width-a.x),s&&(a.height=t.y+t.height-a.y),c||o?(a.height=a.width/i,s&&(a.y=t.y+t.height-a.height)):(l||s)&&(a.width=a.height*i,o&&(a.x=t.x+t.width-a.width)),a.x<0&&(a.x=0,a.width=t.x+t.width,a.height=a.width/i),a.y<0&&(a.y=0,a.height=t.y+t.height,a.width=a.height*i),a.x+a.width>r.width&&(a.width=r.width-a.x,a.height=a.width/i,s&&(a.y=t.y+t.height-a.height)),a.y+a.height>r.height&&(a.height=r.height-a.y,a.width=a.height*i,o&&(a.x=t.x+t.width-a.width)),a}function lo(e){jr=e;const t=Or.find(t=>t.id===e),n=document.getElementById("previewPane"),r=document.getElementById("previewWrapper"),i=document.getElementById("previewTitle"),a=document.querySelector(".export-preview-overlay");if(!t)return void fo();if(!n||!r||!i)return;si&&(clearTimeout(si),si=null),n.classList.add("active"),document.body.classList.add("preview-active"),Ia(),Qa(),i.dataset.baseTitle=t.name,i.textContent=t.name,r.innerHTML="";const o=document.createElement("div");o.style.position="relative",o.style.display="block",o.style.lineHeight="0",o.style.width="100%",o.style.height="100%";const s=document.createElement("img");s.className="preview-image",s.style.width="100%",s.style.height="100%",s.style.objectFit="contain",s.style.position="relative",o.appendChild(s),r.appendChild(o),s.onload=()=>{Oa(o,s,t,!0),requestAnimationFrame(()=>{const e=o.querySelector(".crop-box");e&&to(e,t,!0),Co()})},s.src=t.src,s.complete&&s.naturalWidth>0&&requestAnimationFrame(()=>{Oa(o,s,t,!0)}),Da(),so();const c=window.innerWidth<ya;if(Ti=c,c&&(ci&&Ka(!1,!0),Xa()||eo()),("split"===xi||"split-horizontal"===xi||"split-vertical"===xi)&&!c){const e="split-vertical"===xi?"vertical":"horizontal";return ci&&zi===e?void xo(t,{preserveImage:!0}):void Ka(!0,!0,e)}"full"===xi?(ci&&Ka(!1,!0),xo(t,{preserveImage:!0})):(ci||a)&&xo(t,{preserveImage:!0})}function uo(e=!1){document.getElementById("previewPane").classList.remove("active"),document.body.classList.remove("preview-active"),Ia(),jr=null,Ti=!1,Fi=!1,document.body.classList.remove("preview-fullscreen"),Qa(),li+=1,si&&(clearTimeout(si),si=null),ui=!1,qi();const t=ci;if(!e)if(t)Ka(!1),xi="vertical"===zi?"split-vertical":"split-horizontal";else{ci=!1;const e=document.getElementById("previewContent");e&&(e.classList.remove("split-active"),e.classList.remove("split-vertical")),qi(),Ga(),xi="none"}if(t){const e=document.getElementById("exportPreviewHost");e&&(e.innerHTML="")}ci=!1,ma&&(ma.style.flex=""),fa&&(fa.style.flex="");const n=document.getElementById("previewContent");n&&(n.classList.remove("split-active"),n.classList.remove("split-vertical")),Da(),so()}function ho(e=!1){const t=document.getElementById("previewPane");if(document.fullscreenElement&&document.fullscreenElement===t)return Pi={skipSplitReset:e},void document.exitFullscreen().catch(()=>{const e=Pi;Pi=null,uo(Boolean(e?.skipSplitReset))});uo(e)}function fo(){const e=document.getElementById("previewPane"),t=document.getElementById("previewContent"),n=document.getElementById("previewWrapper"),r=document.getElementById("exportPreviewHost"),i=document.querySelector(".export-preview-overlay");i&&i.remove(),r&&(r.innerHTML=""),n&&(n.innerHTML=""),e&&e.classList.remove("active"),document.body.classList.remove("preview-active"),t&&(t.classList.remove("split-active"),t.classList.remove("split-vertical")),ma&&(ma.style.flex=""),fa&&(fa.style.flex=""),ci=!1,ui=!1,xi="none",jr=null,Ti=!1,Ia(),qi(),Ga(),so(),Xo({lastExportPreviewMode:"none"})}function po(e=!1){const t=document.querySelector(".export-preview-overlay");t&&t.remove(),mo(),ui=!1,qi(),e||(xi="none"),!ci&&jr&&Or.find(e=>e.id===jr)&&lo(jr)}function mo(){if(!ci)return;const e=document.getElementById("exportPreviewHost");e&&(e.querySelector(".export-preview-overlay")||(e.innerHTML='<div class="export-preview-placeholder">Test Export to compare</div>'))}function go(e,t,n,r,i){if(!e||!t)return;const a=e.querySelector(".export-preview-size");if(!a)return;const o=t.naturalWidth,s=t.naturalHeight,c=[];Number.isFinite(n)&&n>=0&&c.push(`${(n/1024).toFixed(1)} KB`),Number.isFinite(o)&&Number.isFinite(s)&&o>0&&s>0&&c.push(`${o}x${s}`);const l=Number.isFinite(r)&&Number.isFinite(i)&&r>0&&i>0&&Number.isFinite(o)&&Number.isFinite(s)&&o>0&&s>0&&(r!==o||i!==s);if(l&&(c.push(`expected ${r}x${i}`),console.warn("Export preview size mismatch",{expected:{width:r,height:i},actual:{width:o,height:s}})),a.style.color=l?"var(--warning)":"var(--text-secondary)",c.length){const e=l?`MISMATCH: ${c.join("  ")}`:c.join("  ");a.textContent=`(${e})`}else a.textContent=""}function _o(e,t,n={}){if(!e)return;const r=e.querySelector(".export-preview-scroll");if(!r)return;const i=["fit","100","200","400"].includes(t)?t:"fit";e.dataset.zoomMode=i,r.classList.toggle("zoom-actual","fit"!==i);const a=e.querySelector(".export-preview-zoom-controls");a&&a.querySelectorAll("button[data-zoom]").forEach(e=>{e.classList.toggle("active",e.dataset.zoom===i)}),"fit"===i&&!1!==n.resetScroll&&(r.scrollLeft=0,r.scrollTop=0)}function bo(e,t){if(!e||!t)return 1;const n=e.dataset.zoomMode||"fit";return"fit"===n?function(e,t){if(!(e&&t&&t.naturalWidth&&t.naturalHeight))return 1;const n=function(e){if(!e)return{width:0,height:0};const t=window.getComputedStyle(e),n=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),r=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),i=e.clientWidth-(Number.isFinite(n)?n:0),a=e.clientHeight-(Number.isFinite(r)?r:0);return{width:Math.max(0,i),height:Math.max(0,a)}}(e);if(n.width<=0||n.height<=0)return 1;const r=Math.min(n.width/t.naturalWidth,n.height/t.naturalHeight,1);return Number.isFinite(r)?r:1}(e.querySelector(".export-preview-scroll"),t):"200"===n?2:"400"===n?4:1}function wo(e,t){if(!e)return;const n=e.querySelector(".export-preview-scroll"),r=e.querySelector(".export-preview-zoom-controls");n&&r&&(r.style.display="inline-flex",_o(e,e.dataset.zoomMode||"fit",{resetScroll:!1}),function(e,t){if(!(e&&t&&t.naturalWidth&&t.naturalHeight))return;const n=e.dataset.zoomMode||"fit";if("fit"===n)return t.style.width="",void(t.style.height="");let r=1;"200"===n&&(r=2),"400"===n&&(r=4),t.style.width=`${Math.max(1,Math.round(t.naturalWidth*r))}px`,t.style.height=`${Math.max(1,Math.round(t.naturalHeight*r))}px`}(e,t))}function yo(e){if(!e||e.dataset.panBound)return;e.dataset.panBound="true";let t=!1,n=0,r=0,i=0,a=0;e.addEventListener("pointerdown",o=>{0===o.button&&(t=!0,n=o.clientX,r=o.clientY,i=e.scrollLeft,a=e.scrollTop,e.classList.add("panning"),e.setPointerCapture(o.pointerId),o.preventDefault())}),e.addEventListener("pointermove",o=>{if(!t)return;const s=o.clientX-n,c=o.clientY-r;e.scrollLeft=i-s,e.scrollTop=a-c});const o=n=>{t&&(t=!1,e.classList.remove("panning"),n&&e.hasPointerCapture?.(n.pointerId)&&e.releasePointerCapture(n.pointerId))};e.addEventListener("pointerup",o),e.addEventListener("pointercancel",o)}function vo(e){if(!e||e.dataset.zoomBound)return;e.dataset.zoomBound="true";const t=e.querySelector(".export-preview-zoom-controls");t&&t.addEventListener("click",t=>{const n=t.target.closest("button[data-zoom]");if(!n)return;const r=e.querySelector(".export-preview-scroll"),i=e.querySelector(".export-preview-image");let a=null,o=null;if(r&&i){const t=bo(e,i)||1;t>0&&(a=(r.scrollLeft+r.clientWidth/2)/t,o=(r.scrollTop+r.clientHeight/2)/t)}_o(e,n.dataset.zoom,{resetScroll:!1}),wo(e,i),r&&i&&null!==a&&null!==o&&requestAnimationFrame(()=>{const t=bo(e,i)||1,n=a*t-r.clientWidth/2,s=o*t-r.clientHeight/2,c=Math.max(0,r.scrollWidth-r.clientWidth),l=Math.max(0,r.scrollHeight-r.clientHeight);r.scrollLeft=Math.min(c,Math.max(0,n)),r.scrollTop=Math.min(l,Math.max(0,s))}),Co()})}function xo(e,t={}){const{preserveImage:n=!1}=t,r=document.getElementById("previewContent"),i=document.getElementById("exportPreviewHost"),a=function(){const e=document.getElementById("previewContent"),t=document.getElementById("exportPreviewHost");return ci&&t?t:e}();let o,s=a?a.querySelector(".export-preview-overlay"):null;const c=!ci&&a===r,l=++li;if(!s&&i&&r){const e=(a===r?i:r).querySelector(".export-preview-overlay");e&&e.remove()}if(s){o=s.querySelector(".export-preview-content"),ui=!0,qi();let e=s.querySelector(".export-preview-scroll");!e&&o&&(e=document.createElement("div"),e.className="export-preview-scroll",e.innerHTML=o.innerHTML,o.innerHTML="",o.appendChild(e)),yo(e),vo(s)}else{s=document.createElement("div"),s.className="export-preview-overlay";const e=document.createElement("div");e.className="export-preview-header";const t=document.createElement("div");t.className="export-preview-title-row";const n=document.createElement("span");n.className="export-preview-title",n.dataset.baseTitle="Export Preview",n.textContent="Export Preview";const r=document.createElement("span");r.className="export-preview-size",t.appendChild(n),t.appendChild(r);const i=document.createElement("div");i.className="export-preview-header-actions";const l=document.createElement("div");l.className="export-preview-zoom-controls",l.style.display="none";const u=document.createElement("button");u.className="btn export-zoom-btn",u.dataset.zoom="fit",u.textContent="Fit";const d=document.createElement("button");d.className="btn export-zoom-btn",d.dataset.zoom="100",d.textContent="100%";const h=document.createElement("button");h.className="btn export-zoom-btn",h.dataset.zoom="200",h.textContent="200%";const f=document.createElement("button");if(f.className="btn export-zoom-btn",f.dataset.zoom="400",f.textContent="400%",l.appendChild(u),l.appendChild(d),l.appendChild(h),l.appendChild(f),i.appendChild(l),!ci){const e=document.createElement("button");e.className="icon-btn",e.textContent="",e.type="button",e.addEventListener("pointerdown",e=>{e.stopPropagation()}),e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),po(),qi()}),i.appendChild(e)}e.appendChild(t),e.appendChild(i),o=document.createElement("div"),o.className="export-preview-content";const p=document.createElement("div");p.className="export-preview-scroll",o.appendChild(p),s.appendChild(e),s.appendChild(o),a&&(c||(a.innerHTML=""),a.appendChild(s)),ui=!0,qi(),yo(p),vo(s),_o(s,"fit")}if(function(e){if(!mi.blobUrl)return!1;if(mi.imageId!==e.id)return!1;const t=e._lastCropChangeId||0;return mi.cropChangeId===t&&mi.settingsChangeId===pi}(e)){const t=s?.querySelector(".export-preview-scroll");if(t){t.innerHTML="";const n=document.createElement("img");n.src=mi.blobUrl,n.className="export-preview-image",n.dataset.blobUrl=mi.blobUrl,n.draggable=!1,n.onload=()=>{s.classList.remove("loading");const{width:t,height:r}=oa(e);go(s,n,mi.sizeBytes,t,r),wo(s,n),Co()},t.appendChild(n)}return}const u=s?.querySelector(".export-preview-scroll"),d=u?u.querySelector(".export-preview-image"):null,h=mi&&mi.imageId===e.id;if(s&&(s.classList.remove("loading"),s.dataset.requestId=String(l)),s){const e=s.querySelector(".export-preview-size");e&&(e.textContent="",e.style.color="var(--text-secondary)")}d&&n&&h?s.classList.add("loading"):u&&(u.innerHTML='<div style="color: var(--text-secondary);">Processing...</div>');const f=ea(e);Bo(e,{cancelOnChange:!0,snapshot:f,yieldMs:1}).then(t=>{if(!s||s.dataset.requestId!==String(l))return;const r=URL.createObjectURL(t),{width:i,height:a}=oa(e);if(mi={imageId:e.id,cropChangeId:e._lastCropChangeId||0,settingsChangeId:pi,blobUrl:r,sizeBytes:t.size,width:i,height:a},d&&n&&h){const e=d.dataset.blobUrl;e&&URL.revokeObjectURL(e),d.onload=()=>{s&&s.dataset.requestId===String(l)&&(s.classList.remove("loading"),go(s,d,t.size,i,a),wo(s,d),Co())},d.draggable=!1,d.src=r,d.dataset.blobUrl=r}else{const e=document.createElement("img");e.src=r,e.className="export-preview-image",e.dataset.blobUrl=r,e.draggable=!1,e.onload=()=>{s&&s.dataset.requestId===String(l)&&(u&&(u.innerHTML="",u.appendChild(e)),s.classList.remove("loading"),go(s,e,t.size,i,a),wo(s,e),Co())}}}).catch(e=>{if(s&&s.dataset.requestId===String(l)){if(e&&("INTERRUPTED"===e.code||"Interrupted"===e.message))return u&&(u.innerHTML='<div style="color: var(--warning);">Interrupted</div>'),void s.classList.remove("loading");u&&(u.innerHTML=`<div style="color: var(--danger);">Error: ${e.message}</div>`),s.classList.remove("loading")}})}function Eo(e={},t=180,n=null){null!==t&&(null!==n&&(di=n),si&&clearTimeout(si),si=setTimeout(()=>{si=null,null!==n&&(hi=n),function(e={}){if(!ui||!jr)return;if(!document.querySelector(".export-preview-overlay"))return;const t=Or.find(e=>e.id===jr);t&&xo(t,e)}(e)},t))}function Io(){pi+=1,Oi&&Ma()}function ko(e,t){if(!e)return;const n=e.dataset.baseTitle||e.textContent,r=function(e){if(!e||!e.naturalWidth||!e.naturalHeight)return null;const t=e.getBoundingClientRect();if(!t.width||!t.height)return null;const n=Math.min(t.width/e.naturalWidth,t.height/e.naturalHeight);return Math.round(100*n)}(t),i=e.querySelector(".preview-title-text"),a=e.querySelector(".preview-title-zoom");if(i&&a)return i.textContent=n,void(a.textContent=r&&r<100?`[${r}%]`:"");e.textContent=r&&r<100?`${n} [${r}%]`:n}function Co(){ko(document.getElementById("previewTitle"),document.querySelector("#previewWrapper .preview-image"));const e=document.querySelector(".export-preview-title"),t=document.querySelector(".export-preview-image");ko(e,t);const n=document.querySelector(".export-preview-overlay");n&&t&&wo(n,t)}async function zo(){oi||(oi=ue()),await oi}async function Bo(e,t={}){try{const{cancelOnChange:n=!1,snapshot:r,yieldMs:i=0,shouldCancel:a=null}=t,o=r||ea(e);n&&ta(o,e),na(a);const{usePhotonResize:s,jsquashMethod:c,photonSamplingFilter:l}=ia(),u=s?"Photon":"jSquash";console.log(`=== Processing Image with ${u} ===`),console.time("processImage total");const d=Qi(),{width:h,height:f,shouldResize:p,crop:m}=oa(e,d),g=document.getElementById("exportFormat").value;console.log(`Target: ${h}x${f}, Format: ${g}`);const _=e.file;if(!_)throw new Error("No file available to process");const b=m||e.crop;console.log(`Source crop: ${b.width}x${b.height} at (${b.x}, ${b.y})`),console.time("processImage decode");const w=await createImageBitmap(_);console.timeEnd("processImage decode"),i>0&&await ra(i),n&&ta(o,e),na(a),console.time("processImage crop");const y=document.createElement("canvas");y.width=Math.round(b.width),y.height=Math.round(b.height);const v=y.getContext("2d",{alpha:!0});v.drawImage(w,b.x,b.y,b.width,b.height,0,0,y.width,y.height),w.close();const x=v.getImageData(0,0,y.width,y.height);console.timeEnd("processImage crop"),console.log(`Cropped ImageData: ${x.width}x${x.height}`),i>0&&await ra(i),n&&ta(o,e),na(a);let E=x;if(p&&h&&f&&(x.width!==h||x.height!==f)){try{console.time("processImage resize");const e=ji();if("resize"===e||"both"===e)throw new Error("Forced fallback (resize)");s?(E=await async function(e,t,n,r){const i=await Zi();if(!i||"function"!=typeof i.open_image)throw new Error("Photon wasm not loaded");const a=document.createElement("canvas");a.width=e.width,a.height=e.height;const o=a.getContext("2d",{alpha:!0});o.putImageData(e,0,0);const s=i.open_image(a,o),c=Number.isFinite(r)?r:5;if("function"==typeof i.resize){const e=i.resize(s,t,n,c);return i.to_image_data(e)}if("function"==typeof i.resize_img_browser)return i.resize_img_browser(s,t,n,c).getContext("2d",{alpha:!0}).getImageData(0,0,t,n);throw new Error("Photon resize API not available")}(x,h,f,l),console.log("Photon resize complete")):(E=await H(x,{width:h,height:f,method:c||Gr}),console.log("jSquash resize complete")),console.timeEnd("processImage resize")}catch(e){console.timeEnd("processImage resize"),console.warn(`${u} resize failed, falling back to canvas resize`,e),Gi("resize"),console.time("processImage resizeCanvas"),E=function(e,t,n){const r=document.createElement("canvas");r.width=t,r.height=n;const i=r.getContext("2d",{alpha:!0});return i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high",i.drawImage(e,0,0,t,n),i.getImageData(0,0,t,n)}(y,h,f),console.timeEnd("processImage resizeCanvas")}i>0&&await ra(i)}else p?p&&h&&f&&console.log("Resize skipped (already at target size)"):console.log(`Resize skipped (${Qi()})`);i>0&&await ra(i),n&&ta(o,e),na(a);try{const t=Boolean(document.getElementById("enableSharpening")?.checked);let r=E;t?(console.time("processImage sharpen"),r=await async function(e){if(!document.getElementById("enableSharpening").checked)return e;const t=parseInt(document.getElementById("sharpenAmount").value,10)||0,n=parseFloat(document.getElementById("sharpenRadius").value)||1,r=parseInt(document.getElementById("sharpenThreshold").value,10)||0,i=document.getElementById("adaptiveSharpening").checked;let a=t/100;if(a*=Math.max(.3,Math.min(2.5,n)),i){const t=Math.min(e.width,e.height);a*=Math.max(.6,Math.min(1.5,t/1e3))}if(a=Math.max(0,Math.min(2,a)),0===a)return console.log("Sharpening skipped (strength 0)"),e;try{console.log("Sharpening enabled",{amount:t,radius:n,threshold:r,adaptive:i,strength:a});const o=await Zi(),s=document.createElement("canvas");s.width=e.width,s.height=e.height;const c=s.getContext("2d",{alpha:!0});if(c.putImageData(e,0,0),!o||"function"!=typeof o.open_image)throw new Error("Photon wasm not loaded");const l=o.open_image(s,c);o.conv&&"function"==typeof o.conv.sharpen?o.conv.sharpen(l):"function"==typeof o.sharpen&&o.sharpen(l);const u=o.to_image_data(l);return console.log("Sharpening applied"),function(e,t,n,r){const i=e.data,a=t.data||t,o=new Uint8ClampedArray(i.length),s=Math.max(0,Math.min(255,r||0)),c=Math.max(0,Math.min(2,n||0));for(let e=0;e<i.length;e+=4){for(let t=0;t<3;t+=1){const n=i[e+t],r=a[e+t];if(Math.abs(r-n)<s)o[e+t]=n;else{const i=n+(r-n)*c;o[e+t]=Math.max(0,Math.min(255,Math.round(i)))}}o[e+3]=i[e+3]}return new ImageData(o,e.width,e.height)}(e,u,a,r)}catch(t){return console.warn("Sharpening failed, returning original image data.",t),e}}(E),console.timeEnd("processImage sharpen"),i>0&&await ra(i),n&&ta(o,e),na(a)):console.log("Sharpening skipped (disabled)"),console.time("processImage encode");const s=ji();if("encode"===s||"both"===s)throw new Error("Forced fallback (encode)");const{data:c,mimeType:l}=await async function(e,t){switch(t){case"jpeg":return{mimeType:"image/jpeg",data:await Y(e,{quality:parseInt(document.getElementById("jpegQuality").value)})};case"webp":return{mimeType:"image/webp",data:await te(e,{quality:parseInt(document.getElementById("webpQuality").value)})};case"png":await zo();{const t=ce(e.data,e.width,e.height,2,ii,ai);return{mimeType:"image/png",data:t instanceof Uint8Array?t:new Uint8Array(t)}}case"gif":await zo();{const t=ce(e.data,e.width,e.height,2,ii,ai);return{mimeType:"image/png",data:t instanceof Uint8Array?t:new Uint8Array(t)}}default:await zo();{const t=ce(e.data,e.width,e.height,2,ii,ai);return{mimeType:"image/png",data:t instanceof Uint8Array?t:new Uint8Array(t)}}}}(r,g);console.timeEnd("processImage encode");const d=new Blob([c],{type:l});return console.log(`${u} blob created: ${d.size} bytes`),console.log("=== Processing Complete ==="),console.timeEnd("processImage total"),d}catch(e){console.warn(`${u} encode failed, falling back to canvas encoding`,e),Gi("encode"),console.time("processImage encodeFallback");const t=await function(e,t){return new Promise((n,r)=>{const i=document.createElement("canvas");let a,o;switch(i.width=e.width,i.height=e.height,i.getContext("2d",{alpha:!0}).putImageData(e,0,0),t){case"jpeg":o="image/jpeg",a=parseInt(document.getElementById("jpegQuality").value)/100;break;case"webp":o="image/webp",a=parseInt(document.getElementById("webpQuality").value)/100;break;default:o="image/png",a=1}i.toBlob(e=>{e?n(e):r(new Error("Failed to create blob"))},o,a)})}(E,g);return console.timeEnd("processImage encodeFallback"),console.log(`Fallback blob created: ${t.size} bytes`),console.log("=== Processing Complete ==="),console.timeEnd("processImage total"),t}}catch(e){throw console.timeEnd("processImage total"),console.error("Process image error:",e),e}}function So(){const e=document.getElementById("imagesGrid");e&&(e.style.setProperty("--grid-image-size",`${Dr}px`),e.style.gridTemplateColumns=`repeat(auto-fill, minmax(${Dr}px, 1fr))`,Di&&Na())}function Ao(e,t,n){const r=Qi();if(r!==Qr&&r!==Xr)return;if(Ur=e/t,Or.forEach(e=>{e.crop=La(e.width,e.height)}),r===Qr||r===Xr){const e=parseInt(document.getElementById("exportWidth").value,10);if(Number.isFinite(e)&&e>0){const t=Math.round(e/Ur);document.getElementById("exportHeight").value=t}}Yo(0,e,t);const i=document.getElementById("aspectW"),a=document.getElementById("aspectH");i&&a&&(i.value=e,a.value=t),Ha(),Xo({aspectRatio:{width:e,height:t}}),Io(),Do(),Ua(),Eo({preserveImage:!0},Ui(!0))}function Lo(e=!0){const t=document.getElementById("exportFormat").value;document.getElementById("jpegSettings").style.display="jpeg"===t?"block":"none",document.getElementById("pngSettings").style.display="png"===t?"block":"none",document.getElementById("webpSettings").style.display="webp"===t?"block":"none",document.getElementById("gifSettings").style.display="gif"===t?"block":"none",e&&(Xo(),Do()),Io(),Eo({preserveImage:!0},Ui(!0))}function Ro(){document.getElementById("exportBtn").disabled=0===Or.length||Si}function To(){const e=document.getElementById("exportCancelBtn");e&&(e.disabled=!Si||Ai,e.textContent=Ai?"Cancelling...":"Cancel")}function Fo(e){Si=e,document.body.classList.toggle("exporting",e),Ro(),To()}function Mo(){aa(),Xo(),Io(),Eo({preserveImage:!0},Ui(!0))}function Po(){try{const e=localStorage.getItem(Zr);return e?JSON.parse(e):{}}catch(e){return{}}}function No(){const e=Po();return Array.isArray(e.profiles)?e.profiles:[]}function Wo(e){Xo({profiles:e}),$o()}function Oo(){const e=document.getElementById("profileNameDisplay");if(!e)return;bi?(e.textContent=wi?`${bi} (modified)`:bi,e.classList.remove("muted")):(e.textContent="(no profile selected)",e.classList.add("muted"));const t=document.getElementById("profileClearAction"),n=document.getElementById("profileRevertAction");t&&(t.style.display=bi?"inline":"none"),n&&(n.style.display=wi&&vi?"inline":"none")}function Do(){yi||(wi=!0,Oo())}function jo(e,t={}){if(!e)return;const{applyDefaults:n=!1,setProfileName:r=!0,setLastLoaded:i=!0}=t,a=n?function(e){const t={...Fr,...e};return(Fr.aspectRatio||e.aspectRatio)&&(t.aspectRatio={...Fr.aspectRatio||{},...e.aspectRatio||{}}),t}(e):e;let o=a.resizeMode;if(o||"boolean"!=typeof a.lockAspect||(o=a.lockAspect?Qr:Yr),o=o||ri,yi=!0,Number.isFinite(a.exportWidth)&&(document.getElementById("exportWidth").value=a.exportWidth),Number.isFinite(a.exportHeight)&&(document.getElementById("exportHeight").value=a.exportHeight),Number.isFinite(a.scalePercent)){const e=document.getElementById("scalePercent");e&&(e.value=Xi(a.scalePercent))}const s=document.getElementById("resizeMode");if(s&&(s.value=o,s.value||(s.value=ri,o=ri)),a.exportFormat&&(document.getElementById("exportFormat").value=a.exportFormat),Number.isFinite(a.jpegQuality)&&(document.getElementById("jpegQuality").value=a.jpegQuality,document.getElementById("jpegQualityNumber").value=a.jpegQuality),Number.isFinite(a.webpQuality)&&(document.getElementById("webpQuality").value=a.webpQuality,document.getElementById("webpQualityNumber").value=a.webpQuality),"boolean"==typeof a.pngTransparency&&(document.getElementById("pngTransparency").checked=a.pngTransparency),"boolean"==typeof a.enableSharpening&&(document.getElementById("enableSharpening").checked=a.enableSharpening),"boolean"==typeof a.adaptiveSharpening&&(document.getElementById("adaptiveSharpening").checked=a.adaptiveSharpening),Number.isFinite(a.sharpenAmount)&&(document.getElementById("sharpenAmount").value=a.sharpenAmount,document.getElementById("sharpenAmountNumber").value=a.sharpenAmount),Number.isFinite(a.sharpenRadius)&&(document.getElementById("sharpenRadius").value=a.sharpenRadius,document.getElementById("sharpenRadiusNumber").value=a.sharpenRadius),Number.isFinite(a.sharpenThreshold)&&(document.getElementById("sharpenThreshold").value=a.sharpenThreshold,document.getElementById("sharpenThresholdNumber").value=a.sharpenThreshold),a.aspectRatio&&Number.isFinite(a.aspectRatio.width)&&Number.isFinite(a.aspectRatio.height)){Ur=a.aspectRatio.width/a.aspectRatio.height,Yo(0,a.aspectRatio.width,a.aspectRatio.height);const e=document.getElementById("aspectW"),t=document.getElementById("aspectH");e&&t&&(e.value=a.aspectRatio.width,t.value=a.aspectRatio.height)}else{const e=parseInt(document.getElementById("exportWidth").value),t=parseInt(document.getElementById("exportHeight").value);e&&t&&(Ur=e/t,$a())}Ki(o)&&Or.forEach(e=>{e.crop=La(e.width,e.height)}),Lo(!1),Vi(!1),Bi=o,ca(),Xo(),Ji(o)&&Ua(),Io(),Eo({preserveImage:!0},Ui(!0)),bi=r&&a.name||"",wi=!1,vi=i?{...a}:null,Oo(),yi=!1}function Uo(){const e=document.getElementById("profilesList");if(!e)return;const t=No();e.innerHTML="",$o();const n=(e,t)=>{const n=document.createElement("section");n.className="profiles-section "+(t?"expanded":"collapsed");const r=document.createElement("button");r.type="button",r.className="profiles-section-title",r.setAttribute("aria-expanded",t?"true":"false");const i=document.createElement("span");i.className="profiles-section-label",i.textContent=e,r.appendChild(i);const a=document.createElement("span");a.className="profiles-section-chevron",a.textContent="",r.appendChild(a);const o=document.createElement("div");return o.className="profiles-section-body",r.onclick=()=>{const e=n.classList.toggle("expanded");n.classList.toggle("collapsed",!e),r.setAttribute("aria-expanded",e?"true":"false")},n.appendChild(r),n.appendChild(o),{section:n,body:o}},r=(e,t,n)=>{const r=document.createElement("div");r.className="profile-card";const i=document.createElement("div");i.className="profile-info";const a=document.createElement("div");a.className="profile-name",a.textContent=e.name||`Profile ${t+1}`;const o=document.createElement("div");o.className="profile-meta";const s=function(e){if(e.aspectRatio&&e.aspectRatio.width&&e.aspectRatio.height){const t=e.aspectRatio.width,n=e.aspectRatio.height,{arW:r,arH:i}=Nr(t,n,{includePortrait:!1});for(const e of Tr)if(e.w===r&&e.h===i)return e.label||`${e.w}:${e.h}`;return Wr(t,n)}return e.exportWidth&&e.exportHeight?Wr(e.exportWidth,e.exportHeight):""}(e),c=[`${e.exportWidth||""}x${e.exportHeight||""}`.trim(),String(e.exportFormat||"").toUpperCase(),s].filter(Boolean);e.enableSharpening&&c.push("Sharpening"),e.resizeMode===ni&&Number.isFinite(e.scalePercent)&&c.push(`${Xi(e.scalePercent)}%`),o.textContent=c.join("  "),i.appendChild(a),i.appendChild(o);const l=document.createElement("div");l.className="profile-actions";const u=document.createElement("button");if(u.className="btn",u.textContent="Load",u.onclick=()=>{jo(e),_i&&qo()},l.appendChild(u),n){const n=document.createElement("button");n.className="btn",n.textContent="Delete",n.onclick=()=>{const n=e.name||`Profile ${t+1}`;window.confirm(`Delete profile "${n}"?`)&&(Wo(No().filter((e,n)=>n!==t)),Uo())},l.appendChild(n)}return r.appendChild(i),r.appendChild(l),r},i=document.createElement("div");if(i.className="profiles-list",t.length)t.forEach((e,t)=>i.appendChild(r(e,t,!0)));else{const e=document.createElement("div");e.style.color="var(--text-secondary)",e.style.fontSize="12px",e.textContent="No profiles saved yet.",i.appendChild(e)}const a=n("User Profiles",!0);a.body.appendChild(i),e.appendChild(a.section),(Array.isArray(Rr)?[{title:"Default Profiles",profiles:Rr}]:Object.entries(Rr||{}).map(([e,t])=>({title:e,profiles:Array.isArray(t)?t:[]})).filter(e=>e.profiles.length>0)).forEach((t,i)=>{const a=document.createElement("div");a.className="profiles-list",t.profiles.forEach((e,t)=>{const n=r(e,t,!1),i=n.querySelector("button.btn");i&&(i.onclick=()=>{jo(e,{applyDefaults:!0}),_i&&qo()}),a.appendChild(n)});const o=n(t.title||`Profiles ${i+1}`,!1);o.body.appendChild(a),e.appendChild(o.section)})}function $o(){const e=document.getElementById("exportProfilesBtn");if(!e)return;const t=No();e.disabled=!t.length}function Ho(e){return e&&"object"==typeof e?"string"!=typeof e.name?"":e.name.trim():""}function qo(){_i=!_i;const e=document.getElementById("profilesPanel"),t=document.getElementById("openProfilesBtn"),n=document.getElementById("loadProfileBtn");e&&e.classList.toggle("active",_i),ja(),t&&(t.textContent=_i?"Back to Images":"Open Profiles",t.classList.toggle("active",_i)),n&&(n.textContent=_i?"Back to images":"Load Profile",n.classList.toggle("active",_i)),_i&&Uo(),Pa()}function Zo(e,t,n=e=>Number(e)){const r=document.getElementById(e),i=document.getElementById(t);if(!r||!i)return;const a=Number(r.min),o=Number(r.max),s=()=>{i.value=r.value};r.addEventListener("input",()=>{s()}),i.addEventListener("input",()=>{(()=>{const e=n(i.value);if(!Number.isFinite(e))return;const t=(s=e,Math.min(o,Math.max(a,s)));var s;r.value=t,i.value=t})()}),s()}function Go(e){Li=e}function Qo(){Go(!1)}function Xo(e={}){const t=Po(),n=ia(),r=document.getElementById("exportWidth"),i=document.getElementById("exportHeight"),a=parseInt(r?.value),o=parseInt(i?.value),s=parseInt(r?.dataset.stashedValue),c=parseInt(i?.dataset.stashedValue),l={...t,exportWidth:Number.isFinite(a)?a:Number.isFinite(s)?s:null,exportHeight:Number.isFinite(o)?o:Number.isFinite(c)?c:null,scalePercent:Yi(),resizeMode:Qi(),exportFormat:document.getElementById("exportFormat").value,jpegQuality:parseInt(document.getElementById("jpegQuality").value),webpQuality:parseInt(document.getElementById("webpQuality").value),pngTransparency:document.getElementById("pngTransparency").checked,previewDelay:document.getElementById("previewDelay").value,lightMode:document.body.classList.contains("light"),lastExportPreviewMode:xi,showAboutOnLoad:document.getElementById("aboutAutoShow").checked,enableSharpening:document.getElementById("enableSharpening").checked,adaptiveSharpening:document.getElementById("adaptiveSharpening").checked,sharpenAmount:parseInt(document.getElementById("sharpenAmount").value),sharpenRadius:parseFloat(document.getElementById("sharpenRadius").value),sharpenThreshold:parseInt(document.getElementById("sharpenThreshold").value),resizeEngine:n.engine,usePhotonResize:n.usePhotonResize,jsquashResizeMethod:n.jsquashMethod,photonSamplingFilter:n.photonSamplingFilter,showGridSizeInfo:Oi,showFilenameTip:Di,gridItemSize:Dr,...e};localStorage.setItem(Zr,JSON.stringify(l)),Ri||Go(!0)}function Yo(e,t,n){const r=document.getElementById("aspectPresetSelect");if(!r)return;const i=Array.from(r.options).find(e=>{const r=parseInt(e.dataset.aspectW),i=parseInt(e.dataset.aspectH);return r===t&&i===n});r.value=i?i.value:""}function Vo(){const e=Po(),t=document.getElementById("aboutAutoShow");"boolean"==typeof e.showAboutOnLoad?t.checked=e.showAboutOnLoad:t.checked=!0}ha.addEventListener("mousedown",e=>{Ea()&&($r=!0,Hr=e.clientX,qr=fa.offsetWidth,ha.classList.add("resizing"),document.body.classList.add("resizing"),e.preventDefault())}),ha.addEventListener("pointerdown",e=>{"mouse"!==e.pointerType&&Ea()&&($r=!0,Hr=e.clientX,qr=fa.offsetWidth,ha.classList.add("resizing"),document.body.classList.add("resizing"),ha.setPointerCapture&&ha.setPointerCapture(e.pointerId),e.preventDefault())}),document.addEventListener("mousemove",e=>{if(!$r)return;if(!Ea())return $r=!1,ha.classList.remove("resizing"),void document.body.classList.remove("resizing");const t=e.clientX-Hr,n=xa(qr+t);fa.style.flex=`0 0 ${n}px`,Co(),ci&&Va()}),document.addEventListener("pointermove",e=>{if("mouse"===e.pointerType)return;if(!$r)return;if(!Ea())return $r=!1,ha.classList.remove("resizing"),void document.body.classList.remove("resizing");const t=e.clientX-Hr,n=xa(qr+t);fa.style.flex=`0 0 ${n}px`,Co(),ci&&Va()}),document.addEventListener("mouseup",()=>{$r&&($r=!1,ha.classList.remove("resizing"),document.body.classList.remove("resizing"),Co(),ci&&Va())}),document.addEventListener("pointerup",e=>{"mouse"!==e.pointerType&&$r&&($r=!1,ha.classList.remove("resizing"),document.body.classList.remove("resizing"),Co(),ci&&Va())}),window.addEventListener("resize",()=>{if(!Ea()||!fa)return;const e=fa.getBoundingClientRect().width,t=xa(e);Math.abs(t-e)>1&&(fa.style.flex=`0 0 ${t}px`),Co(),ci&&Va()}),pa&&(pa.addEventListener("mousedown",e=>{ga&&ma&&ka()&&(_a=!0,"vertical"===zi?(ba=e.clientY,wa=ma.getBoundingClientRect().height,document.body.classList.add("resizing-vertical")):(ba=e.clientX,wa=ma.getBoundingClientRect().width,document.body.classList.add("resizing")),pa.classList.add("resizing"),e.preventDefault())}),pa.addEventListener("pointerdown",e=>{"mouse"!==e.pointerType&&ga&&ma&&ka()&&(_a=!0,"vertical"===zi?(ba=e.clientY,wa=ma.getBoundingClientRect().height,document.body.classList.add("resizing-vertical")):(ba=e.clientX,wa=ma.getBoundingClientRect().width,document.body.classList.add("resizing")),pa.classList.add("resizing"),pa.setPointerCapture&&pa.setPointerCapture(e.pointerId),e.preventDefault())})),document.addEventListener("mousemove",e=>{if(!_a||!ga||!ma)return;if(!ka())return _a=!1,pa?.classList.remove("resizing"),document.body.classList.remove("resizing"),void document.body.classList.remove("resizing-vertical");const t=Xa();if("vertical"===zi){const n=e.clientY-ba,r=va(ga.getBoundingClientRect().height,pa?pa.getBoundingClientRect().height:6);let i=wa+n;i=Math.max(r.min,Math.min(r.max,i)),ma.style.flex=`0 0 ${i}px`,t?Ci=i:Ii=i}else{const n=e.clientX-ba,r=va(ga.getBoundingClientRect().width,pa?pa.getBoundingClientRect().width:6);let i=wa+n;i=Math.max(r.min,Math.min(r.max,i)),ma.style.flex=`0 0 ${i}px`,t?ki=i:Ei=i}Co()}),document.addEventListener("pointermove",e=>{if("mouse"===e.pointerType)return;if(!_a||!ga||!ma)return;if(!ka())return _a=!1,pa?.classList.remove("resizing"),document.body.classList.remove("resizing"),void document.body.classList.remove("resizing-vertical");const t=Xa();if("vertical"===zi){const n=e.clientY-ba,r=va(ga.getBoundingClientRect().height,pa?pa.getBoundingClientRect().height:6);let i=wa+n;i=Math.max(r.min,Math.min(r.max,i)),ma.style.flex=`0 0 ${i}px`,t?Ci=i:Ii=i}else{const n=e.clientX-ba,r=va(ga.getBoundingClientRect().width,pa?pa.getBoundingClientRect().width:6);let i=wa+n;i=Math.max(r.min,Math.min(r.max,i)),ma.style.flex=`0 0 ${i}px`,t?ki=i:Ei=i}Co()}),document.addEventListener("mouseup",()=>{_a&&(_a=!1,pa?.classList.remove("resizing"),document.body.classList.remove("resizing"),document.body.classList.remove("resizing-vertical"),Co())}),document.addEventListener("pointerup",e=>{"mouse"!==e.pointerType&&_a&&(_a=!1,pa?.classList.remove("resizing"),document.body.classList.remove("resizing"),document.body.classList.remove("resizing-vertical"),Co())}),document.addEventListener("fullscreenchange",()=>{const e=document.getElementById("previewPane"),t=e&&document.fullscreenElement===e;if(Fi=Boolean(t),!t&&Pi){const e=Pi;return Pi=null,void uo(Boolean(e.skipSplitReset))}!t&&Ti&&window.innerWidth<ya&&e?.classList.contains("active")?ho():(t?(document.body.classList.remove("preview-fullscreen"),Mi=!0,ki=null,Ci=null):document.body.classList.remove("preview-fullscreen"),Qa(),requestAnimationFrame(()=>{Va(),t&&Ya(!0),Co()}))}),document.getElementById("exportWidth").addEventListener("input",()=>{const e=Qi();if(e===Qr){const e=parseInt(document.getElementById("exportWidth").value),t=Math.round(e/Ur);document.getElementById("exportHeight").value=t}else e===Yr&&($a(),qa());Ha(),Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0))}),document.getElementById("exportHeight").addEventListener("input",()=>{const e=Qi();if(e===Qr){const e=parseInt(document.getElementById("exportHeight").value),t=Math.round(e*Ur);document.getElementById("exportWidth").value=t}else e===Yr&&($a(),qa());Ha(),Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0))}),document.getElementById("jpegQuality").addEventListener("input",()=>{Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0))}),document.getElementById("jpegQualityNumber").addEventListener("input",()=>{Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0))}),document.getElementById("webpQuality").addEventListener("input",()=>{Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0))}),document.getElementById("webpQualityNumber").addEventListener("input",()=>{Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0))}),document.getElementById("pngTransparency").addEventListener("change",()=>{Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0))}),document.getElementById("previewDelay").addEventListener("change",()=>{Xo()}),document.getElementById("resizeMode").addEventListener("change",function(){ca(),Wa(),so(),Xo(),Do(),Io(),Eo({preserveImage:!0},Ui(!0))}),document.getElementById("resizeEngine").addEventListener("change",Mo),document.getElementById("jsquashResizeMethod").addEventListener("change",Mo),document.getElementById("photonResizeFilter").addEventListener("change",Mo),document.getElementById("scalePercent").addEventListener("input",()=>{Vi(!0)}),document.getElementById("aspectW").addEventListener("input",Za),document.getElementById("aspectH").addEventListener("input",Za),document.getElementById("aboutAutoShow").addEventListener("change",Xo),document.getElementById("enableSharpening").addEventListener("change",()=>{Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0))}),document.getElementById("adaptiveSharpening").addEventListener("change",()=>{Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0))}),document.getElementById("sharpenAmount").addEventListener("input",()=>{Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0))}),document.getElementById("sharpenRadius").addEventListener("input",()=>{Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0))}),document.getElementById("sharpenThreshold").addEventListener("input",()=>{Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0))}),document.getElementById("sharpenAmountNumber").addEventListener("input",()=>{Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0))}),document.getElementById("previewFooter").addEventListener("click",e=>{const t=e.target.closest("button[data-crop-action]");if(!t)return;e.preventDefault();const n=e.shiftKey?10:1;!function(e,t){if(!jr)return;if(!Ji())return;const n=Or.find(e=>e.id===jr);if(!n||!n.crop)return;const r=Ki()?Ur:null;let i={...{...n.crop}};switch(e){case"up":i.y-=t,i=ao(i,n);break;case"down":i.y+=t,i=ao(i,n);break;case"left":i.x-=t,i=ao(i,n);break;case"right":i.x+=t,i=ao(i,n);break;case"grow":i=oo(n,1,t,r);break;case"shrink":i=oo(n,-1,t,r);break;default:return}!function(e,t){if(!e||!t)return;e.crop=t;const n=++fi;e._lastCropChangeId=n,ro(e),io(e),Eo({preserveImage:!0},Hi(),n)}(n,i)}(t.dataset.cropAction,n)}),document.getElementById("filenameTipDismiss").addEventListener("click",e=>{e.preventDefault(),Di=!1,Xo({showFilenameTip:!1}),Pa()}),document.getElementById("gridContainer").addEventListener("scroll",()=>{Di&&Na()}),window.addEventListener("resize",()=>{Di&&Na()}),document.getElementById("profileImportInput").addEventListener("change",async e=>{const t=e.target,n=t?.files?.[0];if(n)try{const e=await n.text(),t=JSON.parse(e);if(!Array.isArray(t))return void window.alert("Invalid profiles JSON. Expected an array of profiles.");const r=t.filter(e=>e&&"object"==typeof e);if(!r.length)return void window.alert("No valid profiles found in the JSON.");const i=No(),a=function(e,t){const n=new Set,r=new Set,i=new Set(t.map(Ho).filter(Boolean));return e.forEach(e=>{const t=Ho(e);t&&((r.has(t)||i.has(t))&&n.add(t),r.add(t))}),Array.from(n)}(r,i);if(a.length){const e=`Duplicate profile names detected:\n${a.join(", ")}\n\nIf you continue, the current profiles will be overridden.`;if(!window.confirm(e))return}const o=function(e,t){const n=[...t],r=new Map;return n.forEach((e,t)=>{const n=Ho(e);n&&r.set(n,t)}),e.forEach(e=>{if(!e||"object"!=typeof e)return;const t=Ho(e);t&&r.has(t)?n[r.get(t)]=e:(n.push(e),t&&r.set(t,n.length-1))}),n}(r,i);Wo(o),_i&&Uo()}catch(e){console.error("Profile import failed",e),window.alert("Failed to import profiles. Please check the file and try again.")}finally{t.value=""}}),document.getElementById("sharpenRadiusNumber").addEventListener("input",()=>{Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0))}),document.getElementById("sharpenThresholdNumber").addEventListener("input",()=>{Xo(),Io(),Do(),Eo({preserveImage:!0},Ui(!0))}),window.addEventListener("resize",Co),Zo("jpegQuality","jpegQualityNumber",e=>parseInt(e,10)),Zo("webpQuality","webpQualityNumber",e=>parseInt(e,10)),Zo("sharpenAmount","sharpenAmountNumber",e=>parseInt(e,10)),Zo("sharpenRadius","sharpenRadiusNumber",e=>parseFloat(e)),Zo("sharpenThreshold","sharpenThresholdNumber",e=>parseInt(e,10)),Object.assign(window,{openAbout:za,openFiles:Ca,openFilesFromHeader:function(){_i&&qo(),Ca()},exportImages:async function(){if(Si||0===Or.length)return;Ai=!1,Fo(!0);const e=1===Or.length,t=e?null:new(n()),r=document.getElementById("exportFormat").value,i=document.getElementById("exportProgress"),a=document.getElementById("exportProgressBar"),o=document.getElementById("exportProgressText");let s=0,c=null,l="";i&&i.classList.add("active"),a&&(a.style.width="0%"),o&&(o.textContent=`Processing Image 1/${Or.length}`);try{for(let n=0;n<Or.length;n++){Ai&&na(()=>!0);const i=Or[n],u=await Bo(i,{cancelOnChange:!1,shouldCancel:()=>Ai,yieldMs:1}),d=`${i.name.replace(/\.[^/.]+$/,"")}.${r}`;e?(c=u,l=d):t.file(d,u),s+=1,a&&(a.style.width=`${Math.round((n+1)/Or.length*100)}%`),o&&(o.textContent=`Processing Image ${n+1}/${Or.length}`)}Ai&&na(()=>!0),o&&(o.textContent="Preparing download...");const n=e?c:await t.generateAsync({type:"blob"}),i=URL.createObjectURL(n),u=document.createElement("a");u.href=i,u.download=e?l:"processed-images.zip",u.click(),URL.revokeObjectURL(i),Qo(),a&&(a.style.width="100%")}catch(n){if("CANCELLED"===n?.code)if(e)o&&(o.textContent="Export cancelled"),a&&(a.style.width="0%");else if(s>0)if(window.confirm("Download images produced so far?")){o&&(o.textContent="Preparing download...");const e=await t.generateAsync({type:"blob"}),n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download="processed-images-partial.zip",r.click(),URL.revokeObjectURL(n),a&&(a.style.width="100%")}else o&&(o.textContent="Export cancelled"),a&&(a.style.width="0%");else o&&(o.textContent="Export cancelled"),a&&(a.style.width="0%");else console.error("Export failed:",n),o&&(o.textContent="Export failed")}finally{Ai=!1,Fo(!1),i&&setTimeout(()=>{i.classList.remove("active"),a&&(a.style.width="0%"),o&&(o.textContent="")},400)}},cancelExport:function(){if(!Si)return;Ai=!0,To();const e=document.getElementById("exportProgressText");e&&(e.textContent="Cancelling...")},clearAllImages:function(){Or=[],jr=null,po(),ho(),Ra(),Ro(),la&&la.classList.remove("hidden"),ja(),fo(),Go(!0)},toggleDrawer:function(){const e=document.getElementById("drawer"),t=document.getElementById("drawerToggleIcon");e.classList.toggle("collapsed"),t.textContent=e.classList.contains("collapsed")?"":""},setAspectRatio:Ao,updateFormatSettings:Lo,adjustZoom:function(e){const t=e>=0?1:-1;Dr=Math.max(160,Math.min(800,Dr+40*t)),So(),Xo({gridItemSize:Dr})},resetZoom:function(){Dr=240,So(),Xo({gridItemSize:Dr})},setScalePercentPreset:function(e){const t=document.getElementById("scalePercent");t&&(t.value=Xi(e),Vi(!0))},toggleTheme:function(){const e=document.getElementById("themeToggle")?.checked;document.documentElement.classList.toggle("light",Boolean(e)),document.body.classList.toggle("light",Boolean(e)),Xo()},toggleGridInfo:function(){Oi=!Oi,Xo({showGridSizeInfo:Oi}),Ma()},alignAllCrops:function(e){Or.forEach(t=>{switch(e){case"top":t.crop.y=0;break;case"middle":t.crop.y=(t.height-t.crop.height)/2;break;case"bottom":t.crop.y=t.height-t.crop.height}}),Ua()},toggleSplitPreview:function(){Ja(ci?"single":"split-horizontal")},setPreviewLayout:Ja,togglePreviewFullscreen:eo,closePreview:ho,testExport:function(){if(jr)return ui&&!ci?(po(),xi="none",void qi()):(xo(Or.find(e=>e.id===jr)),xi="full",void qi())},toggleProfiles:qo,saveProfile:function(){const e=function(){const e=document.getElementById("exportWidth").value,t=document.getElementById("exportHeight").value,n=Yi(),r=document.getElementById("exportFormat").value.toUpperCase(),i=Qi(),a=parseFloat(document.getElementById("aspectW").value),o=parseFloat(document.getElementById("aspectH").value),s=Number.isFinite(a)&&Number.isFinite(o)&&o>0;let c="";(i===Qr||i===Yr)&&e&&t?c=`${e}:${t}`:i===Xr&&s&&(c=`${a}:${o}`);const l=[];return i===ni?l.push(`${n}%`):e&&t&&i!==Xr&&l.push(`${e}x${t}`),c&&l.push(`${c}`),l.push(r),l.join(" ")}(),t=bi||e,n=window.prompt("Profile name",t);if(null===n)return;const r=n.trim()||bi||e,i={name:r,exportWidth:parseInt(document.getElementById("exportWidth").value),exportHeight:parseInt(document.getElementById("exportHeight").value),scalePercent:Yi(),resizeMode:Qi(),aspectRatio:{width:1e3*Ur,height:1e3},exportFormat:document.getElementById("exportFormat").value,jpegQuality:parseInt(document.getElementById("jpegQuality").value),webpQuality:parseInt(document.getElementById("webpQuality").value),pngTransparency:document.getElementById("pngTransparency").checked,enableSharpening:document.getElementById("enableSharpening").checked,adaptiveSharpening:document.getElementById("adaptiveSharpening").checked,sharpenAmount:parseInt(document.getElementById("sharpenAmount").value),sharpenRadius:parseFloat(document.getElementById("sharpenRadius").value),sharpenThreshold:parseInt(document.getElementById("sharpenThreshold").value)},a=No(),o=a.findIndex(e=>e.name===r);if(-1!==o){if(!window.confirm(`Profile "${r}" exists. Overwrite it?`))return;a.splice(o,1,i)}else a.push(i);Wo(a),bi=r,wi=!1,vi={...i},Oo(),_i&&Uo()},clearProfileName:function(){bi="",wi=!1,Oo()},revertProfileSettings:function(){vi&&jo(vi)},resetProfileToDefault:function(){jo(Fr,{applyDefaults:!0,setProfileName:!1,setLastLoaded:!1})},resetPreferences:function(){const e=No();localStorage.removeItem(Zr),yi=!0;const t=Number.isFinite(Fr.exportWidth)?Fr.exportWidth:1920,n=Number.isFinite(Fr.exportHeight)?Fr.exportHeight:1080,r=Fr.aspectRatio&&Number.isFinite(Fr.aspectRatio.width)&&Number.isFinite(Fr.aspectRatio.height)?Fr.aspectRatio:{width:t,height:n};document.getElementById("exportWidth").value=t,document.getElementById("exportHeight").value=n;const i=document.getElementById("resizeMode");i&&(i.value=Fr.resizeMode||ri,i.value||(i.value=ri)),document.getElementById("exportFormat").value=Fr.exportFormat||"jpeg",document.getElementById("jpegQuality").value=Number.isFinite(Fr.jpegQuality)?Fr.jpegQuality:90,document.getElementById("webpQuality").value=Number.isFinite(Fr.webpQuality)?Fr.webpQuality:90,document.getElementById("jpegQualityNumber").value=Number.isFinite(Fr.jpegQuality)?Fr.jpegQuality:90,document.getElementById("webpQualityNumber").value=Number.isFinite(Fr.webpQuality)?Fr.webpQuality:90,document.getElementById("pngTransparency").checked="boolean"!=typeof Fr.pngTransparency||Fr.pngTransparency,document.getElementById("previewDelay").value="0.5",document.getElementById("aboutAutoShow").checked=!0,document.getElementById("enableSharpening").checked="boolean"==typeof Fr.enableSharpening&&Fr.enableSharpening,document.getElementById("adaptiveSharpening").checked="boolean"==typeof Fr.adaptiveSharpening&&Fr.adaptiveSharpening,document.getElementById("sharpenAmount").value=Number.isFinite(Fr.sharpenAmount)?Fr.sharpenAmount:120,document.getElementById("sharpenRadius").value=Number.isFinite(Fr.sharpenRadius)?Fr.sharpenRadius:1,document.getElementById("sharpenThreshold").value=Number.isFinite(Fr.sharpenThreshold)?Fr.sharpenThreshold:10,document.getElementById("sharpenAmountNumber").value=Number.isFinite(Fr.sharpenAmount)?Fr.sharpenAmount:120,document.getElementById("sharpenRadiusNumber").value=Number.isFinite(Fr.sharpenRadius)?Fr.sharpenRadius:1,document.getElementById("sharpenThresholdNumber").value=Number.isFinite(Fr.sharpenThreshold)?Fr.sharpenThreshold:10;const a=document.getElementById("resizeEngine");a&&(a.value="jsquash");const o=document.getElementById("jsquashResizeMethod");o&&(o.value=Gr);const s=document.getElementById("photonResizeFilter");s&&(s.value=String(5));const c=document.getElementById("scalePercent");if(c){const e=Number.isFinite(Fr.scalePercent)?Fr.scalePercent:100;c.value=Xi(e)}const l=document.getElementById("aspectW"),u=document.getElementById("aspectH");l&&u&&(l.value=r.width,u.value=r.height);const d=document.getElementById("themeToggle");d&&(d.checked=!1),Oi=!1,Di=!0,Dr=240,Ma(),document.documentElement.classList.remove("light"),document.body.classList.remove("light"),Ur=r.width/r.height,Yo(0,r.width,r.height),Lo(!1),aa(),ca(),Xo({aspectRatio:{width:r.width,height:r.height},showGridSizeInfo:!1,showFilenameTip:!0,gridItemSize:240,profiles:e}),bi="",wi=!1,vi=null,xi="none",yi=!1,Oo()},exportUserProfiles:function(){const e=No();if(!e.length)return;const t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download="batch-image-profiles.json",document.body.appendChild(i),i.click(),i.remove(),URL.revokeObjectURL(r)},importUserProfiles:function(){const e=document.getElementById("profileImportInput");e&&(e.value="",e.click())},closeAbout:Ba,openChangelog:function(){Ba(),document.getElementById("changelogModal").classList.add("active")},closeChangelog:Sa,closeMobileWarning:function(){const e=document.getElementById("mobileWarning");e&&e.remove();const t=Ri;Ri=!0,Xo({mobileWarningDismissed:!0}),Ri=t},closeExportPreview:po}),function(){const e=document.getElementById("aspectPresetSelect");if(!e)return;e.innerHTML="";const t=document.createElement("option");t.value="",t.textContent="Select preset",e.appendChild(t),Tr.slice(0,30).forEach(t=>{const n=document.createElement("option");n.value=`${t.w}:${t.h}`,n.dataset.aspectW=t.w,n.dataset.aspectH=t.h,n.textContent=t.label||`${t.w}:${t.h}`,e.appendChild(n)}),e.addEventListener("change",()=>{const t=e.selectedOptions[0];t&&t.dataset.aspectW&&t.dataset.aspectH&&Ao(parseInt(t.dataset.aspectW),parseInt(t.dataset.aspectH))})}(),function(){const e=Po(),t=document.getElementById("mobileWarning");if(t&&(e.mobileWarningDismissed?t.remove():t.classList.remove("hidden")),document.documentElement.classList.add("no-theme-transition"),yi=!0,Number.isFinite(e.exportWidth)&&(document.getElementById("exportWidth").value=e.exportWidth),Number.isFinite(e.exportHeight)&&(document.getElementById("exportHeight").value=e.exportHeight),Number.isFinite(e.scalePercent)){const t=document.getElementById("scalePercent");t&&(t.value=Xi(e.scalePercent))}let n=e.resizeMode;n||"boolean"!=typeof e.lockAspect||(n=e.lockAspect?Qr:Yr),n=n||ri;const r=document.getElementById("resizeMode");r&&(r.value=n,r.value||(r.value=ri)),e.exportFormat&&(document.getElementById("exportFormat").value=e.exportFormat),Number.isFinite(e.jpegQuality)&&(document.getElementById("jpegQuality").value=e.jpegQuality,document.getElementById("jpegQualityNumber").value=e.jpegQuality),Number.isFinite(e.webpQuality)&&(document.getElementById("webpQuality").value=e.webpQuality,document.getElementById("webpQualityNumber").value=e.webpQuality),"boolean"==typeof e.pngTransparency&&(document.getElementById("pngTransparency").checked=e.pngTransparency),e.previewDelay?document.getElementById("previewDelay").value=e.previewDelay:document.getElementById("previewDelay").value="0.5",Oi=Boolean(e.showGridSizeInfo),Di=!1!==e.showFilenameTip,Number.isFinite(e.gridItemSize)&&(Dr=Math.max(160,Math.min(800,Math.round(e.gridItemSize)))),e.lastExportPreviewMode&&(xi=e.lastExportPreviewMode,"split"===xi&&(xi="split-horizontal")),"boolean"==typeof e.enableSharpening&&(document.getElementById("enableSharpening").checked=e.enableSharpening),"boolean"==typeof e.adaptiveSharpening&&(document.getElementById("adaptiveSharpening").checked=e.adaptiveSharpening),Number.isFinite(e.sharpenAmount)&&(document.getElementById("sharpenAmount").value=e.sharpenAmount,document.getElementById("sharpenAmountNumber").value=e.sharpenAmount),Number.isFinite(e.sharpenRadius)&&(document.getElementById("sharpenRadius").value=e.sharpenRadius,document.getElementById("sharpenRadiusNumber").value=e.sharpenRadius),Number.isFinite(e.sharpenThreshold)&&(document.getElementById("sharpenThreshold").value=e.sharpenThreshold,document.getElementById("sharpenThresholdNumber").value=e.sharpenThreshold);let i=e.resizeEngine;i||(i="boolean"==typeof e.usePhotonResize&&e.usePhotonResize?"photon":"jsquash");const a=document.getElementById("resizeEngine");a&&(a.value=i,a.value||(a.value="jsquash"));const o=document.getElementById("jsquashResizeMethod");if(o){const t=e.jsquashResizeMethod||Gr;o.value=t,o.value||(o.value=Gr)}const s=document.getElementById("photonResizeFilter");if(s){const t=Number.isFinite(e.photonSamplingFilter)?String(Math.min(5,Math.max(1,e.photonSamplingFilter))):String(5);s.value=t,s.value||(s.value=String(5))}if(e.aspectRatio&&Number.isFinite(e.aspectRatio.width)&&Number.isFinite(e.aspectRatio.height)){Ur=e.aspectRatio.width/e.aspectRatio.height,Yo(0,e.aspectRatio.width,e.aspectRatio.height);const t=document.getElementById("aspectW"),n=document.getElementById("aspectH");t&&n&&(t.value=e.aspectRatio.width,n.value=e.aspectRatio.height)}else{const e=parseInt(document.getElementById("exportWidth").value),t=parseInt(document.getElementById("exportHeight").value);e&&t&&(Ur=e/t,$a())}if(Qi()===Yr){const e=parseInt(document.getElementById("exportWidth").value),t=parseInt(document.getElementById("exportHeight").value);Number.isFinite(e)&&Number.isFinite(t)&&t>0&&(Ur=e/t,$a())}if(Lo(!1),aa(),ca(),Vo(),"boolean"==typeof e.lightMode){document.documentElement.classList.toggle("light",e.lightMode),document.body.classList.toggle("light",e.lightMode);const t=document.getElementById("themeToggle");t&&(t.checked=e.lightMode)}requestAnimationFrame(()=>{document.documentElement.classList.remove("no-theme-transition")}),yi=!1,Oo(),Ma(),$o(),Wa(),Pa(),So(),so()}(),Ga(),Qa(),qi(),Ia(),function(){const e=Po();return"boolean"!=typeof e.showAboutOnLoad||e.showAboutOnLoad}()&&za(),Oo(),Ri=!1,Qo(),document.body.classList.remove("app-initializing")})()})();
//# sourceMappingURL=main.js.map
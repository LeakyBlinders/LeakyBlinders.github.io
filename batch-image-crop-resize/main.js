/*! For license information please see main.js.LICENSE.txt */
(()=>{var e,t,n={710(e,t,n){e.exports=function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){return i(t[o][1][e]||e)},c,c.exports,e,t,n,r)}return n[o].exports}for(var a=void 0,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,i,o,s,l,c,u=[],d=0,h=e.length,p=h,f="string"!==r.getTypeOf(e);d<e.length;)p=h-d,i=f?(t=e[d++],n=d<h?e[d++]:0,d<h?e[d++]:0):(t=e.charCodeAt(d++),n=d<h?e.charCodeAt(d++):0,d<h?e.charCodeAt(d++):0),o=t>>2,s=(3&t)<<4|n>>4,l=1<p?(15&n)<<2|i>>6:64,c=2<p?63&i:64,u.push(a.charAt(o)+a.charAt(s)+a.charAt(l)+a.charAt(c));return u.join("")},n.decode=function(e){var t,n,r,o,s,l,c=0,u=0,d="data:";if(e.substr(0,5)===d)throw new Error("Invalid base64 input, it looks like a data url.");var h,p=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&p--,e.charAt(e.length-2)===a.charAt(64)&&p--,p%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=i.uint8array?new Uint8Array(0|p):new Array(0|p);c<e.length;)t=a.indexOf(e.charAt(c++))<<2|(o=a.indexOf(e.charAt(c++)))>>4,n=(15&o)<<4|(s=a.indexOf(e.charAt(c++)))>>2,r=(3&s)<<6|(l=a.indexOf(e.charAt(c++))),h[u++]=t,64!==s&&(h[u++]=n),64!==l&&(h[u++]=r);return h}},{"./support":30,"./utils":32}],2:[function(e,t,n){"use strict";var r=e("./external"),i=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),o=e("./stream/DataLengthProbe");function s(e,t,n,r,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=i}s.prototype={getContentWorker:function(){var e=new i(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new i(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,n){return e.pipe(new a).pipe(new o("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){"use strict";var r=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){"use strict";var r=e("./utils"),i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==r.getTypeOf(e)?function(e,t,n){var r=i,a=0+n;e^=-1;for(var o=0;o<a;o++)e=e>>>8^r[255&(e^t[o])];return-1^e}(0|t,e,e.length):function(e,t,n){var r=i,a=0+n;e^=-1;for(var o=0;o<a;o++)e=e>>>8^r[255&(e^t.charCodeAt(o))];return-1^e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){"use strict";var r;r="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:r}},{lie:37}],7:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako"),a=e("./utils"),o=e("./stream/GenericWorker"),s=r?"uint8array":"array";function l(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",a.inherits(l,o),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(a.transformTo(s,e.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new l("Deflate",e)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){"use strict";function r(e,t){var n,r="";for(n=0;n<t;n++)r+=String.fromCharCode(255&e),e>>>=8;return r}function i(e,t,n,i,o,u){var d,h,p=e.file,f=e.compression,m=u!==s.utf8encode,g=a.transformTo("string",u(p.name)),_=a.transformTo("string",s.utf8encode(p.name)),w=p.comment,b=a.transformTo("string",u(w)),y=a.transformTo("string",s.utf8encode(w)),v=_.length!==p.name.length,x=y.length!==w.length,E="",I="",k="",C=p.dir,B=p.date,z={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(z.crc32=e.crc32,z.compressedSize=e.compressedSize,z.uncompressedSize=e.uncompressedSize);var S=0;t&&(S|=8),m||!v&&!x||(S|=2048);var A=0,L=0;C&&(A|=16),"UNIX"===o?(L=798,A|=function(e,t){var n=e;return e||(n=t?16893:33204),(65535&n)<<16}(p.unixPermissions,C)):(L=20,A|=function(e){return 63&(e||0)}(p.dosPermissions)),d=B.getUTCHours(),d<<=6,d|=B.getUTCMinutes(),d<<=5,d|=B.getUTCSeconds()/2,h=B.getUTCFullYear()-1980,h<<=4,h|=B.getUTCMonth()+1,h<<=5,h|=B.getUTCDate(),v&&(I=r(1,1)+r(l(g),4)+_,E+="up"+r(I.length,2)+I),x&&(k=r(1,1)+r(l(b),4)+y,E+="uc"+r(k.length,2)+k);var R="";return R+="\n\0",R+=r(S,2),R+=f.magic,R+=r(d,2),R+=r(h,2),R+=r(z.crc32,4),R+=r(z.compressedSize,4),R+=r(z.uncompressedSize,4),R+=r(g.length,2),R+=r(E.length,2),{fileRecord:c.LOCAL_FILE_HEADER+R+g+E,dirRecord:c.CENTRAL_FILE_HEADER+r(L,2)+R+r(b.length,2)+"\0\0\0\0"+r(A,4)+r(i,4)+g+E+b}}var a=e("../utils"),o=e("../stream/GenericWorker"),s=e("../utf8"),l=e("../crc32"),c=e("../signature");function u(e,t,n,r){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(u,o),u.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-r-1))/n:100}}))},u.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=i(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=i(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:function(e){return c.DATA_DESCRIPTOR+r(e.crc32,4)+r(e.compressedSize,4)+r(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,i=function(e,t,n,i,o){var s=a.transformTo("string",o(i));return c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(e,2)+r(e,2)+r(t,4)+r(n,4)+r(s.length,2)+s}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},u.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(e){var t=this._sources;if(!o.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},u.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){"use strict";var r=e("../compressions"),i=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var a=new i(t.streamFiles,n,t.platform,t.encodeFileName),o=0;try{e.forEach(function(e,n){o++;var i=function(e,t){var n=e||t,i=r[n];if(!i)throw new Error(n+" is not a valid compression method !");return i}(n.options.compression,t.compression),s=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,c=n.date;n._compressWorker(i,s).withStreamInfo("file",{name:e,dir:l,date:c,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(a)}),a.entriesCount=o}catch(e){a.error(e)}return a}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=e("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./external"),a=e("./utf8"),o=e("./zipEntries"),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new i.Promise(function(t,n){var r=e.decompressed.getContentWorker().pipe(new s);r.on("error",function(e){n(e)}).on("end",function(){r.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}t.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),l.isNode&&l.isStream(e)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new o(t);return n.load(e),n}).then(function(e){var n=[i.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var a=0;a<r.length;a++)n.push(c(r[a]));return i.Promise.all(n)}).then(function(e){for(var i=e.shift(),a=i.files,o=0;o<a.length;o++){var s=a[o],l=s.fileNameStr,c=r.resolve(s.fileNameStr);n.file(c,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(n.file(c).unsafeOriginalName=l)}return i.zipComment.length&&(n.comment=i.zipComment),n})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../stream/GenericWorker");function a(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(a,i),a.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},a.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){"use strict";var r=e("readable-stream").Readable;function i(e,t,n){r.call(this,t),this._helper=e;var i=this;e.on("data",function(e,t){i.push(e)||i._helper.pause(),n&&n(t)}).on("error",function(e){i.emit("error",e)}).on("end",function(){i.push(null)})}e("../utils").inherits(i,r),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){"use strict";function r(e,t,n){var r,i=a.getTypeOf(t),s=a.extend(n||{},l);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=m(e)),s.createFolders&&(r=f(e))&&g.call(this,r,!0);var d="string"===i&&!1===s.binary&&!1===s.base64;n&&void 0!==n.binary||(s.binary=!d),(t instanceof c&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",i="string");var _;_=t instanceof c||t instanceof o?t:h.isNode&&h.isStream(t)?new p(e,t):a.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var w=new u(e,_,s);this.files[e]=w}var i=e("./utf8"),a=e("./utils"),o=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),u=e("./zipObject"),d=e("./generate"),h=e("./nodejsUtils"),p=e("./nodejs/NodejsStreamInputAdapter"),f=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:l.createFolders,e=m(e),this.files[e]||r.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function _(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,r;for(t in this.files)r=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,r)},filter:function(e){var t=[];return this.forEach(function(n,r){e(n,r)&&t.push(r)}),t},file:function(e,t,n){if(1!==arguments.length)return e=this.root+e,r.call(this,e,t,n),this;if(_(e)){var i=e;return this.filter(function(e,t){return!t.dir&&i.test(e)})}var a=this.files[this.root+e];return a&&!a.dir?a:null},folder:function(e){if(!e)return this;if(_(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=g.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=a.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");a.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var r=n.comment||this.comment||"";t=d.generateWorker(this,n,r)}catch(e){(t=new o("error")).error(e)}return new s(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),a=this.length-4;0<=a;--a)if(this.data[a]===t&&this.data[a+1]===n&&this.data[a+2]===r&&this.data[a+3]===i)return a-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),a=this.readData(4);return t===a[0]&&n===a[1]&&r===a[2]&&i===a[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){"use strict";var r=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,n){"use strict";var r=e("./Uint8ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){"use strict";var r=e("./ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../support"),a=e("./ArrayReader"),o=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new s(e):i.uint8array?new l(r.transformTo("uint8array",e)):new a(r.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../utils");function a(e){r.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(a,r),a.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../crc32");function a(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,r),a.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function a(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(a,i),a.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function a(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}r.inherits(a,i),a.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){"use strict";function r(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=r},{}],29:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./ConvertWorker"),a=e("./GenericWorker"),o=e("../base64"),s=e("../support"),l=e("../external"),c=null;if(s.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function u(e,t,n){var o=t;switch(t){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=t,this._mimeType=n,r.checkSupport(o),this._worker=e.pipe(new i(o)),e.lock()}catch(e){this._worker=new a("error"),this._worker.error(e)}}u.prototype={accumulate:function(e){return function(e,t){return new l.Promise(function(n,i){var a=[],s=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",function(e,n){a.push(e),t&&t(n)}).on("error",function(e){a=[],i(e)}).on("end",function(){try{var e=function(e,t,n){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),n);case"base64":return o.encode(t);default:return r.transformTo(e,t)}}(l,function(e,t){var n,r=0,i=null,a=0;for(n=0;n<t.length;n++)a+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(a),n=0;n<t.length;n++)i.set(t[n],r),r+=t[n].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,a),c);n(e)}catch(e){i(e)}a=[]}).resume()})}(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,function(e){t.call(n,e.data,e.meta)}):this._worker.on(e,function(){r.delay(t,arguments,n)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var r=new ArrayBuffer(0);try{n.blob=0===new Blob([r],{type:"application/zip"}).size}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(r),n.blob=0===i.getBlob("application/zip").size}catch(e){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(e){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";for(var r=e("./utils"),i=e("./support"),a=e("./nodejsUtils"),o=e("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){o.call(this,"utf-8 decode"),this.leftOver=null}function u(){o.call(this,"utf-8 encode")}s[254]=s[254]=1,n.utf8encode=function(e){return i.nodebuffer?a.newBufferFrom(e,"utf-8"):function(e){var t,n,r,a,o,s=e.length,l=0;for(a=0;a<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=i.uint8array?new Uint8Array(l):new Array(l),a=o=0;o<l;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?t[o++]=n:(n<2048?t[o++]=192|n>>>6:(n<65536?t[o++]=224|n>>>12:(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63),t[o++]=128|n>>>6&63),t[o++]=128|63&n);return t}(e)},n.utf8decode=function(e){return i.nodebuffer?r.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,i,a,o=e.length,l=new Array(2*o);for(t=n=0;t<o;)if((i=e[t++])<128)l[n++]=i;else if(4<(a=s[i]))l[n++]=65533,t+=a-1;else{for(i&=2===a?31:3===a?15:7;1<a&&t<o;)i=i<<6|63&e[t++],a--;1<a?l[n++]=65533:i<65536?l[n++]=i:(i-=65536,l[n++]=55296|i>>10&1023,l[n++]=56320|1023&i)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),r.applyFromCharCode(l)}(e=r.transformTo(i.uint8array?"uint8array":"array",e))},r.inherits(c,o),c.prototype.processChunk=function(e){var t=r.transformTo(i.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var a=t;(t=new Uint8Array(a.length+this.leftOver.length)).set(this.leftOver,0),t.set(a,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var o=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}(t),l=t;o!==t.length&&(i.uint8array?(l=t.subarray(0,o),this.leftOver=t.subarray(o,t.length)):(l=t.slice(0,o),this.leftOver=t.slice(o,t.length))),this.push({data:n.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=c,r.inherits(u,o),u.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){"use strict";var r=e("./support"),i=e("./base64"),a=e("./nodejsUtils"),o=e("./external");function s(e){return e}function l(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),n.newBlob=function(e,t){n.checkSupport("blob");try{return new Blob([e],{type:t})}catch(n){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(e),r.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,n){var r=[],i=0,a=e.length;if(a<=n)return String.fromCharCode.apply(null,e);for(;i<a;)"array"===t||"nodebuffer"===t?r.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+n,a)))):r.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+n,a)))),i+=n;return r.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,a.allocBuffer(1)).length}catch(e){return!1}}()}};function u(e){var t=65536,r=n.getTypeOf(e),i=!0;if("uint8array"===r?i=c.applyCanBeUsed.uint8array:"nodebuffer"===r&&(i=c.applyCanBeUsed.nodebuffer),i)for(;1<t;)try{return c.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return c.stringifyByChar(e)}function d(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=u;var h={};h.string={string:s,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return h.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,a.allocBuffer(e.length))}},h.array={string:u,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(e)}},h.arraybuffer={string:function(e){return u(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(new Uint8Array(e))}},h.uint8array={string:u,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return a.newBufferFrom(e)}},h.nodebuffer={string:u,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return h.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:s},n.transformTo=function(e,t){if(t=t||"",!e)return t;n.checkSupport(e);var r=n.getTypeOf(t);return h[r][e](t)},n.resolve=function(e){for(var t=e.split("/"),n=[],r=0;r<t.length;r++){var i=t[r];"."===i||""===i&&0!==r&&r!==t.length-1||(".."===i?n.pop():n.push(i))}return n.join("/")},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&a.isBuffer(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,r="";for(n=0;n<(e||"").length;n++)r+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return r},n.delay=function(e,t,n){setImmediate(function(){e.apply(n||null,t||[])})},n.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,a,s,c){return o.Promise.resolve(t).then(function(e){return r.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new o.Promise(function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)}):e}).then(function(t){var u=n.getTypeOf(t);return u?("arraybuffer"===u?t=n.transformTo("uint8array",t):"string"===u&&(c?t=i.decode(t):a&&!0!==s&&(t=function(e){return l(e,r.uint8array?new Uint8Array(e.length):new Array(e.length))}(t))),t):o.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),a=e("./signature"),o=e("./zipEntry"),s=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",n=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var r=t-n;if(0<r)this.isSignature(t,a.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),a=e("./compressedObject"),o=e("./crc32"),s=e("./utf8"),l=e("./compressions"),c=e("./support");function u(e,t){this.options=e,this.loadOptions=t}u.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,r,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),n=e.readInt(2),r=e.readData(n),this.extraFields[t]={id:t,length:n,value:r};e.setIndex(i)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var a=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||o(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||o(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){"use strict";function r(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var i=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),o=e("./utf8"),s=e("./compressedObject"),l=e("./stream/GenericWorker");r.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!r&&(t=t.pipe(new o.Utf8EncodeWorker)),!a&&r&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new i(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new o.Utf8EncodeWorker)),s.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new a(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<c.length;d++)r.prototype[c[d]]=u;t.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){"use strict";var n,r,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var a=0,o=new i(u),s=e.document.createTextNode("");o.observe(s,{characterData:!0}),n=function(){s.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,n=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;r=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}r=!1}t.exports=function(e){1!==c.push(e)||r||n()}}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){"use strict";var r=e("immediate");function i(){}var a={},o=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&p(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){r(function(){var r;try{r=t(n)}catch(r){return a.reject(e,r)}r===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,r)})}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var n=!1;function r(t){n||(n=!0,a.reject(e,t))}function i(t){n||(n=!0,a.resolve(e,t))}var o=f(function(){t(i,r)});"error"===o.status&&r(o.value)}function f(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===o)return this;var n=new this.constructor(i);return this.state!==l?d(n,this.state===s?e:t,this.outcome):this.queue.push(new u(n,e,t)),n},u.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){a.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},a.resolve=function(e,t){var n=f(h,t);if("error"===n.status)return a.reject(e,n.value);var r=n.value;if(r)p(e,r);else{e.state=s,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},a.reject=function(e,t){e.state=o,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:a.resolve(new this(i),e)},c.reject=function(e){var t=new this(i);return a.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var o=new Array(n),s=0,l=-1,c=new this(i);++l<n;)u(e[l],l);return c;function u(e,i){t.resolve(e).then(function(e){o[i]=e,++s!==n||r||(r=!0,a.resolve(c,o))},function(e){r||(r=!0,a.reject(c,e))})}},c.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var r,o=-1,s=new this(i);++o<t;)r=e[o],this.resolve(r).then(function(e){n||(n=!0,a.resolve(s,e))},function(e){n||(n=!0,a.reject(s,e))});return s}},{immediate:36}],38:[function(e,t,n){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){"use strict";var r=e("./zlib/deflate"),i=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==n)throw new Error(o[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var u;if(u="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(n=r.deflateSetDictionary(this.strm,u)))throw new Error(o[n]);this._dict_set=!0}}function u(e,t){var n=new c(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}c.prototype.push=function(e,t){var n,o,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=a.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(c),s.next_out=0,s.avail_out=c),1!==(n=r.deflate(s,o))&&0!==n)return this.onEnd(n),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(a.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==n);return 4===o?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==o||(this.onEnd(0),!(s.avail_out=0))},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=c,n.deflate=u,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,u(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){"use strict";var r=e("./zlib/inflate"),i=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),u=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==o.Z_OK)throw new Error(s[n]);this.header=new c,r.inflateGetHeader(this.strm,this.header)}function h(e,t){var n=new d(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}d.prototype.push=function(e,t){var n,s,l,c,d,h,p=this.strm,f=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?p.input=a.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?p.input=new Uint8Array(e):p.input=e,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new i.Buf8(f),p.next_out=0,p.avail_out=f),(n=r.inflate(p,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&m&&(h="string"==typeof m?a.string2buf(m):"[object ArrayBuffer]"===u.call(m)?new Uint8Array(m):m,n=r.inflateSetDictionary(this.strm,h)),n===o.Z_BUF_ERROR&&!0===g&&(n=o.Z_OK,g=!1),n!==o.Z_STREAM_END&&n!==o.Z_OK)return this.onEnd(n),!(this.ended=!0);p.next_out&&(0!==p.avail_out&&n!==o.Z_STREAM_END&&(0!==p.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(l=a.utf8border(p.output,p.next_out),c=p.next_out-l,d=a.buf2string(p.output,l),p.next_out=c,p.avail_out=f-c,c&&i.arraySet(p.output,p.output,l,c,0),this.onData(d)):this.onData(i.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(g=!0)}while((0<p.avail_in||0===p.avail_out)&&n!==o.Z_STREAM_END);return n===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(p.avail_out=0))},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=d,n.inflate=h,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},n.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){var t,n,r,i,a,o;for(t=r=0,n=e.length;t<n;t++)r+=e[t].length;for(o=new Uint8Array(r),t=i=0,n=e.length;t<n;t++)a=e[t],o.set(a,i),i+=a.length;return o}},a={arraySet:function(e,t,n,r,i){for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,a))},n.setTyped(r)},{}],42:[function(e,t,n){"use strict";var r=e("./common"),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=!1}for(var o=new r.Buf8(256),s=0;s<256;s++)o[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",o=0;o<t;o++)n+=String.fromCharCode(e[o]);return n}o[254]=o[254]=1,n.string2buf=function(e){var t,n,i,a,o,s=e.length,l=0;for(a=0;a<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(l),a=o=0;o<l;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),n<128?t[o++]=n:(n<2048?t[o++]=192|n>>>6:(n<65536?t[o++]=224|n>>>12:(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63),t[o++]=128|n>>>6&63),t[o++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,i,a,s=t||e.length,c=new Array(2*s);for(n=r=0;n<s;)if((i=e[n++])<128)c[r++]=i;else if(4<(a=o[i]))c[r++]=65533,n+=a-1;else{for(i&=2===a?31:3===a?15:7;1<a&&n<s;)i=i<<6|63&e[n++],a--;1<a?c[r++]=65533:i<65536?c[r++]=i:(i-=65536,c[r++]=55296|i>>10&1023,c[r++]=56320|1023&i)}return l(c,r)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+o[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){for(var i=65535&e,a=e>>>16&65535,o=0;0!==n;){for(n-=o=2e3<n?2e3:n;a=a+(i=i+t[r++]|0)|0,--o;);i%=65521,a%=65521}return i|a<<16}},{}],44:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){"use strict";var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,i){var a=r,o=i+n;e^=-1;for(var s=i;s<o;s++)e=e>>>8^a[255&(e^t[s])];return-1^e}},{}],46:[function(e,t,n){"use strict";var r,i=e("../utils/common"),a=e("./trees"),o=e("./adler32"),s=e("./crc32"),l=e("./messages"),c=-2,u=258,d=262,h=113;function p(e,t){return e.msg=l[t],t}function f(e){return(e<<1)-(4<e?9:0)}function m(e){for(var t=e.length;0<=--t;)e[t]=0}function g(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function _(e,t){a._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,g(e.strm)}function w(e,t){e.pending_buf[e.pending++]=t}function b(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function y(e,t){var n,r,i=e.max_chain_length,a=e.strstart,o=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-d?e.strstart-(e.w_size-d):0,c=e.window,h=e.w_mask,p=e.prev,f=e.strstart+u,m=c[a+o-1],g=c[a+o];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(n=t)+o]===g&&c[n+o-1]===m&&c[n]===c[a]&&c[++n]===c[a+1]){a+=2,n++;do{}while(c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&a<f);if(r=u-(f-a),a=f-u,o<r){if(e.match_start=t,s<=(o=r))break;m=c[a+o-1],g=c[a+o]}}}while((t=p[t&h])>l&&0!=--i);return o<=e.lookahead?o:e.lookahead}function v(e){var t,n,r,a,l,c,u,h,p,f,m=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-d)){for(i.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=n=e.hash_size;r=e.head[--t],e.head[t]=m<=r?r-m:0,--n;);for(t=n=m;r=e.prev[--t],e.prev[t]=m<=r?r-m:0,--n;);a+=m}if(0===e.strm.avail_in)break;if(c=e.strm,u=e.window,h=e.strstart+e.lookahead,f=void 0,(p=a)<(f=c.avail_in)&&(f=p),n=0===f?0:(c.avail_in-=f,i.arraySet(u,c.input,c.next_in,f,h),1===c.state.wrap?c.adler=o(c.adler,u,f,h):2===c.state.wrap&&(c.adler=s(c.adler,u,f,h)),c.next_in+=f,c.total_in+=f,f),e.lookahead+=n,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<d&&0!==e.strm.avail_in)}function x(e,t){for(var n,r;;){if(e.lookahead<d){if(v(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-d&&(e.match_length=y(e,n)),e.match_length>=3)if(r=a._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(_(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(_(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?1:2}function E(e,t){for(var n,r,i;;){if(e.lookahead<d){if(v(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-d&&(e.match_length=y(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-3,r=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(_(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=a._tr_tally(e,0,e.window[e.strstart-1]))&&_(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(_(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?1:2}function I(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function k(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),m(this.dyn_ltree),m(this.dyn_dtree),m(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),m(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),m(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function C(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:h,e.adler=2===t.wrap?0:1,t.last_flush=0,a._tr_init(t),0):p(e,c)}function B(e){var t=C(e);return 0===t&&function(e){e.window_size=2*e.w_size,m(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0}(e.state),t}function z(e,t,n,r,a,o){if(!e)return c;var s=1;if(-1===t&&(t=6),r<0?(s=0,r=-r):15<r&&(s=2,r-=16),a<1||9<a||8!==n||r<8||15<r||t<0||9<t||o<0||4<o)return p(e,c);8===r&&(r=9);var l=new k;return(e.state=l).strm=e,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=n,B(e)}r=[new I(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(v(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,_(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-d&&(_(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(_(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(_(e,!1),e.strm.avail_out),1)}),new I(4,4,8,4,x),new I(4,5,16,8,x),new I(4,6,32,32,x),new I(4,4,16,16,E),new I(8,16,32,32,E),new I(8,16,128,128,E),new I(8,32,128,256,E),new I(32,128,258,1024,E),new I(32,258,258,4096,E)],n.deflateInit=function(e,t){return z(e,t,8,15,8,0)},n.deflateInit2=z,n.deflateReset=B,n.deflateResetKeep=C,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?c:(e.state.gzhead=t,0):c},n.deflate=function(e,t){var n,i,o,l;if(!e||!e.state||5<t||t<0)return e?p(e,c):c;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&4!==t)return p(e,0===e.avail_out?-5:c);if(i.strm=e,n=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,w(i,31),w(i,139),w(i,8),i.gzhead?(w(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),w(i,255&i.gzhead.time),w(i,i.gzhead.time>>8&255),w(i,i.gzhead.time>>16&255),w(i,i.gzhead.time>>24&255),w(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),w(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(w(i,255&i.gzhead.extra.length),w(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(w(i,0),w(i,0),w(i,0),w(i,0),w(i,0),w(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),w(i,3),i.status=h);else{var d=8+(i.w_bits-8<<4)<<8;d|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(d|=32),d+=31-d%31,i.status=h,b(i,d),0!==i.strstart&&(b(i,e.adler>>>16),b(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(o=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),g(e),o=i.pending,i.pending!==i.pending_buf_size));)w(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),g(e),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,w(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),g(e),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,w(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&g(e),i.pending+2<=i.pending_buf_size&&(w(i,255&e.adler),w(i,e.adler>>8&255),e.adler=0,i.status=h)):i.status=h),0!==i.pending){if(g(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&f(t)<=f(n)&&4!==t)return p(e,-5);if(666===i.status&&0!==e.avail_in)return p(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&666!==i.status){var y=2===i.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(v(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(_(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(_(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var n,r,i,o,s=e.window;;){if(e.lookahead<=u){if(v(e),e.lookahead<=u&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(r=s[i=e.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){o=e.strstart+u;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<o);e.match_length=u-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=a._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(_(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(_(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?1:2}(i,t):r[i.level].func(i,t);if(3!==y&&4!==y||(i.status=666),1===y||3===y)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===y&&(1===t?a._tr_align(i):5!==t&&(a._tr_stored_block(i,0,0,!1),3===t&&(m(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),g(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(w(i,255&e.adler),w(i,e.adler>>8&255),w(i,e.adler>>16&255),w(i,e.adler>>24&255),w(i,255&e.total_in),w(i,e.total_in>>8&255),w(i,e.total_in>>16&255),w(i,e.total_in>>24&255)):(b(i,e.adler>>>16),b(i,65535&e.adler)),g(e),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?0:1)},n.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&t!==h&&666!==t?p(e,c):(e.state=null,t===h?p(e,-3):0):c},n.deflateSetDictionary=function(e,t){var n,r,a,s,l,u,d,h,p=t.length;if(!e||!e.state)return c;if(2===(s=(n=e.state).wrap)||1===s&&42!==n.status||n.lookahead)return c;for(1===s&&(e.adler=o(e.adler,t,p,0)),n.wrap=0,p>=n.w_size&&(0===s&&(m(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new i.Buf8(n.w_size),i.arraySet(h,t,p-n.w_size,n.w_size,0),t=h,p=n.w_size),l=e.avail_in,u=e.next_in,d=e.input,e.avail_in=p,e.next_in=0,e.input=t,v(n);n.lookahead>=3;){for(r=n.strstart,a=n.lookahead-2;n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+3-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,--a;);n.strstart=r,n.lookahead=2,v(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=u,e.input=d,e.avail_in=l,n.wrap=s,0},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){"use strict";t.exports=function(e,t){var n,r,i,a,o,s,l,c,u,d,h,p,f,m,g,_,w,b,y,v,x,E,I,k,C;n=e.state,r=e.next_in,k=e.input,i=r+(e.avail_in-5),a=e.next_out,C=e.output,o=a-(t-e.avail_out),s=a+(e.avail_out-257),l=n.dmax,c=n.wsize,u=n.whave,d=n.wnext,h=n.window,p=n.hold,f=n.bits,m=n.lencode,g=n.distcode,_=(1<<n.lenbits)-1,w=(1<<n.distbits)-1;e:do{f<15&&(p+=k[r++]<<f,f+=8,p+=k[r++]<<f,f+=8),b=m[p&_];t:for(;;){if(p>>>=y=b>>>24,f-=y,0==(y=b>>>16&255))C[a++]=65535&b;else{if(!(16&y)){if(!(64&y)){b=m[(65535&b)+(p&(1<<y)-1)];continue t}if(32&y){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}v=65535&b,(y&=15)&&(f<y&&(p+=k[r++]<<f,f+=8),v+=p&(1<<y)-1,p>>>=y,f-=y),f<15&&(p+=k[r++]<<f,f+=8,p+=k[r++]<<f,f+=8),b=g[p&w];n:for(;;){if(p>>>=y=b>>>24,f-=y,!(16&(y=b>>>16&255))){if(!(64&y)){b=g[(65535&b)+(p&(1<<y)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(x=65535&b,f<(y&=15)&&(p+=k[r++]<<f,(f+=8)<y&&(p+=k[r++]<<f,f+=8)),l<(x+=p&(1<<y)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(p>>>=y,f-=y,(y=a-o)<x){if(u<(y=x-y)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(I=h,(E=0)===d){if(E+=c-y,y<v){for(v-=y;C[a++]=h[E++],--y;);E=a-x,I=C}}else if(d<y){if(E+=c+d-y,(y-=d)<v){for(v-=y;C[a++]=h[E++],--y;);if(E=0,d<v){for(v-=y=d;C[a++]=h[E++],--y;);E=a-x,I=C}}}else if(E+=d-y,y<v){for(v-=y;C[a++]=h[E++],--y;);E=a-x,I=C}for(;2<v;)C[a++]=I[E++],C[a++]=I[E++],C[a++]=I[E++],v-=3;v&&(C[a++]=I[E++],1<v&&(C[a++]=I[E++]))}else{for(E=a-x;C[a++]=C[E++],C[a++]=C[E++],C[a++]=C[E++],2<(v-=3););v&&(C[a++]=C[E++],1<v&&(C[a++]=C[E++]))}break}}break}}while(r<i&&a<s);r-=v=f>>3,p&=(1<<(f-=v<<3))-1,e.next_in=r,e.next_out=a,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=a<s?s-a+257:257-(a-s),n.hold=p,n.bits=f}},{}],49:[function(e,t,n){"use strict";var r=e("../utils/common"),i=e("./adler32"),a=e("./crc32"),o=e("./inffast"),s=e("./inftrees"),l=-2;function c(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(852),t.distcode=t.distdyn=new r.Buf32(592),t.sane=1,t.back=-1,0):l}function h(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,d(e)):l}function p(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?l:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,h(e))):l}function f(e,t){var n,r;return e?(r=new u,(e.state=r).window=null,0!==(n=p(e,t))&&(e.state=null),n):l}var m,g,_=!0;function w(e){if(_){var t;for(m=new r.Buf32(512),g=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,m,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,g,0,e.work,{bits:5}),_=!1}e.lencode=m,e.lenbits=9,e.distcode=g,e.distbits=5}function b(e,t,n,i){var a,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new r.Buf8(o.wsize)),i>=o.wsize?(r.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(i<(a=o.wsize-o.wnext)&&(a=i),r.arraySet(o.window,t,n-i,a,o.wnext),(i-=a)?(r.arraySet(o.window,t,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}n.inflateReset=h,n.inflateReset2=p,n.inflateResetKeep=d,n.inflateInit=function(e){return f(e,15)},n.inflateInit2=f,n.inflate=function(e,t){var n,u,d,h,p,f,m,g,_,y,v,x,E,I,k,C,B,z,S,A,L,R,T,F,M=0,P=new r.Buf8(4),N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return l;12===(n=e.state).mode&&(n.mode=13),p=e.next_out,d=e.output,m=e.avail_out,h=e.next_in,u=e.input,f=e.avail_in,g=n.hold,_=n.bits,y=f,v=m,R=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;_<16;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}if(2&n.wrap&&35615===g){P[n.check=0]=255&g,P[1]=g>>>8&255,n.check=a(n.check,P,2,0),_=g=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&g)<<8)+(g>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&g)){e.msg="unknown compression method",n.mode=30;break}if(_-=4,L=8+(15&(g>>>=4)),0===n.wbits)n.wbits=L;else if(L>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<L,e.adler=n.check=1,n.mode=512&g?10:12,_=g=0;break;case 2:for(;_<16;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}if(n.flags=g,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=g>>8&1),512&n.flags&&(P[0]=255&g,P[1]=g>>>8&255,n.check=a(n.check,P,2,0)),_=g=0,n.mode=3;case 3:for(;_<32;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}n.head&&(n.head.time=g),512&n.flags&&(P[0]=255&g,P[1]=g>>>8&255,P[2]=g>>>16&255,P[3]=g>>>24&255,n.check=a(n.check,P,4,0)),_=g=0,n.mode=4;case 4:for(;_<16;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}n.head&&(n.head.xflags=255&g,n.head.os=g>>8),512&n.flags&&(P[0]=255&g,P[1]=g>>>8&255,n.check=a(n.check,P,2,0)),_=g=0,n.mode=5;case 5:if(1024&n.flags){for(;_<16;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}n.length=g,n.head&&(n.head.extra_len=g),512&n.flags&&(P[0]=255&g,P[1]=g>>>8&255,n.check=a(n.check,P,2,0)),_=g=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(f<(x=n.length)&&(x=f),x&&(n.head&&(L=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,u,h,x,L)),512&n.flags&&(n.check=a(n.check,u,x,h)),f-=x,h+=x,n.length-=x),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===f)break e;for(x=0;L=u[h+x++],n.head&&L&&n.length<65536&&(n.head.name+=String.fromCharCode(L)),L&&x<f;);if(512&n.flags&&(n.check=a(n.check,u,x,h)),f-=x,h+=x,L)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===f)break e;for(x=0;L=u[h+x++],n.head&&L&&n.length<65536&&(n.head.comment+=String.fromCharCode(L)),L&&x<f;);if(512&n.flags&&(n.check=a(n.check,u,x,h)),f-=x,h+=x,L)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;_<16;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}if(g!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}_=g=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;_<32;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}e.adler=n.check=c(g),_=g=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=p,e.avail_out=m,e.next_in=h,e.avail_in=f,n.hold=g,n.bits=_,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){g>>>=7&_,_-=7&_,n.mode=27;break}for(;_<3;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}switch(n.last=1&g,_-=1,3&(g>>>=1)){case 0:n.mode=14;break;case 1:if(w(n),n.mode=20,6!==t)break;g>>>=2,_-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}g>>>=2,_-=2;break;case 14:for(g>>>=7&_,_-=7&_;_<32;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}if((65535&g)!=(g>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&g,_=g=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(x=n.length){if(f<x&&(x=f),m<x&&(x=m),0===x)break e;r.arraySet(d,u,h,x,p),f-=x,h+=x,m-=x,p+=x,n.length-=x;break}n.mode=12;break;case 17:for(;_<14;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}if(n.nlen=257+(31&g),g>>>=5,_-=5,n.ndist=1+(31&g),g>>>=5,_-=5,n.ncode=4+(15&g),g>>>=4,_-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;_<3;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}n.lens[N[n.have++]]=7&g,g>>>=3,_-=3}for(;n.have<19;)n.lens[N[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,T={bits:n.lenbits},R=s(0,n.lens,0,19,n.lencode,0,n.work,T),n.lenbits=T.bits,R){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;C=(M=n.lencode[g&(1<<n.lenbits)-1])>>>16&255,B=65535&M,!((k=M>>>24)<=_);){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}if(B<16)g>>>=k,_-=k,n.lens[n.have++]=B;else{if(16===B){for(F=k+2;_<F;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}if(g>>>=k,_-=k,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}L=n.lens[n.have-1],x=3+(3&g),g>>>=2,_-=2}else if(17===B){for(F=k+3;_<F;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}_-=k,L=0,x=3+(7&(g>>>=k)),g>>>=3,_-=3}else{for(F=k+7;_<F;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}_-=k,L=0,x=11+(127&(g>>>=k)),g>>>=7,_-=7}if(n.have+x>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;x--;)n.lens[n.have++]=L}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,T={bits:n.lenbits},R=s(1,n.lens,0,n.nlen,n.lencode,0,n.work,T),n.lenbits=T.bits,R){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,T={bits:n.distbits},R=s(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,T),n.distbits=T.bits,R){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=f&&258<=m){e.next_out=p,e.avail_out=m,e.next_in=h,e.avail_in=f,n.hold=g,n.bits=_,o(e,v),p=e.next_out,d=e.output,m=e.avail_out,h=e.next_in,u=e.input,f=e.avail_in,g=n.hold,_=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;C=(M=n.lencode[g&(1<<n.lenbits)-1])>>>16&255,B=65535&M,!((k=M>>>24)<=_);){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}if(C&&!(240&C)){for(z=k,S=C,A=B;C=(M=n.lencode[A+((g&(1<<z+S)-1)>>z)])>>>16&255,B=65535&M,!(z+(k=M>>>24)<=_);){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}g>>>=z,_-=z,n.back+=z}if(g>>>=k,_-=k,n.back+=k,n.length=B,0===C){n.mode=26;break}if(32&C){n.back=-1,n.mode=12;break}if(64&C){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&C,n.mode=22;case 22:if(n.extra){for(F=n.extra;_<F;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}n.length+=g&(1<<n.extra)-1,g>>>=n.extra,_-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;C=(M=n.distcode[g&(1<<n.distbits)-1])>>>16&255,B=65535&M,!((k=M>>>24)<=_);){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}if(!(240&C)){for(z=k,S=C,A=B;C=(M=n.distcode[A+((g&(1<<z+S)-1)>>z)])>>>16&255,B=65535&M,!(z+(k=M>>>24)<=_);){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}g>>>=z,_-=z,n.back+=z}if(g>>>=k,_-=k,n.back+=k,64&C){e.msg="invalid distance code",n.mode=30;break}n.offset=B,n.extra=15&C,n.mode=24;case 24:if(n.extra){for(F=n.extra;_<F;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}n.offset+=g&(1<<n.extra)-1,g>>>=n.extra,_-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===m)break e;if(x=v-m,n.offset>x){if((x=n.offset-x)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}E=x>n.wnext?(x-=n.wnext,n.wsize-x):n.wnext-x,x>n.length&&(x=n.length),I=n.window}else I=d,E=p-n.offset,x=n.length;for(m<x&&(x=m),m-=x,n.length-=x;d[p++]=I[E++],--x;);0===n.length&&(n.mode=21);break;case 26:if(0===m)break e;d[p++]=n.length,m--,n.mode=21;break;case 27:if(n.wrap){for(;_<32;){if(0===f)break e;f--,g|=u[h++]<<_,_+=8}if(v-=m,e.total_out+=v,n.total+=v,v&&(e.adler=n.check=n.flags?a(n.check,d,v,p-v):i(n.check,d,v,p-v)),v=m,(n.flags?g:c(g))!==n.check){e.msg="incorrect data check",n.mode=30;break}_=g=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;_<32;){if(0===f)break e;f--,g+=u[h++]<<_,_+=8}if(g!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}_=g=0}n.mode=29;case 29:R=1;break e;case 30:R=-3;break e;case 31:return-4;default:return l}return e.next_out=p,e.avail_out=m,e.next_in=h,e.avail_in=f,n.hold=g,n.bits=_,(n.wsize||v!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&b(e,e.output,e.next_out,v-e.avail_out)?(n.mode=31,-4):(y-=e.avail_in,v-=e.avail_out,e.total_in+=y,e.total_out+=v,n.total+=v,n.wrap&&v&&(e.adler=n.check=n.flags?a(n.check,d,v,e.next_out-v):i(n.check,d,v,e.next_out-v)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==y&&0===v||4===t)&&0===R&&(R=-5),R)},n.inflateEnd=function(e){if(!e||!e.state)return l;var t=e.state;return t.window&&(t.window=null),e.state=null,0},n.inflateGetHeader=function(e,t){var n;return e&&e.state&&2&(n=e.state).wrap?((n.head=t).done=!1,0):l},n.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?l:11===n.mode&&i(1,t,r,0)!==n.check?-3:b(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,0):l},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){"use strict";var r=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,l,c,u,d,h){var p,f,m,g,_,w,b,y,v,x=h.bits,E=0,I=0,k=0,C=0,B=0,z=0,S=0,A=0,L=0,R=0,T=null,F=0,M=new r.Buf16(16),P=new r.Buf16(16),N=null,W=0;for(E=0;E<=15;E++)M[E]=0;for(I=0;I<l;I++)M[t[n+I]]++;for(B=x,C=15;1<=C&&0===M[C];C--);if(C<B&&(B=C),0===C)return c[u++]=20971520,c[u++]=20971520,h.bits=1,0;for(k=1;k<C&&0===M[k];k++);for(B<k&&(B=k),E=A=1;E<=15;E++)if(A<<=1,(A-=M[E])<0)return-1;if(0<A&&(0===e||1!==C))return-1;for(P[1]=0,E=1;E<15;E++)P[E+1]=P[E]+M[E];for(I=0;I<l;I++)0!==t[n+I]&&(d[P[t[n+I]]++]=I);if(w=0===e?(T=N=d,19):1===e?(T=i,F-=257,N=a,W-=257,256):(T=o,N=s,-1),E=k,_=u,S=I=R=0,m=-1,g=(L=1<<(z=B))-1,1===e&&852<L||2===e&&592<L)return 1;for(;;){for(b=E-S,v=d[I]<w?(y=0,d[I]):d[I]>w?(y=N[W+d[I]],T[F+d[I]]):(y=96,0),p=1<<E-S,k=f=1<<z;c[_+(R>>S)+(f-=p)]=b<<24|y<<16|v,0!==f;);for(p=1<<E-1;R&p;)p>>=1;if(0!==p?(R&=p-1,R+=p):R=0,I++,0==--M[E]){if(E===C)break;E=t[n+d[I]]}if(B<E&&(R&g)!==m){for(0===S&&(S=B),_+=k,A=1<<(z=E-S);z+S<C&&!((A-=M[z+S])<=0);)z++,A<<=1;if(L+=1<<z,1===e&&852<L||2===e&&592<L)return 1;c[m=R&g]=B<<24|z<<16|_-u}}return 0!==R&&(c[_+R]=E-S<<24|64<<16),h.bits=B,0}},{"../utils/common":41}],51:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){"use strict";var r=e("../utils/common");function i(e){for(var t=e.length;0<=--t;)e[t]=0}var a=256,o=286,s=30,l=15,c=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],u=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],h=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],p=new Array(576);i(p);var f=new Array(60);i(f);var m=new Array(512);i(m);var g=new Array(256);i(g);var _=new Array(29);i(_);var w,b,y,v=new Array(s);function x(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function E(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function I(e){return e<256?m[e]:m[256+(e>>>7)]}function k(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function C(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,k(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function B(e,t,n){C(e,n[2*t],n[2*t+1])}function z(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function S(e,t,n){var r,i,a=new Array(16),o=0;for(r=1;r<=l;r++)a[r]=o=o+n[r-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=z(a[s]++,s))}}function A(e){var t;for(t=0;t<o;t++)e.dyn_ltree[2*t]=0;for(t=0;t<s;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function L(e){8<e.bi_valid?k(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function R(e,t,n,r){var i=2*t,a=2*n;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]}function T(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&R(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!R(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function F(e,t,n){var r,i,o,s,l=0;if(0!==e.last_lit)for(;r=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],i=e.pending_buf[e.l_buf+l],l++,0===r?B(e,i,t):(B(e,(o=g[i])+a+1,t),0!==(s=c[o])&&C(e,i-=_[o],s),B(e,o=I(--r),n),0!==(s=u[o])&&C(e,r-=v[o],s)),l<e.last_lit;);B(e,256,t)}function M(e,t){var n,r,i,a=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,c=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<c;n++)0!==a[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)a[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=o[2*i+1]);for(t.max_code=u,n=e.heap_len>>1;1<=n;n--)T(e,a,n);for(i=c;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],T(e,a,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,a[2*i]=a[2*n]+a[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,a[2*n+1]=a[2*r+1]=i,e.heap[1]=i++,T(e,a,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,a,o,s,c=t.dyn_tree,u=t.max_code,d=t.stat_desc.static_tree,h=t.stat_desc.has_stree,p=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,m=t.stat_desc.max_length,g=0;for(a=0;a<=l;a++)e.bl_count[a]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)m<(a=c[2*c[2*(r=e.heap[n])+1]+1]+1)&&(a=m,g++),c[2*r+1]=a,u<r||(e.bl_count[a]++,o=0,f<=r&&(o=p[r-f]),s=c[2*r],e.opt_len+=s*(a+o),h&&(e.static_len+=s*(d[2*r+1]+o)));if(0!==g){do{for(a=m-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[m]--,g-=2}while(0<g);for(a=m;0!==a;a--)for(r=e.bl_count[a];0!==r;)u<(i=e.heap[--n])||(c[2*i+1]!==a&&(e.opt_len+=(a-c[2*i+1])*c[2*i],c[2*i+1]=a),r--)}}(e,t),S(a,u,e.bl_count)}function P(e,t,n){var r,i,a=-1,o=t[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=t[2*(r+1)+1],++s<l&&i===o||(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=i,c=(s=0)===o?(l=138,3):i===o?(l=6,3):(l=7,4))}function N(e,t,n){var r,i,a=-1,o=t[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),r=0;r<=n;r++)if(i=o,o=t[2*(r+1)+1],!(++s<l&&i===o)){if(s<c)for(;B(e,i,e.bl_tree),0!=--s;);else 0!==i?(i!==a&&(B(e,i,e.bl_tree),s--),B(e,16,e.bl_tree),C(e,s-3,2)):s<=10?(B(e,17,e.bl_tree),C(e,s-3,3)):(B(e,18,e.bl_tree),C(e,s-11,7));a=i,c=(s=0)===o?(l=138,3):i===o?(l=6,3):(l=7,4)}}i(v);var W=!1;function O(e,t,n,i){C(e,0+(i?1:0),3),function(e,t,n){L(e),k(e,n),k(e,~n),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n)}n._tr_init=function(e){W||(function(){var e,t,n,r,i,a=new Array(16);for(r=n=0;r<28;r++)for(_[r]=n,e=0;e<1<<c[r];e++)g[n++]=r;for(g[n-1]=r,r=i=0;r<16;r++)for(v[r]=i,e=0;e<1<<u[r];e++)m[i++]=r;for(i>>=7;r<s;r++)for(v[r]=i<<7,e=0;e<1<<u[r]-7;e++)m[256+i++]=r;for(t=0;t<=l;t++)a[t]=0;for(e=0;e<=143;)p[2*e+1]=8,e++,a[8]++;for(;e<=255;)p[2*e+1]=9,e++,a[9]++;for(;e<=279;)p[2*e+1]=7,e++,a[7]++;for(;e<=287;)p[2*e+1]=8,e++,a[8]++;for(S(p,287,a),e=0;e<s;e++)f[2*e+1]=5,f[2*e]=z(e,5);w=new x(p,c,257,o,l),b=new x(f,u,0,s,l),y=new x(new Array(0),d,0,19,7)}(),W=!0),e.l_desc=new E(e.dyn_ltree,w),e.d_desc=new E(e.dyn_dtree,b),e.bl_desc=new E(e.bl_tree,y),e.bi_buf=0,e.bi_valid=0,A(e)},n._tr_stored_block=O,n._tr_flush_block=function(e,t,n,r){var i,o,s=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<a;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),M(e,e.l_desc),M(e,e.d_desc),s=function(e){var t;for(P(e,e.dyn_ltree,e.l_desc.max_code),P(e,e.dyn_dtree,e.d_desc.max_code),M(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*h[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=n+5,n+4<=i&&-1!==t?O(e,t,n,r):4===e.strategy||o===i?(C(e,2+(r?1:0),3),F(e,p,f)):(C(e,4+(r?1:0),3),function(e,t,n,r){var i;for(C(e,t-257,5),C(e,n-1,5),C(e,r-4,4),i=0;i<r;i++)C(e,e.bl_tree[2*h[i]+1],3);N(e,e.dyn_ltree,t-1),N(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),F(e,e.dyn_ltree,e.dyn_dtree)),A(e),r&&L(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(g[n]+a+1)]++,e.dyn_dtree[2*I(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){C(e,2,3),B(e,256,p),function(e){16===e.bi_valid?(k(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){(function(e){!function(e){"use strict";if(!e.setImmediate){var t,n,r,i,a=1,o={},s=!1,l=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,t="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick(function(){d(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(i="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",h,!1):e.attachEvent("onmessage",h),function(t){e.postMessage(i+t,"*")}):e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){d(e.data)},function(e){r.port2.postMessage(e)}):l&&"onreadystatechange"in l.createElement("script")?(n=l.documentElement,function(e){var t=l.createElement("script");t.onreadystatechange=function(){d(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):function(e){setTimeout(d,0,e)},c.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var n=new Array(arguments.length-1),r=0;r<n.length;r++)n[r]=arguments[r+1];var i={callback:e,args:n};return o[a]=i,t(a),a++},c.clearImmediate=u}function u(e){delete o[e]}function d(e){if(s)setTimeout(d,0,e);else{var t=o[e];if(t){s=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{u(e),s=!1}}}}function h(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(i)&&d(+t.data.slice(i.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},640(e,t,n){"use strict";e.exports=n.p+"aceedeb416c3ef67d1dd.wasm"},482(e,t,n){"use strict";e.exports=n.p+"d8d500e523bf0431d020.wasm"},147(e,t,n){"use strict";e.exports=n.p+"98c86cc689f471d8c402.wasm"},281(e,t,n){"use strict";e.exports=n.p+"70d14377bae88f32e492.wasm"},192(e,t,n){"use strict";e.exports=n.p+"13a21edca08a3be3abd8.wasm"},901(e,t,n){"use strict";e.exports=n.p+"3802306e7b58a11862fb.wasm"}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var a=r[e]={exports:{}};return n[e](a,a.exports,i),a.exports}i.m=n,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce((t,n)=>(i.f[n](e,t),t),[])),i.u=e=>e+".main.js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="batch-image-resizer:",i.l=(n,r,a,o)=>{if(e[n])e[n].push(r);else{var s,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+a){s=d;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+a),s.src=n),e[n]=[r];var h=(t,r)=>{s.onerror=s.onload=null,clearTimeout(p);var i=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach(e=>e(r)),t)return t(r)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),l&&document.head.appendChild(s)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{i.b="undefined"!=typeof document&&document.baseURI||self.location.href;var e={792:0};i.f.j=(t,n)=>{var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var a=new Promise((n,i)=>r=e[t]=[n,i]);n.push(r[2]=a);var o=i.p+i.u(t),s=new Error;i.l(o,n=>{if(i.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,r[1](s)}},"chunk-"+t,t)}};var t=(t,n)=>{var r,a,[o,s,l]=n,c=0;if(o.some(t=>0!==e[t])){for(r in s)i.o(s,r)&&(i.m[r]=s[r]);l&&l(i)}for(t&&t(n);c<o.length;c++)a=o[c],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0},n=self.webpackChunkbatch_image_resizer=self.webpackChunkbatch_image_resizer||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";var e={};i.r(e),i.d(e,{PhotonImage:()=>kr,Rgb:()=>Br,Rgba:()=>Sr,SamplingFilter:()=>Er,add_noise_rand:()=>Yt,adjust_brightness:()=>Qn,adjust_contrast:()=>Xn,alter_blue_channel:()=>Te,alter_channel:()=>Ae,alter_channels:()=>Me,alter_green_channel:()=>Re,alter_red_channel:()=>Le,alter_two_channels:()=>Fe,apply_gradient:()=>tn,b_grayscale:()=>it,base64_to_image:()=>gr,base64_to_vec:()=>_r,blend:()=>Jt,box_blur:()=>Nt,cali:()=>un,color_horizontal_strips:()=>Kn,color_vertical_strips:()=>er,colorize:()=>$n,create_gradient:()=>en,crop:()=>yn,crop_img_browser:()=>vn,darken_hsl:()=>Ct,darken_hsluv:()=>kt,darken_hsv:()=>Bt,darken_lch:()=>It,dec_brightness:()=>Gn,decompose_max:()=>et,decompose_min:()=>Je,default:()=>Fr,desaturate:()=>Ke,desaturate_hsl:()=>St,desaturate_hsluv:()=>Lt,desaturate_hsv:()=>zt,desaturate_lch:()=>At,detect_135_deg_lines:()=>Ut,detect_45_deg_lines:()=>jt,detect_horizontal_lines:()=>Ot,detect_vertical_lines:()=>Dt,dither:()=>ar,dramatic:()=>dn,draw_text:()=>lr,draw_text_with_border:()=>sr,duotone:()=>or,duotone_horizon:()=>fn,duotone_lilac:()=>gn,duotone_ochre:()=>_n,duotone_tint:()=>mn,duotone_violette:()=>pn,edge_detection:()=>Mt,edge_one:()=>Ht,emboss:()=>qt,filter:()=>on,firenze:()=>wn,fliph:()=>xn,flipv:()=>En,frosted_glass:()=>nr,g_grayscale:()=>rt,gamma_correction:()=>st,gaussian_blur:()=>Wt,get_image_data:()=>hr,golden:()=>cn,grayscale:()=>Ye,grayscale_human_corrected:()=>Ve,grayscale_shades:()=>tt,halftone:()=>jn,horizontal_strips:()=>Vn,hsl:()=>ut,hsluv:()=>lt,hsv:()=>dt,hue_rotate_hsl:()=>ht,hue_rotate_hsluv:()=>mt,hue_rotate_hsv:()=>pt,hue_rotate_lch:()=>ft,identity:()=>Pt,inc_brightness:()=>Zn,initSync:()=>Rr,invert:()=>je,laplace:()=>$t,lch:()=>ct,lighten_hsl:()=>xt,lighten_hsluv:()=>vt,lighten_hsv:()=>Et,lighten_lch:()=>yt,lix:()=>rn,lofi:()=>sn,mix_with_colour:()=>Rt,monochrome:()=>Ge,monochrome_tint:()=>hn,multiple_offsets:()=>Dn,neue:()=>nn,noise_reduction:()=>Tt,normalize:()=>ir,obsidian:()=>bn,offset:()=>Pn,offset_blue:()=>On,offset_green:()=>Wn,offset_red:()=>Nn,oil:()=>tr,open_image:()=>fr,padding_bottom:()=>Tn,padding_left:()=>An,padding_right:()=>Ln,padding_top:()=>Rn,padding_uniform:()=>Sn,pastel_pink:()=>ln,pink_noise:()=>Vt,pixelize:()=>rr,prewitt_horizontal:()=>Zt,primary:()=>Un,putImageData:()=>pr,r_grayscale:()=>nt,remove_blue_channel:()=>Oe,remove_channel:()=>Pe,remove_green_channel:()=>We,remove_red_channel:()=>Ne,resample:()=>Mn,resize:()=>kn,resize_img_browser:()=>In,rotate:()=>Fn,run:()=>dr,ryo:()=>an,saturate_hsl:()=>gt,saturate_hsluv:()=>wt,saturate_hsv:()=>bt,saturate_lch:()=>_t,seam_carve:()=>Cn,selective_color_convert:()=>$e,selective_desaturate:()=>qe,selective_greyscale:()=>Ze,selective_hue_rotate:()=>Ue,selective_lighten:()=>He,selective_saturate:()=>Qe,sepia:()=>Xe,sharpen:()=>Ft,shearx:()=>Bn,sheary:()=>zn,single_channel_grayscale:()=>at,sobel_global:()=>Xt,sobel_horizontal:()=>Qt,sobel_vertical:()=>Gt,solarize:()=>Hn,solarize_retimg:()=>qn,swap_channels:()=>De,threshold:()=>ot,tint:()=>Yn,to_image_data:()=>wr,to_raw_pixels:()=>mr,vertical_strips:()=>Jn,watermark:()=>Kt});var t=i(710),n=i.n(t);let r,a=null,o=0;let s=null;function l(){return null!==s&&0!==s.byteLength||(s=new Int32Array(r.memory.buffer)),s}let c=null;async function u(e){if(void 0!==r)return r;void 0===e&&(e=new URL(i(192),i.b));const t={wbg:{}};("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:o}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return function(e,t){return r=e.exports,u.__wbindgen_wasm_module=t,s=null,a=null,c=null,r}(n,o)}const d=u,h=void 0!==globalThis.ServiceWorkerGlobalScope&&"undefined"!=typeof self&&globalThis.caches&&void 0!==globalThis.caches.default,p="object"==typeof process&&process.release&&"node"===process.release.name;let f;(h||p)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(e,t,n){this.data=e,this.width=t,this.height=n}}),"undefined"!=typeof self&&void 0===self.location&&(self.location={href:""}));let m=null;function g(){return null!==m&&0!==m.byteLength||(m=new Uint32Array(f.memory.buffer)),m}let _=0,w=null;function b(){return null!==w&&0!==w.byteLength||(w=new Int32Array(f.memory.buffer)),w}async function y(e){if(void 0!==f)return f;void 0===e&&(e=new URL(i(147),i.b));const t={wbg:{}};("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return function(e,t){return f=e.exports,y.__wbindgen_wasm_module=t,w=null,m=null,f}(n,r)}const v=y,x=void 0!==globalThis.ServiceWorkerGlobalScope&&"undefined"!=typeof self&&globalThis.caches&&void 0!==globalThis.caches.default,E="object"==typeof process&&process.release&&"node"===process.release.name;let I;(x||E)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(e,t,n){this.data=e,this.width=t,this.height=n}}),"undefined"!=typeof self&&void 0===self.location&&(self.location={href:""}));let k=null;function C(){return null!==k&&0!==k.byteLength||(k=new Uint8Array(I.memory.buffer)),k}let B=null;const z=new TextEncoder;"encodeInto"in z||(z.encodeInto=function(e,t){const n=z.encode(e);return t.set(n),{read:e.length,written:n.length}});let S=0;const A=new Set(["basic","cors","default"]);function L(){const e={wbg:{}};return e.wbg.__wbg_new_with_owned_u8_clamped_array_and_sh_e8143e95833a3ec3=function(e,t,n,r){var i,a,o=(i=e,a=t,i>>>=0,(null!==B&&0!==B.byteLength||(B=new Uint8ClampedArray(I.memory.buffer)),B).subarray(i/1,i/1+a)).slice();return I.__wbindgen_free(e,1*t,1),new ImageData(o,n>>>0,r>>>0)},e.wbg.__wbindgen_init_externref_table=function(){const e=I.__wbindgen_externrefs,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},e}async function R(e){if(void 0!==I)return I;void 0!==e&&(Object.getPrototypeOf(e)===Object.prototype?({module_or_path:e}=e):console.warn("using deprecated parameters for the initialization function; pass a single object instead")),void 0===e&&(e=new URL(i(281),i.b));const t=L();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if(!e.ok||!A.has(e.type)||"application/wasm"===e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return function(e,t){return I=e.exports,R.__wbindgen_wasm_module=t,k=null,B=null,I.__wbindgen_start(),I}(n,r)}const T=R,F=void 0!==globalThis.ServiceWorkerGlobalScope&&"undefined"!=typeof self&&globalThis.caches&&void 0!==globalThis.caches.default,M="object"==typeof process&&process.release&&"node"===process.release.name;(F||M)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(e,t,n){this.data=e,this.width=t,this.height=n}}),"undefined"!=typeof self&&void 0===self.location&&(self.location={href:""}));const P={width:1,height:1,method:"lanczos3",fitMethod:"stretch",premultiply:!0,linearRGB:!0},N=["magicKernel","magicKernelSharp2013","magicKernelSharp2021"];let W,O,D;const j=["triangle","catrom","mitchell","lanczos3"];async function U(e,t){await(O||(O=v(void 0)),O);const n=t.width/e.width,r=t.height/e.height,i=Math.max(n,r),a=function(e,{min:t=Number.MIN_VALUE,max:n=Number.MAX_VALUE}){return Math.min(Math.max(e,t),n)}(Math.ceil(i),{min:1,max:4});if(1===a)return e;const o=function(e,t,n,r){try{const c=f.__wbindgen_add_to_stack_pointer(-16),u=function(e,t){const n=t(4*e.length,4)>>>0;return g().set(e,n/4),_=e.length,n}(e,f.__wbindgen_malloc),d=_;f.resize(c,u,d,t,n,r);var i=b()[c/4+0],a=b()[c/4+1],o=(s=i,l=a,s>>>=0,g().subarray(s/4,s/4+l)).slice();return f.__wbindgen_free(i,4*a,4),o}finally{f.__wbindgen_add_to_stack_pointer(16)}var s,l}(new Uint32Array(e.data.buffer),e.width,e.height,a);return new ImageData(new Uint8ClampedArray(o.buffer),e.width*a,e.height*a)}async function $(e,t){return await(D||(D=T(void 0)),D),function(e,t,n,r,i,a){const o=function(e,t){const n=t(1*e.length,1)>>>0;return C().set(e,n/1),S=e.length,n}(e,I.__wbindgen_malloc),s=S,l=function(e,t,n){if(void 0===n){const n=z.encode(e),r=t(n.length,1)>>>0;return C().subarray(r,r+n.length).set(n),S=n.length,r}let r=e.length,i=t(r,1)>>>0;const a=C();let o=0;for(;o<r;o++){const t=e.charCodeAt(o);if(t>127)break;a[i+o]=t}if(o!==r){0!==o&&(e=e.slice(o)),i=n(i,r,r=o+3*e.length,1)>>>0;const t=C().subarray(i+o,i+r);o+=z.encodeInto(e,t).written,i=n(i,r,o,1)>>>0}return S=o,i}(a,I.__wbindgen_malloc,I.__wbindgen_realloc),c=S;return I.resize(o,s,t,n,r,i,l,c)}(new Uint8Array(e.data.buffer),e.width,e.height,t.width,t.height,t.method)}async function H(e,t){let n={...P,...t},i=e;var s;if(W||(W=d(void 0)),"hqx"===n.method&&(i=await U(i,n),n={...n,method:"catrom"}),await W,"contain"===n.fitMethod){const{sx:t,sy:r,sw:a,sh:o}=function(e,t,n,r){const i=n/r;if(i>e/t){const n=e/i;return{sw:e,sh:n,sx:0,sy:(t-n)/2}}const a=t*i;return{sh:t,sw:a,sx:(e-a)/2,sy:0}}(e.width,e.height,n.width,n.height);i=function(e,t,n,r,i){const a=new Uint32Array(e.data.buffer);for(let o=0;o<i;o+=1){const i=(o+n)*e.width+t;a.copyWithin(o*r,i,i+r)}return new ImageData(new Uint8ClampedArray(a.buffer.slice(0,r*i*4)),r,i)}(i,Math.round(t),Math.round(r),Math.round(a),Math.round(o))}if(s=n,N.includes(s.method))return $(i,n);const u=function(e,t,n,i,s,u,d,h){try{const w=r.__wbindgen_add_to_stack_pointer(-16),b=function(e,t){const n=t(1*e.length,1)>>>0;return(null!==a&&0!==a.byteLength||(a=new Uint8Array(r.memory.buffer)),a).set(e,n/1),o=e.length,n}(e,r.__wbindgen_malloc),y=o;r.resize(w,b,y,t,n,i,s,u,d,h);var p=l()[w/4+0],f=l()[w/4+1],m=(g=p,_=f,g>>>=0,(null!==c&&0!==c.byteLength||(c=new Uint8ClampedArray(r.memory.buffer)),c).subarray(g/1,g/1+_)).slice();return r.__wbindgen_free(p,1*f,1),m}finally{r.__wbindgen_add_to_stack_pointer(16)}var g,_}(new Uint8Array(i.data.buffer),i.width,i.height,n.width,n.height,j.indexOf(n.method),n.premultiply,n.linearRGB);return new ImageData(new Uint8ClampedArray(u.buffer),n.width,n.height)}var q,Q=(q="file:///home/ian/code/newgit/batch-image-resizer/node_modules/@jsquash/jpeg/codec/enc/mozjpeg_enc.js",function(e={}){var t,n,r=e,a=new Promise((e,r)=>{t=e,n=r});const o=void 0!==globalThis.ServiceWorkerGlobalScope&&"undefined"!=typeof self&&globalThis.caches&&void 0!==globalThis.caches.default,s="object"==typeof process&&process.release&&"node"===process.release.name;(o||s)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(e,t,n){this.data=e,this.width=t,this.height=n}}),"undefined"!=typeof self&&void 0===self.location&&(self.location={href:""}));var l,c=Object.assign({},r),u="./this.program",d=(e,t)=>{throw t},h="object"==typeof window,p="function"==typeof importScripts,f=("object"==typeof process&&"object"==typeof process.versions&&process.versions.node,"");(h||p)&&(p?f=self.location.href:"undefined"!=typeof document&&document.currentScript&&(f=document.currentScript.src),q&&(f=q),f=f.startsWith("blob:")?"":f.substr(0,f.replace(/[?#].*/,"").lastIndexOf("/")+1),p&&(l=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}));var m,g,_=r.print||console.log.bind(console),w=r.printErr||console.error.bind(console);Object.assign(r,c),c=null,r.arguments&&r.arguments,r.thisProgram&&(u=r.thisProgram),r.quit&&(d=r.quit),r.wasmBinary&&(m=r.wasmBinary);var b,y,v,x,E,I,k,C,B=!1;function z(){var e=g.buffer;r.HEAP8=b=new Int8Array(e),r.HEAP16=v=new Int16Array(e),r.HEAPU8=y=new Uint8Array(e),r.HEAPU16=x=new Uint16Array(e),r.HEAP32=E=new Int32Array(e),r.HEAPU32=I=new Uint32Array(e),r.HEAPF32=k=new Float32Array(e),r.HEAPF64=C=new Float64Array(e)}var S=[],A=[],L=[];function R(e){S.unshift(e)}function T(e){L.unshift(e)}var F=0,M=null,P=null;function N(e){r.onAbort?.(e),w(e="Aborted("+e+")"),B=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw n(t),t}var W,O,D=e=>e.startsWith("data:application/octet-stream;base64,");function j(e){if(e==W&&m)return new Uint8Array(m);if(l)return l(e);throw"both async and sync fetching of the wasm failed"}function U(e,t,n){return function(e){return m||!h&&!p||"function"!=typeof fetch?Promise.resolve().then(()=>j(e)):fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw`failed to load wasm binary file at '${e}'`;return t.arrayBuffer()}).catch(()=>j(e))}(e).then(e=>WebAssembly.instantiate(e,t)).then(n,e=>{w(`failed to asynchronously prepare wasm: ${e}`),N(e)})}function $(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}r.locateFile?D(W="mozjpeg_enc.wasm")||(O=W,W=r.locateFile?r.locateFile(O,f):f+O):W=new URL(i(640),i.b).href;var H=e=>{for(;e.length>0;)e.shift()(r)},Q=r.noExitRuntime||!0;class Z{constructor(e){this.excPtr=e,this.ptr=e-24}set_type(e){I[this.ptr+4>>2]=e}get_type(){return I[this.ptr+4>>2]}set_destructor(e){I[this.ptr+8>>2]=e}get_destructor(){return I[this.ptr+8>>2]}set_caught(e){e=e?1:0,b[this.ptr+12]=e}get_caught(){return 0!=b[this.ptr+12]}set_rethrown(e){e=e?1:0,b[this.ptr+13]=e}get_rethrown(){return 0!=b[this.ptr+13]}init(e,t){this.set_adjusted_ptr(0),this.set_type(e),this.set_destructor(t)}set_adjusted_ptr(e){I[this.ptr+16>>2]=e}get_adjusted_ptr(){return I[this.ptr+16>>2]}get_exception_ptr(){if(Ye(this.get_type()))return I[this.excPtr>>2];var e=this.get_adjusted_ptr();return 0!==e?e:this.excPtr}}var G={},X=e=>{for(;e.length;){var t=e.pop();e.pop()(t)}};function Y(e){return this.fromWireType(I[e>>2])}var V,K,J,ee={},te={},ne={},re=e=>{throw new V(e)},ie=(e,t,n)=>{function r(t){var r=n(t);r.length!==e.length&&re("Mismatched type converter count");for(var i=0;i<e.length;++i)se(e[i],r[i])}e.forEach(function(e){ne[e]=t});var i=new Array(t.length),a=[],o=0;t.forEach((e,t)=>{te.hasOwnProperty(e)?i[t]=te[e]:(a.push(e),ee.hasOwnProperty(e)||(ee[e]=[]),ee[e].push(()=>{i[t]=te[e],++o===a.length&&r(i)}))}),0===a.length&&r(i)},ae=e=>{for(var t="",n=e;y[n];)t+=K[y[n++]];return t},oe=e=>{throw new J(e)};function se(e,t,n={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");return function(e,t,n={}){var r=t.name;if(e||oe(`type "${r}" must have a positive integer typeid pointer`),te.hasOwnProperty(e)){if(n.ignoreDuplicateRegistrations)return;oe(`Cannot register type '${r}' twice`)}if(te[e]=t,delete ne[e],ee.hasOwnProperty(e)){var i=ee[e];delete ee[e],i.forEach(e=>e())}}(e,t,n)}var le,ce,ue,de,he=[],pe=[],fe=e=>{e>9&&0===--pe[e+1]&&(pe[e]=void 0,he.push(e))},me=e=>(e||oe("Cannot use deleted val. handle = "+e),pe[e]),ge=e=>{switch(e){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const t=he.pop()||pe.length;return pe[t]=e,pe[t+1]=1,t}}},_e={name:"emscripten::val",fromWireType:e=>{var t=me(e);return fe(e),t},toWireType:(e,t)=>ge(t),argPackAdvance:8,readValueFromPointer:Y,destructorFunction:null},we=(e,t)=>{switch(t){case 4:return function(e){return this.fromWireType(k[e>>2])};case 8:return function(e){return this.fromWireType(C[e>>3])};default:throw new TypeError(`invalid float width (${t}): ${e}`)}},be=(e,t)=>Object.defineProperty(t,"name",{value:e}),ye=(e,t,n)=>{if(void 0===e[t].overloadTable){var r=e[t];e[t]=function(...r){return e[t].overloadTable.hasOwnProperty(r.length)||oe(`Function '${n}' called with an invalid number of arguments (${r.length}) - expects one of (${e[t].overloadTable})!`),e[t].overloadTable[r.length].apply(this,r)},e[t].overloadTable=[],e[t].overloadTable[r.argCount]=r}},ve=[],xe=e=>{var t=ve[e];return t||(e>=ve.length&&(ve.length=e+1),ve[e]=t=le.get(e)),t},Ee=(e,t)=>{var n,i,a=(e=ae(e)).includes("j")?(n=e,i=t,(...e)=>((e,t,n=[])=>e.includes("j")?((e,t,n)=>(e=e.replace(/p/g,"i"),(0,r["dynCall_"+e])(t,...n)))(e,t,n):xe(t)(...n))(n,i,e)):xe(t);return"function"!=typeof a&&oe(`unknown function pointer with signature ${e}: ${t}`),a},Ie=e=>{var t=Ze(e),n=ae(t);return Xe(t),n},ke=(e,t,n)=>{switch(t){case 1:return n?e=>b[e]:e=>y[e];case 2:return n?e=>v[e>>1]:e=>x[e>>1];case 4:return n?e=>E[e>>2]:e=>I[e>>2];default:throw new TypeError(`invalid integer width (${t}): ${e}`)}},Ce=(e,t,n)=>{for(var r=t+n,i="";!(t>=r);){var a=e[t++];if(!a)return i;if(128&a){var o=63&e[t++];if(192!=(224&a)){var s=63&e[t++];if((a=224==(240&a)?(15&a)<<12|o<<6|s:(7&a)<<18|o<<12|s<<6|63&e[t++])<65536)i+=String.fromCharCode(a);else{var l=a-65536;i+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else i+=String.fromCharCode((31&a)<<6|o)}else i+=String.fromCharCode(a)}return i},Be=(e,t)=>e?Ce(y,e,t):"",ze=(e,t)=>{for(var n="",r=0;!(r>=t/2);++r){var i=v[e+2*r>>1];if(0==i)break;n+=String.fromCharCode(i)}return n},Se=(e,t,n)=>{if(n??=2147483647,n<2)return 0;for(var r=t,i=(n-=2)<2*e.length?n/2:e.length,a=0;a<i;++a){var o=e.charCodeAt(a);v[t>>1]=o,t+=2}return v[t>>1]=0,t-r},Ae=e=>2*e.length,Le=(e,t)=>{for(var n=0,r="";!(n>=t/4);){var i=E[e+4*n>>2];if(0==i)break;if(++n,i>=65536){var a=i-65536;r+=String.fromCharCode(55296|a>>10,56320|1023&a)}else r+=String.fromCharCode(i)}return r},Re=(e,t,n)=>{if(n??=2147483647,n<4)return 0;for(var r=t,i=r+n-4,a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++a)),E[t>>2]=o,(t+=4)+4>i)break}return E[t>>2]=0,t-r},Te=e=>{for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r>=55296&&r<=57343&&++n,t+=4}return t},Fe=[],Me={},Pe=()=>{if("object"==typeof globalThis)return globalThis;function e(e){e.$$$embind_global$$$=e;var t="object"==typeof $$$embind_global$$$&&e.$$$embind_global$$$==e;return t||delete e.$$$embind_global$$$,t}if("object"==typeof $$$embind_global$$$)return $$$embind_global$$$;if("object"==typeof i.g&&e(i.g)?$$$embind_global$$$=i.g:"object"==typeof self&&e(self)&&($$$embind_global$$$=self),"object"==typeof $$$embind_global$$$)return $$$embind_global$$$;throw Error("unable to get global object.")},Ne=(e,t)=>{var n=te[e];return void 0===n&&oe(`${t} has unknown type ${Ie(e)}`),n},We=Reflect.construct,Oe=e=>{var t=(e-g.buffer.byteLength+65535)/65536;try{return g.grow(t),z(),1}catch(e){}},De={},je=()=>{if(!je.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:u||"./this.program"};for(var t in De)void 0===De[t]?delete e[t]:e[t]=De[t];var n=[];for(var t in e)n.push(`${t}=${e[t]}`);je.strings=n}return je.strings},Ue=[null,[],[]],$e=(e,t)=>{var n=Ue[e];0===t||10===t?((1===e?_:w)(Ce(n,0)),n.length=0):n.push(t)};V=r.InternalError=class extends Error{constructor(e){super(e),this.name="InternalError"}},(()=>{for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);K=e})(),J=r.BindingError=class extends Error{constructor(e){super(e),this.name="BindingError"}},pe.push(0,1,void 0,1,null,1,!0,1,!1,1),r.count_emval_handles=()=>pe.length/2-5-he.length,ce=r.UnboundTypeError=(ue=Error,(de=be("UnboundTypeError",function(e){this.name="UnboundTypeError",this.message=e;var t=new Error(e).stack;void 0!==t&&(this.stack=this.toString()+"\n"+t.replace(/^Error(:[^\n]*)?\n/,""))})).prototype=Object.create(ue.prototype),de.prototype.constructor=de,de.prototype.toString=function(){return void 0===this.message?this.name:`${this.name}: ${this.message}`},de);var He,qe={j:(e,t,n)=>{throw new Z(e).init(t,n),e},k:e=>{var t=G[e];delete G[e];var n=t.rawConstructor,r=t.rawDestructor,i=t.fields,a=i.map(e=>e.getterReturnType).concat(i.map(e=>e.setterArgumentType));ie([e],a,e=>{var a={};return i.forEach((t,n)=>{var r=t.fieldName,o=e[n],s=t.getter,l=t.getterContext,c=e[n+i.length],u=t.setter,d=t.setterContext;a[r]={read:e=>o.fromWireType(s(l,e)),write:(e,t)=>{var n=[];u(d,e,c.toWireType(n,t)),X(n)}}}),[{name:t.name,fromWireType:e=>{var t={};for(var n in a)t[n]=a[n].read(e);return r(e),t},toWireType:(e,t)=>{for(var i in a)if(!(i in t))throw new TypeError(`Missing field: "${i}"`);var o=n();for(i in a)a[i].write(o,t[i]);return null!==e&&e.push(r,o),o},argPackAdvance:8,readValueFromPointer:Y,destructorFunction:r}]})},n:(e,t,n,r,i)=>{},h:(e,t,n,r)=>{se(e,{name:t=ae(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?n:r},argPackAdvance:8,readValueFromPointer:function(e){return this.fromWireType(y[e])},destructorFunction:null})},z:e=>se(e,_e),f:(e,t,n)=>{se(e,{name:t=ae(t),fromWireType:e=>e,toWireType:(e,t)=>t,argPackAdvance:8,readValueFromPointer:we(t,n),destructorFunction:null})},e:(e,t,n,i,a,o,s)=>{var l=((e,t)=>{for(var n=[],r=0;r<e;r++)n.push(I[t+4*r>>2]);return n})(t,n);e=(e=>{const t=(e=e.trim()).indexOf("(");return-1!==t?e.substr(0,t):e})(e=ae(e)),a=Ee(i,a),((e,t,n)=>{r.hasOwnProperty(e)?((void 0===n||void 0!==r[e].overloadTable&&void 0!==r[e].overloadTable[n])&&oe(`Cannot register public name '${e}' twice`),ye(r,e,e),r.hasOwnProperty(n)&&oe(`Cannot register multiple overloads of a function with the same number of arguments (${n})!`),r[e].overloadTable[n]=t):(r[e]=t,void 0!==n&&(r[e].numArguments=n))})(e,function(){((e,t)=>{var n=[],r={};throw t.forEach(function e(t){r[t]||te[t]||(ne[t]?ne[t].forEach(e):(n.push(t),r[t]=!0))}),new ce(`${e}: `+n.map(Ie).join([", "]))})(`Cannot call ${e} due to unbound types`,l)},t-1),ie([],l,n=>{var i=[n[0],null].concat(n.slice(1));return((e,t,n)=>{r.hasOwnProperty(e)||re("Replacing nonexistent public symbol"),void 0!==r[e].overloadTable&&void 0!==n?r[e].overloadTable[n]=t:(r[e]=t,r[e].argCount=n)})(e,function(e,t,n,r,i){var a=t.length;a<2&&oe("argTypes array size mismatch! Must at least get return value and 'this' types!");var o=null!==t[1]&&!1,s=function(e){for(var t=1;t<e.length;++t)if(null!==e[t]&&void 0===e[t].destructorFunction)return!0;return!1}(t),l="void"!==t[0].name,c=a-2,u=new Array(c),d=[],h=[];return be(e,function(...n){var a;n.length!==c&&oe(`function ${e} called with ${n.length} arguments, expected ${c}`),h.length=0,d.length=o?2:1,d[0]=i,o&&(a=t[1].toWireType(h,this),d[1]=a);for(var p=0;p<c;++p)u[p]=t[p+2].toWireType(h,n[p]),d.push(u[p]);return function(e){if(s)X(h);else for(var n=o?1:2;n<t.length;n++){var r=1===n?a:u[n-2];null!==t[n].destructorFunction&&t[n].destructorFunction(r)}if(l)return t[0].fromWireType(e)}(r(...d))})}(e,i,0,a,o),t-1),[]})},c:(e,t,n,r,i)=>{t=ae(t),-1===i&&(i=4294967295);var a=e=>e;if(0===r){var o=32-8*n;a=e=>e<<o>>>o}var s=t.includes("unsigned");se(e,{name:t,fromWireType:a,toWireType:s?function(e,t){return this.name,t>>>0}:function(e,t){return this.name,t},argPackAdvance:8,readValueFromPointer:ke(t,n,0!==r),destructorFunction:null})},a:(e,t,n)=>{var r=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];function i(e){var t=I[e>>2],n=I[e+4>>2];return new r(b.buffer,n,t)}se(e,{name:n=ae(n),fromWireType:i,argPackAdvance:8,readValueFromPointer:i},{ignoreDuplicateRegistrations:!0})},g:(e,t)=>{var n="std::string"===(t=ae(t));se(e,{name:t,fromWireType(e){var t,r=I[e>>2],i=e+4;if(n)for(var a=i,o=0;o<=r;++o){var s=i+o;if(o==r||0==y[s]){var l=Be(a,s-a);void 0===t?t=l:(t+=String.fromCharCode(0),t+=l),a=s+1}}else{var c=new Array(r);for(o=0;o<r;++o)c[o]=String.fromCharCode(y[i+o]);t=c.join("")}return Xe(e),t},toWireType(e,t){var r;t instanceof ArrayBuffer&&(t=new Uint8Array(t));var i="string"==typeof t;i||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||oe("Cannot pass non-string to std::string"),r=n&&i?(e=>{for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r<=127?t++:r<=2047?t+=2:r>=55296&&r<=57343?(t+=4,++n):t+=3}return t})(t):t.length;var a=Ge(4+r+1),o=a+4;if(I[a>>2]=r,n&&i)((e,t,n,r)=>{if(!(r>0))return 0;for(var i=n+r-1,a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++a)),o<=127){if(n>=i)break;t[n++]=o}else if(o<=2047){if(n+1>=i)break;t[n++]=192|o>>6,t[n++]=128|63&o}else if(o<=65535){if(n+2>=i)break;t[n++]=224|o>>12,t[n++]=128|o>>6&63,t[n++]=128|63&o}else{if(n+3>=i)break;t[n++]=240|o>>18,t[n++]=128|o>>12&63,t[n++]=128|o>>6&63,t[n++]=128|63&o}}t[n]=0})(t,y,o,r+1);else if(i)for(var s=0;s<r;++s){var l=t.charCodeAt(s);l>255&&(Xe(o),oe("String has UTF-16 code units that do not fit in 8 bits")),y[o+s]=l}else for(s=0;s<r;++s)y[o+s]=t[s];return null!==e&&e.push(Xe,a),a},argPackAdvance:8,readValueFromPointer:Y,destructorFunction(e){Xe(e)}})},d:(e,t,n)=>{var r,i,a,o;n=ae(n),2===t?(r=ze,i=Se,o=Ae,a=e=>x[e>>1]):4===t&&(r=Le,i=Re,o=Te,a=e=>I[e>>2]),se(e,{name:n,fromWireType:e=>{for(var n,i=I[e>>2],o=e+4,s=0;s<=i;++s){var l=e+4+s*t;if(s==i||0==a(l)){var c=r(o,l-o);void 0===n?n=c:(n+=String.fromCharCode(0),n+=c),o=l+t}}return Xe(e),n},toWireType:(e,r)=>{"string"!=typeof r&&oe(`Cannot pass non-string to C++ string type ${n}`);var a=o(r),s=Ge(4+a+t);return I[s>>2]=a/t,i(r,s+4,a+t),null!==e&&e.push(Xe,s),s},argPackAdvance:8,readValueFromPointer:Y,destructorFunction(e){Xe(e)}})},l:(e,t,n,r,i,a)=>{G[e]={name:ae(t),rawConstructor:Ee(n,r),rawDestructor:Ee(i,a),fields:[]}},b:(e,t,n,r,i,a,o,s,l,c)=>{G[e].fields.push({fieldName:ae(t),getterReturnType:n,getter:Ee(r,i),getterContext:a,setterArgumentType:o,setter:Ee(s,l),setterContext:c})},i:(e,t)=>{se(e,{isVoid:!0,name:t=ae(t),argPackAdvance:0,fromWireType:()=>{},toWireType:(e,t)=>{}})},s:(e,t,n)=>y.copyWithin(e,t,t+n),y:(e,t,n,r)=>(e=Fe[e])(null,t=me(t),n,r),u:fe,A:e=>{return 0===e?ge(Pe()):(e=void 0===(n=Me[t=e])?ae(t):n,ge(Pe()[e]));var t,n},x:(e,t,n)=>{var r=((e,t)=>{for(var n=new Array(e),r=0;r<e;++r)n[r]=Ne(I[t+4*r>>2],"parameter "+r);return n})(e,t),i=r.shift();e--;var a,o,s=new Array(e),l=`methodCaller<(${r.map(e=>e.name).join(", ")}) => ${i.name}>`;return a=be(l,(t,a,o,l)=>{for(var c=0,u=0;u<e;++u)s[u]=r[u].readValueFromPointer(l+c),c+=r[u].argPackAdvance;var d=1===n?We(a,s):a.apply(t,s);return((e,t,n)=>{var r=[],i=e.toWireType(r,n);return r.length&&(I[t>>2]=ge(r)),i})(i,o,d)}),o=Fe.length,Fe.push(a),o},w:e=>{var t=me(e);X(t),fe(e)},o:()=>{N("")},p:e=>{var t=y.length,n=2147483648;if((e>>>=0)>n)return!1;for(var r=(e,t)=>e+(t-e%t)%t,i=1;i<=4;i*=2){var a=t*(1+.2/i);a=Math.min(a,e+100663296);var o=Math.min(n,r(Math.max(e,a),65536));if(Oe(o))return!0}return!1},q:(e,t)=>{var n=0;return je().forEach((r,i)=>{var a=t+n;I[e+4*i>>2]=a,((e,t)=>{for(var n=0;n<e.length;++n)b[t++]=e.charCodeAt(n);b[t]=0})(r,a),n+=r.length+1}),0},r:(e,t)=>{var n=je();I[e>>2]=n.length;var r=0;return n.forEach(e=>r+=e.length+1),I[t>>2]=r,0},B:(e,t)=>{var n;n=e,Q||(r.onExit?.(n),B=!0),d(n,new $(n))},t:e=>52,m:function(e,t,n,r,i){return 70},v:(e,t,n,r)=>{for(var i=0,a=0;a<n;a++){var o=I[t>>2],s=I[t+4>>2];t+=8;for(var l=0;l<s;l++)$e(e,y[o+l]);i+=s}return I[r>>2]=i,0}},Qe=function(){var e,t,i,a,o={a:qe};function s(e,t){var n;return Qe=e.exports,g=Qe.C,z(),le=Qe.H,n=Qe.D,A.unshift(n),function(){if(F--,r.monitorRunDependencies?.(F),0==F&&(null!==M&&(clearInterval(M),M=null),P)){var e=P;P=null,e()}}(),Qe}if(F++,r.monitorRunDependencies?.(F),r.instantiateWasm)try{return r.instantiateWasm(o,s)}catch(e){w(`Module.instantiateWasm callback failed with error: ${e}`),n(e)}return(e=m,t=W,i=o,a=function(e){s(e.instance)},e||"function"!=typeof WebAssembly.instantiateStreaming||D(t)||"function"!=typeof fetch?U(t,i,a):fetch(t,{credentials:"same-origin"}).then(e=>WebAssembly.instantiateStreaming(e,i).then(a,function(e){return w(`wasm streaming compile failed: ${e}`),w("falling back to ArrayBuffer instantiation"),U(t,i,a)}))).catch(n),{}}(),Ze=e=>(Ze=Qe.E)(e),Ge=e=>(Ge=Qe.F)(e),Xe=e=>(Xe=Qe.G)(e),Ye=e=>(Ye=Qe.I)(e);function Ve(){function e(){He||(He=!0,r.calledRun=!0,B||(H(A),t(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),function(){if(r.postRun)for("function"==typeof r.postRun&&(r.postRun=[r.postRun]);r.postRun.length;)T(r.postRun.shift());H(L)}()))}F>0||(function(){if(r.preRun)for("function"==typeof r.preRun&&(r.preRun=[r.preRun]);r.preRun.length;)R(r.preRun.shift());H(S)}(),F>0||(r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),e()},1)):e()))}if(r.dynCall_jiji=(e,t,n,i,a)=>(r.dynCall_jiji=Qe.J)(e,t,n,i,a),P=function e(){He||Ve(),He||(P=e)},r.preInit)for("function"==typeof r.preInit&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return Ve(),a});const Z=Q,G={quality:75,baseline:!1,arithmetic:!1,progressive:!0,optimize_coding:!0,smoothing:0,color_space:3,quant_table:3,trellis_multipass:!1,trellis_opt_zero:!1,trellis_opt_table:!1,trellis_loops:1,auto_subsample:!0,chroma_subsample:2,separate_chroma_quality:!1,chroma_quality:75};let X;async function Y(e,t={}){X||async function(e,t){let n=e,r=t;1!==arguments.length||e instanceof WebAssembly.Module||(n=void 0,r=e),X=function(e,t,n={}){let r;return t&&(r=(e,n)=>{const r=new WebAssembly.Instance(t,e);return n(r),r.exports}),e({noInitialRun:!0,instantiateWasm:r,...n})}(Z,n,r)}();const n=await X,r={...G,...t};return n.encode(e.data,e.width,e.height,r).buffer}const V={quality:75,target_size:0,target_PSNR:0,method:4,sns_strength:50,filter_strength:60,filter_sharpness:0,filter_type:1,partitions:0,segments:4,pass:1,show_compressed:0,preprocessing:0,autofilter:0,partition_limit:0,alpha_compression:1,alpha_filtering:1,alpha_quality:100,lossless:0,exact:0,image_hint:0,emulate_jpeg_size:0,thread_level:0,low_memory:0,near_lossless:100,use_delta_palette:0,use_sharp_yuv:0};function K(e,t,n={}){let r;return t&&(r=(e,n)=>{const r=new WebAssembly.Instance(t,e);return n(r),r.exports}),e({noInitialRun:!0,instantiateWasm:r,...n})}let J;async function ee(e,t={}){J||(J=async function(e,t){let n=e,r=t;if(1!==arguments.length||e instanceof WebAssembly.Module||(n=void 0,r=e),await(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])))()){const e=await i.e(899).then(i.bind(i,899));return J=K(e.default,n,r),J}const a=await i.e(227).then(i.bind(i,227));return J=K(a.default,n,r),J}());const n={...V,...t},r=(await J).encode(e.data,e.width,e.height,n);if(!r)throw new Error("Encoding error.");return r.buffer}const te={quality:50,qualityAlpha:-1,denoiseLevel:0,tileColsLog2:0,tileRowsLog2:0,speed:6,subsample:1,chromaDeltaQ:!1,sharpness:0,tune:0,enableSharpYUV:!1,bitDepth:8,lossless:!1};function ne(e,t,n={}){let r;return t&&(r=(e,n)=>{const r=new WebAssembly.Instance(t,e);return n(r),r.exports}),e({noInitialRun:!0,instantiateWasm:r,...n})}let re,ie;async function ae(e,t={}){re||(re=async function(e,t){let n=e,r=t;if(1!==arguments.length||e instanceof WebAssembly.Module||(n=void 0,r=e),("undefined"==typeof process||!process.release||"node"!==process.release.name)&&void 0===(null===(a=globalThis.caches)||void 0===a?void 0:a.default)&&await(async e=>{try{return"undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch(e){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))){const e=await i.e(976).then(i.bind(i,595));return re=ne(e.default,n,r),re}var a;const o=await i.e(207).then(i.bind(i,207));return re=ne(o.default,n,r),re}());const n={...te,...t};if(8!==n.bitDepth&&10!==n.bitDepth&&12!==n.bitDepth)throw new Error("Invalid bit depth. Supported values are 8, 10, or 12.");if(!(e.data instanceof Uint16Array)&&8!==n.bitDepth)throw new Error("Invalid image data for bit depth. Must use Uint16Array for bit depths greater than 8.");n.lossless&&(void 0!==t.quality&&100!==t.quality&&console.warn("AVIF lossless: Quality setting is ignored when lossless is enabled (quality must be 100)."),void 0!==t.qualityAlpha&&100!==t.qualityAlpha&&-1!==t.qualityAlpha&&console.warn("AVIF lossless: QualityAlpha setting is ignored when lossless is enabled (qualityAlpha must be 100 or -1)."),void 0!==t.subsample&&3!==t.subsample&&console.warn("AVIF lossless: Subsample setting is ignored when lossless is enabled (subsample must be 3 for YUV444)."),n.quality=100,n.qualityAlpha=-1,n.subsample=3);const r=(await re).encode(new Uint8Array(e.data.buffer),e.width,e.height,n);if(!r)throw new Error("Encoding error.");return r.buffer}const oe="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&oe.decode();let se=null;function le(){return null!==se&&0!==se.byteLength||(se=new Uint8Array(ie.memory.buffer)),se}let ce=0;let ue=null;function de(){return null!==ue&&0!==ue.byteLength||(ue=new Int32Array(ie.memory.buffer)),ue}function he(e,t,n,r,i,a){try{const d=ie.__wbindgen_add_to_stack_pointer(-16),h=function(e,t){const n=t(1*e.length,1)>>>0;return le().set(e,n/1),ce=e.length,n}(e,ie.__wbindgen_malloc),p=ce;ie.optimise_raw(d,h,p,t,n,r,i,a);var o=de()[d/4+0],s=de()[d/4+1],l=(c=o,u=s,c>>>=0,le().subarray(c/1,c/1+u)).slice();return ie.__wbindgen_free(o,1*s,1),l}finally{ie.__wbindgen_add_to_stack_pointer(16)}var c,u}async function pe(e){if(void 0!==ie)return ie;void 0===e&&(e=new URL(i(482),i.b));const t=function(){const e={wbg:{}};return e.wbg.__wbindgen_throw=function(e,t){throw new Error((n=e,r=t,n>>>=0,oe.decode(le().subarray(n,n+r))));var n,r},e}();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return function(e,t){return ie=e.exports,pe.__wbindgen_wasm_module=t,ue=null,se=null,ie}(n,r)}const fe=pe,me=void 0!==globalThis.ServiceWorkerGlobalScope&&"undefined"!=typeof self&&globalThis.caches&&void 0!==globalThis.caches.default,ge="object"==typeof process&&process.release&&"node"===process.release.name;let _e;function we(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let n="[";t>0&&(n+=we(e[0]));for(let r=1;r<t;r++)n+=", "+we(e[r]);return n+="]",n}const n=/\[object ([^\]]+)\]/.exec(toString.call(e));let r;if(!(n.length>1))return toString.call(e);if(r=n[1],"Object"==r)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:r}(me||ge)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(e,t,n){this.data=e,this.width=t,this.height=n}}),"undefined"!=typeof self&&void 0===self.location&&(self.location={href:""}));let be=0,ye=null;function ve(){return null!==ye&&0!==ye.byteLength||(ye=new Uint8Array(_e.memory.buffer)),ye}const xe="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},Ee="function"==typeof xe.encodeInto?function(e,t){return xe.encodeInto(e,t)}:function(e,t){const n=xe.encode(e);return t.set(n),{read:e.length,written:n.length}};function Ie(e,t,n){if(void 0===n){const n=xe.encode(e),r=t(n.length,1)>>>0;return ve().subarray(r,r+n.length).set(n),be=n.length,r}let r=e.length,i=t(r,1)>>>0;const a=ve();let o=0;for(;o<r;o++){const t=e.charCodeAt(o);if(t>127)break;a[i+o]=t}if(o!==r){0!==o&&(e=e.slice(o)),i=n(i,r,r=o+3*e.length,1)>>>0;const t=ve().subarray(i+o,i+r);o+=Ee(e,t).written,i=n(i,r,o,1)>>>0}return be=o,i}let ke=null;function Ce(){return(null===ke||!0===ke.buffer.detached||void 0===ke.buffer.detached&&ke.buffer!==_e.memory.buffer)&&(ke=new DataView(_e.memory.buffer)),ke}const Be="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};function ze(e,t){return e>>>=0,Be.decode(ve().subarray(e,e+t))}function Se(e,t){if(!(e instanceof t))throw new Error(`expected instance of ${t.name}`);return e.ptr}function Ae(e,t,n){Se(e,kr),_e.alter_channel(e.__wbg_ptr,t,n)}function Le(e,t){Se(e,kr),_e.alter_red_channel(e.__wbg_ptr,t)}function Re(e,t){Se(e,kr),_e.alter_green_channel(e.__wbg_ptr,t)}function Te(e,t){Se(e,kr),_e.alter_blue_channel(e.__wbg_ptr,t)}function Fe(e,t,n,r,i){Se(e,kr),_e.alter_two_channels(e.__wbg_ptr,t,n,r,i)}function Me(e,t,n,r){Se(e,kr),_e.alter_channels(e.__wbg_ptr,t,n,r)}function Pe(e,t,n){Se(e,kr),_e.remove_channel(e.__wbg_ptr,t,n)}function Ne(e,t){Se(e,kr),_e.remove_red_channel(e.__wbg_ptr,t)}function We(e,t){Se(e,kr),_e.remove_green_channel(e.__wbg_ptr,t)}function Oe(e,t){Se(e,kr),_e.remove_blue_channel(e.__wbg_ptr,t)}function De(e,t,n){Se(e,kr),_e.swap_channels(e.__wbg_ptr,t,n)}function je(e){Se(e,kr),_e.invert(e.__wbg_ptr)}function Ue(e,t,n){Se(e,kr),Se(t,Br);var r=t.__destroy_into_raw();_e.selective_hue_rotate(e.__wbg_ptr,r,n)}function $e(e,t,n,r){Se(e,kr),Se(t,Br);var i=t.__destroy_into_raw();Se(n,Br);var a=n.__destroy_into_raw();_e.selective_color_convert(e.__wbg_ptr,i,a,r)}function He(e,t,n){Se(e,kr),Se(t,Br);var r=t.__destroy_into_raw();_e.selective_lighten(e.__wbg_ptr,r,n)}function qe(e,t,n){Se(e,kr),Se(t,Br);var r=t.__destroy_into_raw();_e.selective_desaturate(e.__wbg_ptr,r,n)}function Qe(e,t,n){Se(e,kr),Se(t,Br);var r=t.__destroy_into_raw();_e.selective_saturate(e.__wbg_ptr,r,n)}function Ze(e,t){Se(e,kr);var n=e.__destroy_into_raw();Se(t,Br);var r=t.__destroy_into_raw();_e.selective_greyscale(n,r)}function Ge(e,t,n,r){Se(e,kr),_e.monochrome(e.__wbg_ptr,t,n,r)}function Xe(e){Se(e,kr),_e.sepia(e.__wbg_ptr)}function Ye(e){Se(e,kr),_e.grayscale(e.__wbg_ptr)}function Ve(e){Se(e,kr),_e.grayscale_human_corrected(e.__wbg_ptr)}function Ke(e){Se(e,kr),_e.desaturate(e.__wbg_ptr)}function Je(e){Se(e,kr),_e.decompose_min(e.__wbg_ptr)}function et(e){Se(e,kr),_e.decompose_max(e.__wbg_ptr)}function tt(e,t){Se(e,kr),_e.grayscale_shades(e.__wbg_ptr,t)}function nt(e){Se(e,kr),_e.r_grayscale(e.__wbg_ptr)}function rt(e){Se(e,kr),_e.g_grayscale(e.__wbg_ptr)}function it(e){Se(e,kr),_e.b_grayscale(e.__wbg_ptr)}function at(e,t){Se(e,kr),_e.single_channel_grayscale(e.__wbg_ptr,t)}function ot(e,t){Se(e,kr),_e.threshold(e.__wbg_ptr,t)}function st(e,t,n,r){Se(e,kr),_e.gamma_correction(e.__wbg_ptr,t,n,r)}function lt(e,t,n){Se(e,kr);const r=Ie(t,_e.__wbindgen_malloc,_e.__wbindgen_realloc),i=be;_e.hsluv(e.__wbg_ptr,r,i,n)}function ct(e,t,n){Se(e,kr);const r=Ie(t,_e.__wbindgen_malloc,_e.__wbindgen_realloc),i=be;_e.lch(e.__wbg_ptr,r,i,n)}function ut(e,t,n){Se(e,kr);const r=Ie(t,_e.__wbindgen_malloc,_e.__wbindgen_realloc),i=be;_e.hsl(e.__wbg_ptr,r,i,n)}function dt(e,t,n){Se(e,kr);const r=Ie(t,_e.__wbindgen_malloc,_e.__wbindgen_realloc),i=be;_e.hsv(e.__wbg_ptr,r,i,n)}function ht(e,t){Se(e,kr),_e.hue_rotate_hsl(e.__wbg_ptr,t)}function pt(e,t){Se(e,kr),_e.hue_rotate_hsv(e.__wbg_ptr,t)}function ft(e,t){Se(e,kr),_e.hue_rotate_lch(e.__wbg_ptr,t)}function mt(e,t){Se(e,kr),_e.hue_rotate_hsluv(e.__wbg_ptr,t)}function gt(e,t){Se(e,kr),_e.saturate_hsl(e.__wbg_ptr,t)}function _t(e,t){Se(e,kr),_e.saturate_lch(e.__wbg_ptr,t)}function wt(e,t){Se(e,kr),_e.saturate_hsluv(e.__wbg_ptr,t)}function bt(e,t){Se(e,kr),_e.saturate_hsv(e.__wbg_ptr,t)}function yt(e,t){Se(e,kr),_e.lighten_lch(e.__wbg_ptr,t)}function vt(e,t){Se(e,kr),_e.lighten_hsluv(e.__wbg_ptr,t)}function xt(e,t){Se(e,kr),_e.lighten_hsl(e.__wbg_ptr,t)}function Et(e,t){Se(e,kr),_e.lighten_hsv(e.__wbg_ptr,t)}function It(e,t){Se(e,kr),_e.darken_lch(e.__wbg_ptr,t)}function kt(e,t){Se(e,kr),_e.darken_hsluv(e.__wbg_ptr,t)}function Ct(e,t){Se(e,kr),_e.darken_hsl(e.__wbg_ptr,t)}function Bt(e,t){Se(e,kr),_e.darken_hsv(e.__wbg_ptr,t)}function zt(e,t){Se(e,kr),_e.desaturate_hsv(e.__wbg_ptr,t)}function St(e,t){Se(e,kr),_e.desaturate_hsl(e.__wbg_ptr,t)}function At(e,t){Se(e,kr),_e.desaturate_lch(e.__wbg_ptr,t)}function Lt(e,t){Se(e,kr),_e.desaturate_hsluv(e.__wbg_ptr,t)}function Rt(e,t,n){Se(e,kr),Se(t,Br);var r=t.__destroy_into_raw();_e.mix_with_colour(e.__wbg_ptr,r,n)}function Tt(e){Se(e,kr),_e.noise_reduction(e.__wbg_ptr)}function Ft(e){Se(e,kr),_e.sharpen(e.__wbg_ptr)}function Mt(e){Se(e,kr),_e.edge_detection(e.__wbg_ptr)}function Pt(e){Se(e,kr),_e.identity(e.__wbg_ptr)}function Nt(e){Se(e,kr),_e.box_blur(e.__wbg_ptr)}function Wt(e,t){Se(e,kr),_e.gaussian_blur(e.__wbg_ptr,t)}function Ot(e){Se(e,kr),_e.detect_horizontal_lines(e.__wbg_ptr)}function Dt(e){Se(e,kr),_e.detect_vertical_lines(e.__wbg_ptr)}function jt(e){Se(e,kr),_e.detect_45_deg_lines(e.__wbg_ptr)}function Ut(e){Se(e,kr),_e.detect_135_deg_lines(e.__wbg_ptr)}function $t(e){Se(e,kr),_e.laplace(e.__wbg_ptr)}function Ht(e){Se(e,kr),_e.edge_one(e.__wbg_ptr)}function qt(e){Se(e,kr),_e.emboss(e.__wbg_ptr)}function Qt(e){Se(e,kr),_e.sobel_horizontal(e.__wbg_ptr)}function Zt(e){Se(e,kr),_e.prewitt_horizontal(e.__wbg_ptr)}function Gt(e){Se(e,kr),_e.sobel_vertical(e.__wbg_ptr)}function Xt(e){Se(e,kr),_e.sobel_global(e.__wbg_ptr)}function Yt(e){Se(e,kr),_e.add_noise_rand(e.__wbg_ptr)}function Vt(e){Se(e,kr),_e.pink_noise(e.__wbg_ptr)}function Kt(e,t,n,r){Se(e,kr),Se(t,kr),_e.watermark(e.__wbg_ptr,t.__wbg_ptr,n,r)}function Jt(e,t,n){Se(e,kr),Se(t,kr);const r=Ie(n,_e.__wbindgen_malloc,_e.__wbindgen_realloc),i=be;_e.blend(e.__wbg_ptr,t.__wbg_ptr,r,i)}function en(e,t){const n=_e.create_gradient(e,t);return kr.__wrap(n)}function tn(e){Se(e,kr),_e.apply_gradient(e.__wbg_ptr)}function nn(e){Se(e,kr),_e.neue(e.__wbg_ptr)}function rn(e){Se(e,kr),_e.lix(e.__wbg_ptr)}function an(e){Se(e,kr),_e.ryo(e.__wbg_ptr)}function on(e,t){Se(e,kr);const n=Ie(t,_e.__wbindgen_malloc,_e.__wbindgen_realloc),r=be;_e.filter(e.__wbg_ptr,n,r)}function sn(e){Se(e,kr),_e.lofi(e.__wbg_ptr)}function ln(e){Se(e,kr),_e.pastel_pink(e.__wbg_ptr)}function cn(e){Se(e,kr),_e.golden(e.__wbg_ptr)}function un(e){Se(e,kr),_e.cali(e.__wbg_ptr)}function dn(e){Se(e,kr),_e.dramatic(e.__wbg_ptr)}function hn(e,t){Se(e,kr),Se(t,Br);var n=t.__destroy_into_raw();_e.monochrome_tint(e.__wbg_ptr,n)}function pn(e){Se(e,kr),_e.duotone_violette(e.__wbg_ptr)}function fn(e){Se(e,kr),_e.duotone_horizon(e.__wbg_ptr)}function mn(e,t){Se(e,kr),Se(t,Br);var n=t.__destroy_into_raw();_e.duotone_tint(e.__wbg_ptr,n)}function gn(e){Se(e,kr),_e.duotone_lilac(e.__wbg_ptr)}function _n(e){Se(e,kr),_e.duotone_ochre(e.__wbg_ptr)}function wn(e){Se(e,kr),_e.firenze(e.__wbg_ptr)}function bn(e){Se(e,kr),_e.obsidian(e.__wbg_ptr)}function yn(e,t,n,r,i){Se(e,kr);const a=_e.crop(e.__wbg_ptr,t,n,r,i);return kr.__wrap(a)}function vn(e,t,n,r,i){return _e.crop_img_browser(e,t,n,r,i)}function xn(e){Se(e,kr),_e.fliph(e.__wbg_ptr)}function En(e){Se(e,kr),_e.flipv(e.__wbg_ptr)}function In(e,t,n,r){return Se(e,kr),_e.resize_img_browser(e.__wbg_ptr,t,n,r)}function kn(e,t,n,r){Se(e,kr);const i=_e.resize(e.__wbg_ptr,t,n,r);return kr.__wrap(i)}function Cn(e,t,n){Se(e,kr);const r=_e.seam_carve(e.__wbg_ptr,t,n);return kr.__wrap(r)}function Bn(e,t){Se(e,kr);const n=_e.shearx(e.__wbg_ptr,t);return kr.__wrap(n)}function zn(e,t){Se(e,kr);const n=_e.sheary(e.__wbg_ptr,t);return kr.__wrap(n)}function Sn(e,t,n){Se(e,kr),Se(n,Sr);var r=n.__destroy_into_raw();const i=_e.padding_uniform(e.__wbg_ptr,t,r);return kr.__wrap(i)}function An(e,t,n){Se(e,kr),Se(n,Sr);var r=n.__destroy_into_raw();const i=_e.padding_left(e.__wbg_ptr,t,r);return kr.__wrap(i)}function Ln(e,t,n){Se(e,kr),Se(n,Sr);var r=n.__destroy_into_raw();const i=_e.padding_right(e.__wbg_ptr,t,r);return kr.__wrap(i)}function Rn(e,t,n){Se(e,kr),Se(n,Sr);var r=n.__destroy_into_raw();const i=_e.padding_top(e.__wbg_ptr,t,r);return kr.__wrap(i)}function Tn(e,t,n){Se(e,kr),Se(n,Sr);var r=n.__destroy_into_raw();const i=_e.padding_bottom(e.__wbg_ptr,t,r);return kr.__wrap(i)}function Fn(e,t){Se(e,kr);const n=_e.rotate(e.__wbg_ptr,t);return kr.__wrap(n)}function Mn(e,t,n){Se(e,kr);const r=_e.resample(e.__wbg_ptr,t,n);return kr.__wrap(r)}function Pn(e,t,n){Se(e,kr),_e.offset(e.__wbg_ptr,t,n)}function Nn(e,t){Se(e,kr),_e.offset_red(e.__wbg_ptr,t)}function Wn(e,t){Se(e,kr),_e.offset_green(e.__wbg_ptr,t)}function On(e,t){Se(e,kr),_e.offset_blue(e.__wbg_ptr,t)}function Dn(e,t,n,r){Se(e,kr),_e.multiple_offsets(e.__wbg_ptr,t,n,r)}function jn(e){Se(e,kr),_e.halftone(e.__wbg_ptr)}function Un(e){Se(e,kr),_e.primary(e.__wbg_ptr)}function $n(e){Se(e,kr),_e.colorize(e.__wbg_ptr)}function Hn(e){Se(e,kr),_e.solarize(e.__wbg_ptr)}function qn(e){Se(e,kr);const t=_e.solarize_retimg(e.__wbg_ptr);return kr.__wrap(t)}function Qn(e,t){Se(e,kr),_e.adjust_brightness(e.__wbg_ptr,t)}function Zn(e,t){Se(e,kr),_e.inc_brightness(e.__wbg_ptr,t)}function Gn(e,t){Se(e,kr),_e.dec_brightness(e.__wbg_ptr,t)}function Xn(e,t){Se(e,kr),_e.adjust_contrast(e.__wbg_ptr,t)}function Yn(e,t,n,r){Se(e,kr),_e.tint(e.__wbg_ptr,t,n,r)}function Vn(e,t){Se(e,kr),_e.horizontal_strips(e.__wbg_ptr,t)}function Kn(e,t,n){Se(e,kr),Se(n,Br);var r=n.__destroy_into_raw();_e.color_horizontal_strips(e.__wbg_ptr,t,r)}function Jn(e,t){Se(e,kr),_e.vertical_strips(e.__wbg_ptr,t)}function er(e,t,n){Se(e,kr),Se(n,Br);var r=n.__destroy_into_raw();_e.color_vertical_strips(e.__wbg_ptr,t,r)}function tr(e,t,n){Se(e,kr),_e.oil(e.__wbg_ptr,t,n)}function nr(e){Se(e,kr),_e.frosted_glass(e.__wbg_ptr)}function rr(e,t){Se(e,kr),_e.pixelize(e.__wbg_ptr,t)}function ir(e){Se(e,kr),_e.normalize(e.__wbg_ptr)}function ar(e,t){Se(e,kr),_e.dither(e.__wbg_ptr,t)}function or(e,t,n){Se(e,kr),Se(t,Br);var r=t.__destroy_into_raw();Se(n,Br);var i=n.__destroy_into_raw();_e.duotone(e.__wbg_ptr,r,i)}function sr(e,t,n,r,i){Se(e,kr);const a=Ie(t,_e.__wbindgen_malloc,_e.__wbindgen_realloc),o=be;_e.draw_text_with_border(e.__wbg_ptr,a,o,n,r,i)}function lr(e,t,n,r,i){Se(e,kr);const a=Ie(t,_e.__wbindgen_malloc,_e.__wbindgen_realloc),o=be;_e.draw_text(e.__wbg_ptr,a,o,n,r,i)}function cr(e,t){const n=t(1*e.length,1)>>>0;return ve().set(e,n/1),be=e.length,n}function ur(e,t){return e>>>=0,ve().subarray(e/1,e/1+t)}function dr(){const e=_e.run();if(e[1])throw function(e){const t=_e.__wbindgen_export_2.get(e);return _e.__externref_table_dealloc(e),t}(e[0])}function hr(e,t){return _e.get_image_data(e,t)}function pr(e,t,n){Se(n,kr);var r=n.__destroy_into_raw();_e.putImageData(e,t,r)}function fr(e,t){const n=_e.open_image(e,t);return kr.__wrap(n)}function mr(e){const t=_e.to_raw_pixels(e);var n=ur(t[0],t[1]).slice();return _e.__wbindgen_free(t[0],1*t[1],1),n}function gr(e){const t=Ie(e,_e.__wbindgen_malloc,_e.__wbindgen_realloc),n=be,r=_e.base64_to_image(t,n);return kr.__wrap(r)}function _r(e){const t=Ie(e,_e.__wbindgen_malloc,_e.__wbindgen_realloc),n=be,r=_e.base64_to_vec(t,n);var i=ur(r[0],r[1]).slice();return _e.__wbindgen_free(r[0],1*r[1],1),i}function wr(e){Se(e,kr);var t=e.__destroy_into_raw();return _e.to_image_data(t)}function br(e){return null==e}function yr(e){const t=_e.__externref_table_alloc();return _e.__wbindgen_export_2.set(t,e),t}function vr(e,t){try{return e.apply(this,t)}catch(e){const t=yr(e);_e.__wbindgen_exn_store(t)}}"undefined"!=typeof TextDecoder&&Be.decode();let xr=null;const Er=Object.freeze({Nearest:1,1:"Nearest",Triangle:2,2:"Triangle",CatmullRom:3,3:"CatmullRom",Gaussian:4,4:"Gaussian",Lanczos3:5,5:"Lanczos3"}),Ir="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>_e.__wbg_photonimage_free(e>>>0,1));class kr{static __wrap(e){e>>>=0;const t=Object.create(kr.prototype);return t.__wbg_ptr=e,Ir.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Ir.unregister(this),e}free(){const e=this.__destroy_into_raw();_e.__wbg_photonimage_free(e,0)}constructor(e,t,n){const r=cr(e,_e.__wbindgen_malloc),i=be,a=_e.photonimage_new(r,i,t,n);return this.__wbg_ptr=a>>>0,Ir.register(this,this.__wbg_ptr,this),this}static new_from_base64(e){const t=Ie(e,_e.__wbindgen_malloc,_e.__wbindgen_realloc),n=be,r=_e.base64_to_image(t,n);return kr.__wrap(r)}static new_from_byteslice(e){const t=cr(e,_e.__wbindgen_malloc),n=be,r=_e.photonimage_new_from_byteslice(t,n);return kr.__wrap(r)}static new_from_blob(e){const t=_e.photonimage_new_from_blob(e);return kr.__wrap(t)}static new_from_image(e){const t=_e.photonimage_new_from_image(e);return kr.__wrap(t)}get_width(){return _e.photonimage_get_width(this.__wbg_ptr)>>>0}get_raw_pixels(){const e=_e.photonimage_get_raw_pixels(this.__wbg_ptr);var t=ur(e[0],e[1]).slice();return _e.__wbindgen_free(e[0],1*e[1],1),t}get_height(){return _e.photonimage_get_height(this.__wbg_ptr)>>>0}get_base64(){let e,t;try{const n=_e.photonimage_get_base64(this.__wbg_ptr);return e=n[0],t=n[1],ze(n[0],n[1])}finally{_e.__wbindgen_free(e,t,1)}}get_bytes(){const e=_e.photonimage_get_bytes(this.__wbg_ptr);var t=ur(e[0],e[1]).slice();return _e.__wbindgen_free(e[0],1*e[1],1),t}get_bytes_jpeg(e){const t=_e.photonimage_get_bytes_jpeg(this.__wbg_ptr,e);var n=ur(t[0],t[1]).slice();return _e.__wbindgen_free(t[0],1*t[1],1),n}get_bytes_webp(){const e=_e.photonimage_get_bytes_webp(this.__wbg_ptr);var t=ur(e[0],e[1]).slice();return _e.__wbindgen_free(e[0],1*e[1],1),t}get_image_data(){return _e.photonimage_get_image_data(this.__wbg_ptr)}set_imgdata(e){_e.photonimage_set_imgdata(this.__wbg_ptr,e)}get_estimated_filesize(){const e=_e.photonimage_get_estimated_filesize(this.__wbg_ptr);return BigInt.asUintN(64,e)}}const Cr="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>_e.__wbg_rgb_free(e>>>0,1));class Br{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Cr.unregister(this),e}free(){const e=this.__destroy_into_raw();_e.__wbg_rgb_free(e,0)}constructor(e,t,n){const r=_e.rgb_new(e,t,n);return this.__wbg_ptr=r>>>0,Cr.register(this,this.__wbg_ptr,this),this}set_red(e){_e.rgb_set_red(this.__wbg_ptr,e)}set_green(e){_e.rgb_set_green(this.__wbg_ptr,e)}set_blue(e){_e.rgb_set_blue(this.__wbg_ptr,e)}get_red(){return _e.rgb_get_red(this.__wbg_ptr)}get_green(){return _e.rgb_get_green(this.__wbg_ptr)}get_blue(){return _e.rgb_get_blue(this.__wbg_ptr)}}const zr="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>_e.__wbg_rgba_free(e>>>0,1));class Sr{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,zr.unregister(this),e}free(){const e=this.__destroy_into_raw();_e.__wbg_rgba_free(e,0)}constructor(e,t,n,r){const i=_e.rgba_new(e,t,n,r);return this.__wbg_ptr=i>>>0,zr.register(this,this.__wbg_ptr,this),this}set_red(e){_e.rgb_set_red(this.__wbg_ptr,e)}set_green(e){_e.rgb_set_green(this.__wbg_ptr,e)}set_blue(e){_e.rgb_set_blue(this.__wbg_ptr,e)}set_alpha(e){_e.rgba_set_alpha(this.__wbg_ptr,e)}get_red(){return _e.rgb_get_red(this.__wbg_ptr)}get_green(){return _e.rgb_get_green(this.__wbg_ptr)}get_blue(){return _e.rgb_get_blue(this.__wbg_ptr)}get_alpha(){return _e.rgba_get_alpha(this.__wbg_ptr)}}function Ar(){const e={wbg:{}};return e.wbg.__wbg_new_abda76e883ba8a5f=function(){return new Error},e.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const n=Ie(t.stack,_e.__wbindgen_malloc,_e.__wbindgen_realloc),r=be;Ce().setInt32(e+4,r,!0),Ce().setInt32(e+0,n,!0)},e.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let n,r;try{n=e,r=t,console.error(ze(e,t))}finally{_e.__wbindgen_free(n,r,1)}},e.wbg.__wbg_instanceof_Window_c4b70662a0d2c5ec=function(e){let t;try{t=e instanceof Window}catch(e){t=!1}return t},e.wbg.__wbg_document_e5c1786dea6542e4=function(e){const t=e.document;return br(t)?0:yr(t)},e.wbg.__wbg_body_e70ae6abd01ae584=function(e){const t=e.body;return br(t)?0:yr(t)},e.wbg.__wbg_createElement_5d4c76f218b78145=function(){return vr(function(e,t,n){return e.createElement(ze(t,n))},arguments)},e.wbg.__wbg_width_4c6f0048d64cf86b=function(e){return e.width},e.wbg.__wbg_height_21f0d3fd8f753394=function(e){return e.height},e.wbg.__wbg_width_79e0847ed5883b03=function(e){return e.width},e.wbg.__wbg_height_e4e4e4779f8feac0=function(e){return e.height},e.wbg.__wbg_data_fda507064d127f5b=function(e,t){const n=cr(t.data,_e.__wbindgen_malloc),r=be;Ce().setInt32(e+4,r,!0),Ce().setInt32(e+0,n,!0)},e.wbg.__wbg_newwithu8clampedarrayandsh_1fddccb3a94a5e05=function(){return vr(function(e,t,n,r){return new ImageData((i=e,a=t,i>>>=0,(null!==xr&&0!==xr.byteLength||(xr=new Uint8ClampedArray(_e.memory.buffer)),xr).subarray(i/1,i/1+a)),n>>>0,r>>>0);var i,a},arguments)},e.wbg.__wbg_instanceof_CanvasRenderingContext2d_3abbe7ec7af32cae=function(e){let t;try{t=e instanceof CanvasRenderingContext2D}catch(e){t=!1}return t},e.wbg.__wbg_drawImage_fede06db74e39a60=function(){return vr(function(e,t,n,r){e.drawImage(t,n,r)},arguments)},e.wbg.__wbg_drawImage_f395c8e43c79a909=function(){return vr(function(e,t,n,r,i,a,o,s,l,c){e.drawImage(t,n,r,i,a,o,s,l,c)},arguments)},e.wbg.__wbg_getImageData_5e1c242046e6b59e=function(){return vr(function(e,t,n,r,i){return e.getImageData(t,n,r,i)},arguments)},e.wbg.__wbg_putImageData_a8b3e177ee06d521=function(){return vr(function(e,t,n,r){e.putImageData(t,n,r)},arguments)},e.wbg.__wbg_instanceof_HtmlCanvasElement_25d964a0dde6717e=function(e){let t;try{t=e instanceof HTMLCanvasElement}catch(e){t=!1}return t},e.wbg.__wbg_width_dc225e55343b745e=function(e){return e.width},e.wbg.__wbg_setwidth_488780db69b08846=function(e,t){e.width=t>>>0},e.wbg.__wbg_height_3a8bec2f3fe71b26=function(e){return e.height},e.wbg.__wbg_setheight_1761808c18403921=function(e,t){e.height=t>>>0},e.wbg.__wbg_getContext_fc99dbd3a9a7e318=function(){return vr(function(e,t,n){const r=e.getContext(ze(t,n));return br(r)?0:yr(r)},arguments)},e.wbg.__wbg_settextContent_f82a86a8df347e1c=function(e,t,n){e.textContent=0===t?void 0:ze(t,n)},e.wbg.__wbg_appendChild_fa3b00dade9fc4cf=function(){return vr(function(e,t){return e.appendChild(t)},arguments)},e.wbg.__wbg_newnoargs_e643855c6572a4a8=function(e,t){return new Function(ze(e,t))},e.wbg.__wbg_call_f96b398515635514=function(){return vr(function(e,t){return e.call(t)},arguments)},e.wbg.__wbg_self_b9aad7f1c618bfaf=function(){return vr(function(){return self.self},arguments)},e.wbg.__wbg_window_55e469842c98b086=function(){return vr(function(){return window.window},arguments)},e.wbg.__wbg_globalThis_d0957e302752547e=function(){return vr(function(){return globalThis.globalThis},arguments)},e.wbg.__wbg_global_ae2f87312b8987fb=function(){return vr(function(){return i.g.global},arguments)},e.wbg.__wbindgen_is_undefined=function(e){return void 0===e},e.wbg.__wbg_buffer_fcbfb6d88b2732e9=function(e){return e.buffer},e.wbg.__wbg_new_bc5d9aad3f9ac80e=function(e){return new Uint8Array(e)},e.wbg.__wbg_set_4b3aa8445ac1e91c=function(e,t,n){e.set(t,n>>>0)},e.wbg.__wbg_length_d9c4ded7e708c6a1=function(e){return e.length},e.wbg.__wbindgen_debug_string=function(e,t){const n=Ie(we(t),_e.__wbindgen_malloc,_e.__wbindgen_realloc),r=be;Ce().setInt32(e+4,r,!0),Ce().setInt32(e+0,n,!0)},e.wbg.__wbindgen_throw=function(e,t){throw new Error(ze(e,t))},e.wbg.__wbindgen_memory=function(){return _e.memory},e.wbg.__wbindgen_init_externref_table=function(){const e=_e.__wbindgen_export_2,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},e}function Lr(e,t){return _e=e.exports,Tr.__wbindgen_wasm_module=t,ke=null,ye=null,xr=null,_e.__wbindgen_start(),_e}function Rr(e){if(void 0!==_e)return _e;void 0!==e&&(Object.getPrototypeOf(e)===Object.prototype?({module:e}=e):console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));const t=Ar();return e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e)),Lr(new WebAssembly.Instance(e,t),e)}async function Tr(e){if(void 0!==_e)return _e;void 0!==e&&(Object.getPrototypeOf(e)===Object.prototype?({module_or_path:e}=e):console.warn("using deprecated parameters for the initialization function; pass a single object instead")),void 0===e&&(e=new URL(i(901),i.b));const t=Ar();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return Lr(n,r)}const Fr=Tr;var Mr=i(901);const Pr={Instagram:[{name:"Instagram Square Post (1:1)",exportWidth:1080,exportHeight:1080,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"Instagram Portrait Post (4:5)",exportWidth:1080,exportHeight:1350,resizeMode:"static_size",aspectRatio:{width:4,height:5}},{name:"Instagram Landscape Post (1.91:1)",exportWidth:1080,exportHeight:566,resizeMode:"static_size",aspectRatio:{width:191,height:100}},{name:"Instagram Story (9:16)",exportWidth:1080,exportHeight:1920,resizeMode:"static_size",aspectRatio:{width:9,height:16}},{name:"Instagram Profile Picture (1:1)",exportWidth:320,exportHeight:320,resizeMode:"static_size",aspectRatio:{width:1,height:1}}],Facebook:[{name:"Facebook Feed Landscape (1.91:1)",exportWidth:1200,exportHeight:630,resizeMode:"static_size",aspectRatio:{width:191,height:100}},{name:"Facebook Feed Square (1:1)",exportWidth:1080,exportHeight:1080,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"Facebook Feed Portrait (4:5)",exportWidth:1080,exportHeight:1350,resizeMode:"static_size",aspectRatio:{width:4,height:5}},{name:"Facebook Story (9:16)",exportWidth:1080,exportHeight:1920,resizeMode:"static_size",aspectRatio:{width:9,height:16}},{name:"Facebook Cover Photo (820x312)",exportWidth:820,exportHeight:312,resizeMode:"static_size",aspectRatio:{width:205,height:78}}],X:[{name:"X Feed Landscape (16:9)",exportWidth:1600,exportHeight:900,resizeMode:"static_size",aspectRatio:{width:16,height:9}},{name:"X Feed Square (1:1)",exportWidth:1080,exportHeight:1080,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"X Feed Portrait (4:5)",exportWidth:1080,exportHeight:1350,resizeMode:"static_size",aspectRatio:{width:4,height:5}},{name:"X Header Image (3:1)",exportWidth:1500,exportHeight:500,resizeMode:"static_size",aspectRatio:{width:3,height:1}},{name:"X Profile Picture (1:1)",exportWidth:400,exportHeight:400,resizeMode:"static_size",aspectRatio:{width:1,height:1}}],LinkedIn:[{name:"LinkedIn Feed Landscape (1.91:1)",exportWidth:1200,exportHeight:627,resizeMode:"static_size",aspectRatio:{width:191,height:100}},{name:"LinkedIn Feed Square (1:1)",exportWidth:1080,exportHeight:1080,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"LinkedIn Feed Portrait (4:5)",exportWidth:1080,exportHeight:1350,resizeMode:"static_size",aspectRatio:{width:4,height:5}},{name:"LinkedIn Profile Picture (1:1)",exportWidth:400,exportHeight:400,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"LinkedIn Cover Photo (4:1)",exportWidth:1584,exportHeight:396,resizeMode:"static_size",aspectRatio:{width:4,height:1}}],TikTok:[{name:"TikTok Vertical Video Cover (9:16)",exportWidth:1080,exportHeight:1920,resizeMode:"static_size",aspectRatio:{width:9,height:16}},{name:"TikTok Profile Picture (1:1)",exportWidth:200,exportHeight:200,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"TikTok Feed Preview (1:1)",exportWidth:1080,exportHeight:1080,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"TikTok Ad Vertical (9:16)",exportWidth:1080,exportHeight:1920,resizeMode:"static_size",aspectRatio:{width:9,height:16}},{name:"TikTok Carousel Image (4:5)",exportWidth:1080,exportHeight:1350,resizeMode:"static_size",aspectRatio:{width:4,height:5}}],Pinterest:[{name:"Pinterest Standard Pin (2:3)",exportWidth:1e3,exportHeight:1500,resizeMode:"static_size",aspectRatio:{width:2,height:3}},{name:"Pinterest Long Pin (1:2.1)",exportWidth:1e3,exportHeight:2100,resizeMode:"static_size",aspectRatio:{width:10,height:21}},{name:"Pinterest Square Pin (1:1)",exportWidth:1e3,exportHeight:1e3,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"Pinterest Profile Picture (1:1)",exportWidth:165,exportHeight:165,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"Pinterest Board Cover (1:1)",exportWidth:222,exportHeight:222,resizeMode:"static_size",aspectRatio:{width:1,height:1}}],YouTube:[{name:"YouTube Thumbnail (16:9)",exportWidth:1280,exportHeight:720,resizeMode:"static_size",aspectRatio:{width:16,height:9}},{name:"YouTube Channel Banner (16:9)",exportWidth:2560,exportHeight:1440,resizeMode:"static_size",aspectRatio:{width:16,height:9}},{name:"YouTube Profile Picture (1:1)",exportWidth:800,exportHeight:800,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"YouTube Community Post Square (1:1)",exportWidth:1080,exportHeight:1080,resizeMode:"static_size",aspectRatio:{width:1,height:1}},{name:"YouTube Community Post Landscape (16:9)",exportWidth:1200,exportHeight:675,resizeMode:"static_size",aspectRatio:{width:16,height:9}}]},Nr=[{w:1,h:1},{w:5,h:4},{w:4,h:3},{w:3,h:2},{w:7,h:5},{w:16,h:10},{w:16,h:9},{w:2,h:1},{w:21,h:9},{w:3,h:1},{w:4,h:5},{w:3,h:4},{w:2,h:3},{w:9,h:16},{w:191,h:100}],Wr={exportWidth:1920,exportHeight:1080,scalePercent:100,resizeMode:"fixed_aspect",aspectRatio:{width:16,height:9},exportFormat:"jpeg",jpegQuality:85,webpQuality:85,avifQuality:60,pngTransparency:!0,enableSharpening:!1,adaptiveSharpening:!1,sharpenAmount:120,sharpenRadius:1,sharpenThreshold:0},Or=[[1,1],[4,3],[3,2],[16,9],[16,10],[5,4],[21,9],[2,1],[3,1],[1,2],[9,16],[3,4],[2,3]];function Dr(e,t){for(e=Math.abs(e),t=Math.abs(t);t;){const n=t;t=e%t,e=n}return e}function jr(e,t,{canonical:n=Or,includePortrait:r=!0}={}){if(!Number.isFinite(e)||!Number.isFinite(t)||e<=0||t<=0)throw new Error("w and h must be positive numbers");const i=Dr(e=Math.round(e),t=Math.round(t)),a=e/i,o=t/i,s=n.some(([e,t])=>e===a&&t===o||!(!r||e!==o||t!==a));return{arW:a,arH:o,isCanonical:s,approximate:!1,label:`${a}:${o}`}}function Ur(e,t){return e&&t?jr(e,t).label:""}let $r=[],Hr=240,qr=null,Qr=16/9,Zr=!1,Gr=0,Xr=0;const Yr="batchImageProcessorPrefs",Vr="lanczos3",Kr="fixed_aspect",Jr="fixed_aspect_crop",ei="static_size",ti="fixed_width",ni="fixed_height",ri="scale_to_fit",ii="free_crop",ai="no_crop",oi="scaled",si=Kr,li=!1,ci=!1;let ui=null,di=null,hi=!1,pi=0,fi=!1,mi=0,gi=0,_i=0,wi=0,bi={imageId:null,cropChangeId:0,settingsChangeId:0,blobUrl:null,sizeBytes:null,width:null,height:null},yi=null,vi=!1,xi="",Ei=!1,Ii=!1,ki=null,Ci="none",Bi=null,zi=null,Si=null,Ai=null,Li="horizontal",Ri=si,Ti=!1,Fi=!1,Mi=!1,Pi=!0,Ni=!1,Wi=!1,Oi=!1,Di=null,ji=!1;const Ui={resize:!1,encode:!1};let $i=!1,Hi=!0,qi=null,Qi=!1;const Zi=["https://cdn.jsdelivr.net/npm/heic-to@1.4.2/dist/iife/heic-to.js","https://cdn.jsdelivr.net/npm/heic-to@1.3.0/dist/iife/heic-to.js"];let Gi=null,Xi=!1,Yi=!1,Vi=0;function Ki(){const e=(new URLSearchParams(window.location.search).get("forceFallback")||"").toLowerCase().trim();let t="";try{t=(localStorage.getItem("forceFallback")||"").toLowerCase().trim()}catch(e){t=""}const n=e||t;return n?"resize"===n||"encode"===n?n:"both"===n||"all"===n||"true"===n||"1"===n?"both":null:null}function Ji(e=!1){const t=document.getElementById("previewDelay");if(!t)return 500;const n=t.value;if("off"===n)return e?500:null;const r=parseFloat(n);return Number.isFinite(r)?Math.round(1e3*r):e?500:null}function ea(){return Ji(!1)}function ta(){const e=document.getElementById("previewDelay");if(!e)return 180;const t=e.value;if("off"===t)return 180;const n=parseFloat(t);return Number.isFinite(n)?Math.round(1e3*n):180}function na(){const e=document.getElementById("testExportBtn");e&&(hi?e.style.display="none":(e.style.display="inline-flex",e.textContent=fi?"Hide Export":"Show Export"))}async function ra(){return yi||(yi=Fr({module_or_path:Mr})),await yi,e}function ia(e){"resize"===e?Ui.resize=!0:"encode"===e&&(Ui.encode=!0),ji||(ji=!0,document.body.classList.add("has-fallback-warning"));const t=document.getElementById("fallbackWarningDetail");if(!t)return;const n=[];Ui.resize&&n.push("resize"),Ui.encode&&n.push("encode");const r=2===n.length?"resize/encode":n[0]||"processing";t.textContent=`High-quality ${r} failed, using canvas fallback (reduced quality).`}function aa(){return document.getElementById("resizeMode")?.value||si}function oa(e){return Number.isFinite(e)?Math.max(1,Math.min(400,Math.round(e))):100}function sa(){const e=document.getElementById("scalePercent");return e?oa(parseInt(e.value,10)):100}function la(e=!0){const t=document.getElementById("scalePercent");if(!t)return;const n=sa();t.value=n,function(){const e=sa();document.querySelectorAll(".scale-preset-btn").forEach(t=>{const n=parseInt(t.dataset.scale,10);t.classList.toggle("active",Number.isFinite(n)&&n===e)})}(),e&&(ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0)))}function ca(e=aa()){return e===Kr||e===Jr||e===ei}function ua(e=aa()){return e!==ai&&e!==oi}function da(e){return{settingsId:wi,cropId:e?._lastCropChangeId||0}}function ha(e,t){if(function(e,t){return!!e&&(wi!==e.settingsId||(t?._lastCropChangeId||0)!==e.cropId)}(e,t)){const e=new Error("Interrupted");throw e.code="INTERRUPTED",e}}function pa(e){if(e&&e()){const e=new Error("Cancelled");throw e.code="CANCELLED",e}}async function fa(e=1){await new Promise(t=>setTimeout(t,e))}function ma(){const e=document.getElementById("resizeEngine")?.value||"jsquash",t="photon"===e,n=document.getElementById("jsquashResizeMethod")?.value||Vr,r=parseInt(document.getElementById("photonResizeFilter")?.value,10);return{usePhotonResize:t,jsquashMethod:n,photonSamplingFilter:Number.isFinite(r)?Math.min(5,Math.max(1,r)):5,engine:e}}function ga(){const e=document.getElementById("resizeEngine"),t=document.getElementById("jsquashResizeMethod"),n=document.getElementById("photonResizeFilter"),r=document.getElementById("jsquashFilterGroup"),i=document.getElementById("photonFilterGroup");if(!e||!t||!n)return;const a="photon"===e.value;r&&(r.style.display=a?"none":"block"),i&&(i.style.display=a?"block":"none"),t.disabled=a,n.disabled=!a}function _a(e,t=aa()){if(!e)return{width:0,height:0,shouldResize:!1,crop:null};if(t===ai)return{width:e.width,height:e.height,shouldResize:!1,crop:{x:0,y:0,width:e.width,height:e.height}};if(t===oi){const t=sa(),n=Math.max(1,Math.round(e.width*t/100)),r=Math.max(1,Math.round(e.height*t/100));return{width:n,height:r,shouldResize:n!==e.width||r!==e.height,crop:{x:0,y:0,width:e.width,height:e.height}}}const n=e.crop||{x:0,y:0,width:e.width,height:e.height},r=Math.max(1,Math.round(n.width)),i=Math.max(1,Math.round(n.height)),a=r/i;if(t===ii||t===Jr)return{width:r,height:i,shouldResize:!1,crop:n};if(t===ti){const e=parseInt(document.getElementById("exportWidth").value),t=Number.isFinite(e)&&e>0?e:r;return{width:t,height:Math.max(1,Math.round(t/a)),shouldResize:!0,crop:n}}if(t===ni){const e=parseInt(document.getElementById("exportHeight").value),t=Number.isFinite(e)&&e>0?e:i;return{width:Math.max(1,Math.round(t*a)),height:t,shouldResize:!0,crop:n}}if(t===ri){const e=parseInt(document.getElementById("exportWidth").value),t=parseInt(document.getElementById("exportHeight").value),a=Number.isFinite(e)&&e>0?e:r,o=Number.isFinite(t)&&t>0?t:i,s=Math.min(a/r,o/i),l=Math.max(1,Math.round(r*s)),c=Math.max(1,Math.round(i*s));return{width:l,height:c,shouldResize:l!==r||c!==i,crop:n}}const o=parseInt(document.getElementById("exportWidth").value),s=parseInt(document.getElementById("exportHeight").value);return{width:Number.isFinite(o)&&o>0?o:r,height:Number.isFinite(s)&&s>0?s:i,shouldResize:!0,crop:n}}function wa(e,t,n=null){if(e){if(t)return e.disabled=!1,void(""===e.value&&(e.dataset.stashedValue?e.value=e.dataset.stashedValue:null!==n&&(e.value=n)));""!==e.value&&(e.dataset.stashedValue=e.value),e.value="",e.disabled=!0}}function ba(){const e=aa(),t=document.getElementById("aspectRatioSection"),n=document.getElementById("exportSizeSection"),r=document.getElementById("scaleSection"),i=document.getElementById("exportWidth"),a=document.getElementById("exportHeight"),o=Number.isFinite(Wr.exportWidth)?Wr.exportWidth:1920,s=Number.isFinite(Wr.exportHeight)?Wr.exportHeight:1080;if(t&&t.classList.toggle("collapsed",e!==Kr&&e!==Jr),n&&n.classList.toggle("collapsed",e===ai||e===oi||e===Jr||e===ii),r&&r.classList.toggle("collapsed",e!==oi),e===Kr||e===Jr||e===ei||e===ri?(wa(i,!0,o),wa(a,!0,s)):e===ti?(wa(i,!0,o),wa(a,!1,s)):e===ni?(wa(i,!1,o),wa(a,!0,s)):(wa(i,!1,o),wa(a,!1,s)),e===ei){const e=parseInt(i.value),t=parseInt(a.value);Number.isFinite(e)&&Number.isFinite(t)&&t>0&&(Qr=e/t,ro())}else if(e===Kr){ro();const e=parseInt(i.value,10),t=parseInt(a.value,10);Number.isFinite(e)&&Number.isFinite(t)&&t>0&&(Qr=e/t)}else if(e===Jr){const e=parseFloat(document.getElementById("aspectW")?.value),t=parseFloat(document.getElementById("aspectH")?.value);if(Number.isFinite(e)&&Number.isFinite(t)&&t>0){Qr=e/t;const n=parseInt(i.value,10);Number.isFinite(n)&&n>0&&(a.value=Math.round(n/Qr))}}else e===oi&&la(!1);ca(e)&&e!==Ri&&$r.forEach(e=>{e.crop=Ha(e.width,e.height)}),function(e){if(!e){const e=document.getElementById("imagesGrid");e&&e.querySelectorAll(".crop-box").forEach(e=>{e._resizeObserver&&"function"==typeof e._resizeObserver.disconnect&&e._resizeObserver.disconnect(),e.remove()});const t=document.getElementById("previewWrapper");return void(t&&t.querySelectorAll(".crop-box").forEach(e=>{e._resizeObserver&&"function"==typeof e._resizeObserver.disconnect&&e._resizeObserver.disconnect(),e.remove()}))}no()}(ua(e)),Ri=e,io()}document.getElementById("fileInput").addEventListener("change",function(e){$a(e.target.files)}),document.getElementById("aboutModal").addEventListener("click",e=>{"aboutModal"===e.target.id&&Oa()}),document.getElementById("changelogModal").addEventListener("click",e=>{"changelogModal"===e.target.id&&Da()}),window.addEventListener("beforeunload",e=>{Mi&&(e.preventDefault(),e.returnValue="Do you wish to save changes?")}),document.addEventListener("keydown",e=>{const t=e.target,n=t&&t.tagName?t.tagName.toLowerCase():"",r=Boolean(t?.isContentEditable||"input"===n||"textarea"===n||"select"===n||"button"===n);if(!("Space"!==e.code&&" "!==e.key||e.repeat||r)){if(!qr)return;const t=document.getElementById("aboutModal");if(t?.classList.contains("active"))return;e.preventDefault();const n=document.getElementById("previewPane");return n?.classList.contains("active")||Io(qr),void mo()}if("Escape"!==e.key)return;if(window.innerWidth<La){const e=document.getElementById("previewPane");if(e&&document.fullscreenElement===e)return void document.exitFullscreen();if(Wi&&e?.classList.contains("active"))return void mo()}const i=document.getElementById("changelogModal");if(i?.classList.contains("active"))return void Da();const a=document.getElementById("previewPane");!document.querySelector(".export-preview-overlay")||hi?a&&a.classList.contains("active")?Co():document.getElementById("aboutModal").classList.contains("active")&&Oa():zo()}),document.addEventListener("paste",e=>{if(!e.clipboardData||!e.clipboardData.items)return;const t=[];for(const n of e.clipboardData.items)if(n.type&&n.type.startsWith("image/")){const e=n.getAsFile();e&&t.push(e)}t.length&&$a(t)});const ya=document.getElementById("dropZone"),va=document.getElementById("gridContainer");function xa(e){e.preventDefault(),e.stopPropagation()}["dragenter","dragover","dragleave","drop"].forEach(e=>{va.addEventListener(e,xa,!1)}),["dragenter","dragover"].forEach(e=>{va.addEventListener(e,()=>{ya.classList.add("active")},!1)}),["dragleave","drop"].forEach(e=>{va.addEventListener(e,()=>{ya.classList.remove("active")},!1)}),va.addEventListener("drop",e=>{$a(e.dataTransfer.files)},!1),ya.addEventListener("click",e=>{e.preventDefault(),$r.length>0||Na()});const Ea=document.getElementById("resizer"),Ia=document.getElementById("imagesArea"),ka=document.getElementById("previewSplitResizer"),Ca=document.getElementById("previewLeft"),Ba=document.getElementById("previewSplit");let za=!1,Sa=0,Aa=0;const La=700;function Ra(e,t,n=180){const r=Math.floor((e-t)/2),i=Math.max(0,Math.min(n,r)),a=e-t-i;if(a<i){const e=Math.max(0,r);return{min:e,max:e}}return{min:i,max:a}}function Ta(e){const t=function(){const e=document.querySelector(".split-container"),t=e?.getBoundingClientRect().width||window.innerWidth,n=Ea?Ea.getBoundingClientRect().width:4,r=Math.max(0,t-n-320);let i=267;return r<i&&(i=Math.max(200,r)),{min:i,max:r}}();return Math.max(t.min,Math.min(t.max,e))}function Fa(){const e=document.getElementById("previewPane");return Boolean(e?.classList.contains("active"))}function Ma(){Ea&&Ea.classList.toggle("disabled",!Fa())}function Pa(){const e=document.getElementById("previewPane"),t=document.getElementById("previewContent");return Boolean(e?.classList.contains("active")&&t?.classList.contains("split-active"))}function Na(){document.getElementById("fileInput").click()}function Wa(){ps(),document.getElementById("aboutModal").classList.add("active")}function Oa(){document.getElementById("aboutModal").classList.remove("active"),us()}function Da(){document.getElementById("changelogModal").classList.remove("active")}function ja(e=""){return/\.(heic|heif)$/i.test(e)}function Ua(e){return!!(e&&e.type?e.type:"").toLowerCase().startsWith("image/")||ja(e&&e.name?e.name:"")}function $a(e){const t=Array.from(e).filter(Ua);if(0===t.length)return;const n=[],r=t.length;let i=t.length,a=0,o=!1;const s=++Vi,l=document.getElementById("exportProgress"),c=document.getElementById("exportProgressBar"),u=document.getElementById("exportProgressText"),d=()=>Vi===s&&!Ti,h=()=>{if(!o||!d())return;const e=r>0?Math.round(a/r*100):0;c&&(c.style.width=`${e}%`),u&&(u.textContent=`Importing images ${a}/${r}`)},p=window.setTimeout(()=>{i<=0||!d()||(o=!0,l&&l.classList.add("active"),h())},1e3);t.forEach(async e=>{try{const t=await async function(e){if(!(ja(e.name)||(e.type||"").toLowerCase().includes("heic")||(e.type||"").toLowerCase().includes("heif")))return e;try{const t=await async function(){return window.HeicTo&&"function"==typeof window.HeicTo?window.HeicTo:(Gi||(Gi=new Promise(async(e,t)=>{for(const t of Zi)try{if(await new Promise((e,n)=>{const r=document.createElement("script");r.src=t,r.async=!0,r.onload=()=>e(),r.onerror=()=>n(new Error(`Failed to load script: ${t}`)),document.head.appendChild(r)}),window.HeicTo&&"function"==typeof window.HeicTo)return void e(window.HeicTo)}catch(e){}t(new Error("Unable to load heic-to browser build"))}).catch(e=>{throw Gi=null,e})),Gi)}(),n=t&&"function"==typeof t.isHeic?t.isHeic:null;if(n&&!await n(e))return e;if(Xi||(Yi=await async function(e){try{return(await createImageBitmap(e)).close(),!0}catch(e){return!1}}(e),Xi=!0),Yi)return e;const r=await t({blob:e,type:"image/jpeg",quality:.92}),i=e.name.replace(/\.(heic|heif)$/i,".jpg");return new File([r],i,{type:"image/jpeg",lastModified:e.lastModified})}catch(t){return console.warn("HEIC fallback conversion failed; using original file.",t),e}}(e),r=await async function(e){return new Promise((t,n)=>{const r=new FileReader;r.onload=e=>t(e.target.result),r.onerror=()=>n(new Error(`Failed to read file: ${e.name}`)),r.readAsDataURL(e)})}(t),i=await async function(e){return new Promise((t,n)=>{const r=new Image;r.onload=()=>t({width:r.width,height:r.height}),r.onerror=()=>n(new Error("Failed to decode image dimensions")),r.src=e})}(r),a={id:Date.now()+Math.random(),name:e.name,src:r,file:t,width:i.width,height:i.height,crop:Ha(i.width,i.height),justAdded:!0};$r.push(a),n.push(a)}catch(t){console.warn(`Failed to load image: ${e.name}`,t)}finally{a+=1,i-=1,h(),i>0||(window.clearTimeout(p),o&&d()&&(c&&(c.style.width="100%"),u&&(u.textContent="Import complete"),((e=400)=>{o&&d()&&setTimeout(()=>{d()&&(l&&l.classList.remove("active"),c&&(c.style.width="0%"),u&&(u.textContent=""))},e)})()),qa(),Zo(),to(!0),n.length>0&&ls(!0))}}),ya&&ya.classList.add("hidden"),to(!0)}function Ha(e,t){if(!ca())return{x:0,y:0,width:e,height:t};const n=e/t,r=Number.isFinite(Qr)&&Qr>0?Qr:n;if(n>r){const n=t*r;return{x:(e-n)/2,y:0,width:n,height:t}}{const n=e/r;return{x:0,y:(t-n)/2,width:e,height:n}}}function qa(){const e=document.getElementById("imagesGrid");e.innerHTML="",Ho(),$r.forEach(t=>{const n=function(e){const t=document.createElement("div");t.className="image-card",e.justAdded&&(t.classList.add("animate-in"),t.addEventListener("animationend",()=>{t.classList.remove("animate-in")},{once:!0})),t.dataset.imageId=e.id,qr===e.id&&t.classList.add("selected");const n=document.createElement("div");n.className="image-preview-container";const r=document.createElement("div");r.className="image-preview-wrapper";const i=document.createElement("div");i.style.position="relative",i.style.width="100%",i.style.height="100%",i.style.lineHeight="0";const a=document.createElement("img");a.className="image-preview",a.style.transform="scale(1)",a.style.position="relative",i.appendChild(a),a.onload=()=>{Ja(i,a,e,!1)},a.src=e.src,a.complete&&a.naturalWidth>0&&requestAnimationFrame(()=>{Ja(i,a,e,!1)}),r.appendChild(i),n.appendChild(r);const o=document.createElement("div");o.className="image-name",o.onclick=()=>Io(e.id);const s=document.createElement("span");s.className="image-name-text",s.innerHTML=Za(e);const l=document.createElement("button");return l.className="image-remove-btn",l.title="Remove image",l.textContent="",l.onclick=t=>{t.stopPropagation(),function(e){$r=$r.filter(t=>t.id!==e);const t=document.getElementById("imagesGrid");if(t){const n=t.querySelector(`[data-image-id="${e}"]`);n&&n.remove()}qr===e&&(qr=null,zo(),Co(),hi&&po(!1)),Zo(),0===$r.length&&(ya&&ya.classList.remove("hidden"),to(),Bo()),ls(!0)}(e.id)},o.appendChild(s),o.appendChild(l),t.appendChild(n),t.appendChild(o),t}(t);e.appendChild(n),t.justAdded=!1}),Xa(),to(),Ya()}function Qa(){qi&&clearTimeout(qi),qi=setTimeout(()=>{qi=null,function(){if(0===$r.length)return;const e=document.getElementById("gridContainer"),t=e?e.scrollTop:0,n=e?e.scrollLeft:0;qa(),e&&(e.scrollTop=t,e.scrollLeft=n),eo()}()},120)}function Za(e){if(!e)return"";const t=(n=e.name,String(n??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"));var n;if(!$i)return t;const{width:r,height:i}=_a(e),a=e.width,o=e.height;return Number.isFinite(r)&&Number.isFinite(i)?`${a}<span class="image-dimensions-x">x</span>${o}<span class="image-dimensions-x">-></span>${r}<span class="image-dimensions-x">x</span>${i} ${t}`:t}function Ga(e){const t=document.getElementById("imagesGrid");if(!t||!e)return;const n=t.querySelector(`[data-image-id="${e.id}"]`);if(!n)return;const r=n.querySelector(".image-name-text");r&&(r.innerHTML=Za(e))}function Xa(){const e=document.getElementById("gridInfoToggle");e&&(e.classList.toggle("active",$i),e.setAttribute("aria-pressed",String($i)),e.title=$i?"Show filenames":"Show size info"),$r.forEach(e=>Ga(e))}function Ya(){const e=document.getElementById("filenameTip");if(!e)return;const t=Hi&&$r.length>0&&!vi;e.classList.toggle("hidden",!t),t&&Va()}function Va(){const e=document.getElementById("filenameTip"),t=document.getElementById("imagesGrid"),n=document.getElementById("gridContainer");if(!e||!t||!n)return;const r=t.querySelector(".image-card");if(!r)return void e.classList.add("hidden");const i=r.querySelector(".image-name");if(!i)return void e.classList.add("hidden");e.classList.remove("hidden");const a=n.getBoundingClientRect(),o=r.getBoundingClientRect(),s=i.getBoundingClientRect(),l=o.bottom-a.top+8+n.scrollTop,c=s.left-a.left+n.scrollLeft,u=e.offsetWidth||260,d=n.clientWidth||a.width,h=Math.max(12,Math.min(c,d-u-12));e.style.top=`${Math.round(l)}px`,e.style.left=`${Math.round(h)}px`;const p=s.left-a.left+s.width/2+n.scrollLeft,f=Math.max(16,Math.min(u-16,p-h));e.style.setProperty("--arrow-left",`${Math.round(f)}px`)}function Ka(){const e=document.getElementById("resizeModeInfoText");if(!e)return;const t=function(e=aa()){switch(e){case Kr:return"Export size locked to aspect ratio.";case Jr:return"Fixed aspect ratio crop at 100% (no resize).";case ei:return"Force exact output dimensions.";case ti:return"Lock width; height derives from crop.";case ni:return"Lock height; width derives from crop.";case ri:return"Resize to fit within max width/height; crop freely.";case ii:return"Crop freely; no resize.";case oi:return"Scale by percent; no crop overlay.";case ai:return"Convert only; no crop or resize.";default:return""}}();e.textContent=t||" "}function Ja(e,t,n,r){if(!ua())return;if(!e||e.querySelector(".crop-box"))return;const i=function(e,t=!1){const n=document.createElement("div");return n.className="crop-box",go(n,e,t),["nw","ne","sw","se"].forEach(r=>{const i=document.createElement("div");i.className=`crop-handle ${r}`,n.appendChild(i),function(e,t,n,r){let i,a,o,s=!1,l=!1,c=0,u=null,d=null;e.addEventListener("mousedown",n=>{s=!0,l=!1,c=0,e.classList.add("dragging"),i=n.clientX,a=n.clientY,o={...t.crop},n.preventDefault(),n.stopPropagation()}),e.addEventListener("pointerdown",n=>{"mouse"!==n.pointerType&&(d&&"pointer"!==d||(s=!0,l=!1,c=0,u=n.pointerId,d="pointer",e.classList.add("dragging"),i=n.clientX,a=n.clientY,o={...t.crop},e.setPointerCapture?.(n.pointerId),n.preventDefault(),n.stopPropagation()))}),e.addEventListener("touchstart",n=>{if(d&&"touch"!==d)return;const r=n.touches?.[0];r&&(s=!0,l=!1,c=0,u=null,d="touch",e.classList.add("dragging"),i=r.clientX,a=r.clientY,o={...t.crop},n.preventDefault(),n.stopPropagation())},{passive:!1}),document.addEventListener("mousemove",u=>{if(!s)return;if(d&&"mouse"!==d)return;const h=e.parentElement,p=h.parentElement,f=(p.querySelector(".image-preview, .preview-image"),_o(p,t));if(!f)return;const{scale:m}=f,g=(u.clientX-i)/m,_=(u.clientY-a)/m;let w={...o};n.includes("n")&&(w.y=o.y+_,w.height=o.height-_),n.includes("s")&&(w.height=o.height+_),n.includes("w")&&(w.x=o.x+g,w.width=o.width-g),n.includes("e")&&(w.width=o.width+g),ca()&&(w=Eo(w,o,n,t,Qr)),w=yo(w,t),w.width>20&&w.height>20&&(t.crop=w,w.x===o.x&&w.y===o.y&&w.width===o.width&&w.height===o.height||(l=!0,c=++_i,t._lastCropChangeId=c),go(h,t,r),r?(bo(t),l&&No({preserveImage:!0},ea(),c)):(qr===t.id&&wo(t),l&&qr===t.id&&No({preserveImage:!0},ea(),c)))}),document.addEventListener("pointermove",h=>{if("mouse"===h.pointerType)return;if(!s)return;if(null!==u&&h.pointerId!==u)return;if(d&&"pointer"!==d)return;const p=e.parentElement,f=p.parentElement,m=(f.querySelector(".image-preview, .preview-image"),_o(f,t));if(!m)return;const{scale:g}=m,_=(h.clientX-i)/g,w=(h.clientY-a)/g;let b={...o};n.includes("n")&&(b.y=o.y+w,b.height=o.height-w),n.includes("s")&&(b.height=o.height+w),n.includes("w")&&(b.x=o.x+_,b.width=o.width-_),n.includes("e")&&(b.width=o.width+_),ca()&&(b=Eo(b,o,n,t,Qr)),b=yo(b,t),b.width>20&&b.height>20&&(t.crop=b,b.x===o.x&&b.y===o.y&&b.width===o.width&&b.height===o.height||(l=!0,c=++_i,t._lastCropChangeId=c),go(p,t,r),r?(bo(t),l&&No({preserveImage:!0},ea(),c)):(qr===t.id&&wo(t),l&&qr===t.id&&No({preserveImage:!0},ea(),c)))}),document.addEventListener("touchmove",u=>{if(!s)return;if("touch"!==d)return;const h=u.touches?.[0];if(!h)return;const p=e.parentElement,f=p.parentElement,m=(f.querySelector(".image-preview, .preview-image"),_o(f,t));if(!m)return;const{scale:g}=m,_=(h.clientX-i)/g,w=(h.clientY-a)/g;let b={...o};n.includes("n")&&(b.y=o.y+w,b.height=o.height-w),n.includes("s")&&(b.height=o.height+w),n.includes("w")&&(b.x=o.x+_,b.width=o.width-_),n.includes("e")&&(b.width=o.width+_),ca()&&(b=Eo(b,o,n,t,Qr)),b=yo(b,t),b.width>20&&b.height>20&&(t.crop=b,b.x===o.x&&b.y===o.y&&b.width===o.width&&b.height===o.height||(l=!0,c=++_i,t._lastCropChangeId=c),go(p,t,r),r?(bo(t),l&&No({preserveImage:!0},ea(),c)):(qr===t.id&&wo(t),l&&qr===t.id&&No({preserveImage:!0},ea(),c))),u.preventDefault()},{passive:!1}),document.addEventListener("mouseup",()=>{s&&(s=!1,u=null,d=null,e.classList.remove("dragging"),r?(bo(t),l&&(t._lastCropChangeId||0)>mi&&No({preserveImage:!0},ta(),t._lastCropChangeId||0)):(wo(t),l&&qr===t.id&&(t._lastCropChangeId||0)>mi&&No({preserveImage:!0},ta(),t._lastCropChangeId||0)))}),document.addEventListener("pointerup",n=>{"mouse"!==n.pointerType&&s&&(null!==u&&n.pointerId!==u||d&&"pointer"!==d||(s=!1,u=null,d=null,e.classList.remove("dragging"),r?(bo(t),l&&(t._lastCropChangeId||0)>mi&&No({preserveImage:!0},ta(),t._lastCropChangeId||0)):(wo(t),l&&qr===t.id&&(t._lastCropChangeId||0)>mi&&No({preserveImage:!0},ta(),t._lastCropChangeId||0))))}),document.addEventListener("pointercancel",t=>{"mouse"!==t.pointerType&&s&&(null!==u&&t.pointerId!==u||(s=!1,u=null,d=null,e.classList.remove("dragging")))}),document.addEventListener("touchend",()=>{s&&"touch"===d&&(s=!1,u=null,d=null,e.classList.remove("dragging"),r?(bo(t),l&&(t._lastCropChangeId||0)>mi&&No({preserveImage:!0},ta(),t._lastCropChangeId||0)):(wo(t),l&&qr===t.id&&(t._lastCropChangeId||0)>mi&&No({preserveImage:!0},ta(),t._lastCropChangeId||0)))}),document.addEventListener("touchcancel",()=>{s&&"touch"===d&&(s=!1,u=null,d=null,e.classList.remove("dragging"))})}(i,e,r,t)}),function(e,t,n){let r,i,a,o,s=!1,l=!1,c=0,u=null,d=null;e.addEventListener("mousedown",e=>{e.target.classList.contains("crop-handle")||(s=!0,l=!1,c=0,r=e.clientX,i=e.clientY,a=t.crop.x,o=t.crop.y,e.preventDefault())}),e.addEventListener("pointerdown",n=>{"mouse"!==n.pointerType&&(n.target.classList.contains("crop-handle")||d&&"pointer"!==d||(s=!0,l=!1,c=0,u=n.pointerId,d="pointer",r=n.clientX,i=n.clientY,a=t.crop.x,o=t.crop.y,e.setPointerCapture?.(n.pointerId),n.preventDefault()))}),e.addEventListener("touchstart",e=>{if(e.target.classList.contains("crop-handle"))return;if(d&&"touch"!==d)return;const n=e.touches?.[0];n&&(s=!0,l=!1,c=0,u=null,d="touch",r=n.clientX,i=n.clientY,a=t.crop.x,o=t.crop.y,e.preventDefault())},{passive:!1}),document.addEventListener("mousemove",u=>{if(!s)return;if(d&&"mouse"!==d)return;const h=e.parentElement,p=(h.querySelector(".image-preview, .preview-image"),_o(h,t));if(!p)return;const{scale:f}=p,m=(u.clientX-r)/f,g=(u.clientY-i)/f;let _=a+m,w=o+g;_=Math.max(0,Math.min(_,t.width-t.crop.width)),w=Math.max(0,Math.min(w,t.height-t.crop.height)),t.crop.x=_,t.crop.y=w,_===a&&w===o||(l=!0,c=++_i,t._lastCropChangeId=c),go(e,t,n),n?(bo(t),l&&No({preserveImage:!0},ea(),c)):(qr===t.id&&wo(t),l&&qr===t.id&&No({preserveImage:!0},ea(),c))}),document.addEventListener("pointermove",h=>{if("mouse"===h.pointerType)return;if(!s)return;if(null!==u&&h.pointerId!==u)return;if(d&&"pointer"!==d)return;const p=e.parentElement,f=(p.querySelector(".image-preview, .preview-image"),_o(p,t));if(!f)return;const{scale:m}=f,g=(h.clientX-r)/m,_=(h.clientY-i)/m;let w=a+g,b=o+_;w=Math.max(0,Math.min(w,t.width-t.crop.width)),b=Math.max(0,Math.min(b,t.height-t.crop.height)),t.crop.x=w,t.crop.y=b,w===a&&b===o||(l=!0,c=++_i,t._lastCropChangeId=c),go(e,t,n),n?(bo(t),l&&No({preserveImage:!0},ea(),c)):(qr===t.id&&wo(t),l&&qr===t.id&&No({preserveImage:!0},ea(),c))}),document.addEventListener("touchmove",u=>{if(!s)return;if("touch"!==d)return;const h=u.touches?.[0];if(!h)return;const p=e.parentElement,f=(p.querySelector(".image-preview, .preview-image"),_o(p,t));if(!f)return;const{scale:m}=f,g=(h.clientX-r)/m,_=(h.clientY-i)/m;let w=a+g,b=o+_;w=Math.max(0,Math.min(w,t.width-t.crop.width)),b=Math.max(0,Math.min(b,t.height-t.crop.height)),t.crop.x=w,t.crop.y=b,w===a&&b===o||(l=!0,c=++_i,t._lastCropChangeId=c),go(e,t,n),n?(bo(t),l&&No({preserveImage:!0},ea(),c)):(qr===t.id&&wo(t),l&&qr===t.id&&No({preserveImage:!0},ea(),c)),u.preventDefault()},{passive:!1}),document.addEventListener("mouseup",()=>{s&&(s=!1,u=null,d=null,n?(bo(t),l&&(t._lastCropChangeId||0)>mi&&No({preserveImage:!0},ta(),t._lastCropChangeId||0)):(wo(t),l&&qr===t.id&&(t._lastCropChangeId||0)>mi&&No({preserveImage:!0},ta(),t._lastCropChangeId||0)))}),document.addEventListener("pointerup",e=>{"mouse"!==e.pointerType&&s&&(null!==u&&e.pointerId!==u||d&&"pointer"!==d||(s=!1,u=null,d=null,n?(bo(t),l&&(t._lastCropChangeId||0)>mi&&No({preserveImage:!0},ta(),t._lastCropChangeId||0)):(wo(t),l&&qr===t.id&&(t._lastCropChangeId||0)>mi&&No({preserveImage:!0},ta(),t._lastCropChangeId||0))))}),document.addEventListener("pointercancel",e=>{"mouse"!==e.pointerType&&s&&(null!==u&&e.pointerId!==u||(s=!1,u=null,d=null))}),document.addEventListener("touchend",e=>{s&&"touch"===d&&(s=!1,u=null,d=null,n?(bo(t),l&&(t._lastCropChangeId||0)>mi&&No({preserveImage:!0},ta(),t._lastCropChangeId||0)):(wo(t),l&&qr===t.id&&(t._lastCropChangeId||0)>mi&&No({preserveImage:!0},ta(),t._lastCropChangeId||0)))}),document.addEventListener("touchcancel",()=>{s&&"touch"===d&&(s=!1,u=null,d=null)})}(n,e,t),n}(n,r);if(e.appendChild(i),requestAnimationFrame(()=>{go(i,n,r)}),"undefined"!=typeof ResizeObserver){const e=new ResizeObserver(()=>{go(i,n,r)});e.observe(t),i._resizeObserver=e}}function eo(){const e=document.getElementById("imagesGrid");e&&e.querySelectorAll(".image-card").forEach(e=>{const t=Number(e.dataset.imageId);qr&&t===qr?e.classList.add("selected"):e.classList.remove("selected")})}function to(e=!1){const t=document.getElementById("imagesGrid"),n=document.getElementById("dropZone");t&&(t.style.display=vi?"none":"grid"),n&&(n.style.display=vi?"none":"",n.classList.toggle("hidden",e||$r.length>0))}function no(){if(ua()&&($r.forEach(e=>function(e){if(!ua())return;const t=document.getElementById("imagesGrid");if(!t)return;const n=t.querySelector(`[data-image-id="${e.id}"]`);if(!n)return;const r=n.querySelector(".image-preview");if(!r)return;const i=r.parentElement;if(!i)return;i.querySelector(".crop-box")||Ja(i,r,e,!1);const a=i.querySelector(".crop-box");a&&go(a,e,!1)}(e)),qr)){const e=document.getElementById("previewWrapper");if(!e)return;const t=$r.find(e=>e.id===qr);if(!t)return;const n=e.querySelector(".preview-image"),r=n?n.parentElement:null;n&&r&&!r.querySelector(".crop-box")&&Ja(r,n,t,!0);const i=e.querySelector(".crop-box");i&&go(i,t,!0)}}function ro(){const e=document.getElementById("aspectW"),t=document.getElementById("aspectH");if(!e||!t)return;const n=parseInt(document.getElementById("exportWidth").value),r=parseInt(document.getElementById("exportHeight").value);if(Number.isFinite(n)&&Number.isFinite(r)&&0!==r){const{arW:i,arH:a}=jr(n,r);parseFloat(e.value)!==i&&(e.value=i),parseFloat(t.value)!==a&&(t.value=a),hs(0,i,a)}io()}function io(){const e=document.getElementById("aspectMismatchWarning"),t=document.getElementById("aspectRoundingInfo");if(!e||!t)return;const{mismatch:n,rounded:r}=function(){if(aa()!==Kr)return{mismatch:!1,rounded:!1,classification:"exact"};const e=parseInt(document.getElementById("exportWidth")?.value,10),t=parseInt(document.getElementById("exportHeight")?.value,10),n=parseFloat(document.getElementById("aspectW")?.value),r=parseFloat(document.getElementById("aspectH")?.value);if(!Number.isFinite(e)||!Number.isFinite(t)||e<=0||t<=0)return{mismatch:!1,rounded:!1,classification:"exact"};if(!Number.isFinite(n)||!Number.isFinite(r)||n<=0||r<=0)return{mismatch:!1,rounded:!1,classification:"exact"};const i=function(e,t,n,r,i=1){const a=Dr(n,r),o=n/a,s=r/a;if(e*s===t*o)return"exact";const l=t*o/s,c=e-Math.round(l);if(Math.abs(c)<=i)return c>0?"rounded_up_width":"rounded_down_width";const u=e*s/o,d=t-Math.round(u);return Math.abs(d)<=i?d>0?"rounded_up_height":"rounded_down_height":"different"}(e,t,Math.round(n),Math.round(r));return{mismatch:"different"===i,rounded:i.startsWith("rounded_"),classification:i}}();e.classList.toggle("visible",n),t.classList.toggle("visible",r)}function ao(){const e=parseInt(document.getElementById("exportWidth").value),t=parseInt(document.getElementById("exportHeight").value);!Number.isFinite(e)||!Number.isFinite(t)||t<=0||(Qr=e/t,$r.forEach(e=>{e.crop=Ha(e.width,e.height)}),no(),io())}function oo(){const e=aa();if(e!==Kr&&e!==Jr)return;const t=parseFloat(document.getElementById("aspectW").value),n=parseFloat(document.getElementById("aspectH").value);if(Number.isFinite(t)&&Number.isFinite(n)&&!(n<=0)){if(Qr=t/n,$r.forEach(e=>{e.crop=Ha(e.width,e.height)}),e===Kr||e===Jr){const e=parseInt(document.getElementById("exportWidth").value,10);if(Number.isFinite(e)&&e>0){const t=Math.round(e/Qr);document.getElementById("exportHeight").value=t}}hs(0,t,n),io(),ds({aspectRatio:{width:t,height:n}}),Wo(),ts(),no(),No({preserveImage:!0},Ji(!0))}}function so(){const e=document.getElementById("previewLayoutSingle"),t=document.getElementById("previewLayoutHorizontal"),n=document.getElementById("previewLayoutVertical");e&&(e.classList.toggle("active",!hi),e.setAttribute("aria-pressed",String(!hi))),t&&(t.classList.toggle("active",hi&&"horizontal"===Li),t.setAttribute("aria-pressed",String(hi&&"horizontal"===Li))),n&&(n.classList.toggle("active",hi&&"vertical"===Li),n.setAttribute("aria-pressed",String(hi&&"vertical"===Li)))}function lo(){const e=document.getElementById("previewFullscreenBtn");if(!e)return;const t=Boolean(document.fullscreenElement)||Wi;e.classList.toggle("active",t),e.textContent=t?"":"",e.title=t?"Exit full preview (spacebar)":"Expand preview (spacebar)"}function co(){const e=document.getElementById("previewPane");return Boolean(Wi||e&&document.fullscreenElement===e)}function uo(e){if(!hi||!Ca||!Ba)return;if("vertical"===Li){const t=Ra(Ba.getBoundingClientRect().height,ka?ka.getBoundingClientRect().height:6),n=Ca.getBoundingClientRect().height;if(!Number.isFinite(n)||n<=0)return;const r=Math.max(t.min,Math.min(t.max,n));return void(e?Ai=r:zi=r)}const t=Ra(Ba.getBoundingClientRect().width,ka?ka.getBoundingClientRect().width:6),n=Ca.getBoundingClientRect().width;if(!Number.isFinite(n)||n<=0)return;const r=Math.max(t.min,Math.min(t.max,n));e?Si=r:Bi=r}function ho(){if(!hi||!Ca||!Ba)return;const e=co();if("vertical"===Li){const t=Ba.getBoundingClientRect().height,n=ka?ka.getBoundingClientRect().height:6,r=Ra(t,n);let i;if(e&&Oi)i=Math.floor((t-n)/2),Ai=i,Oi=!1;else{const r=e?Ai:zi,a=Ca.getBoundingClientRect().height,o=Number.isFinite(a)&&a>0?a:null;i=r??o??Math.floor((t-n)/2)}i=Math.max(r.min,Math.min(r.max,i)),Ca.style.flex=`0 0 ${i}px`}else{const t=Ba.getBoundingClientRect().width,n=ka?ka.getBoundingClientRect().width:6,r=Ra(t,n);let i;if(e&&Oi)i=Math.floor((t-n)/2),Si=i,Oi=!1;else{const r=e?Si:Bi,a=Ca.getBoundingClientRect().width,o=Number.isFinite(a)&&a>0?a:null;i=r??o??Math.floor((t-n)/2)}i=Math.max(r.min,Math.min(r.max,i)),Ca.style.flex=`0 0 ${i}px`}}function po(e,t=!1,n=Li){hi=e,e&&(Li="vertical"===n?"vertical":"horizontal"),pi+=1;const r=document.getElementById("previewContent");if(r&&(r.classList.toggle("split-active",e),r.classList.toggle("split-vertical",e&&"vertical"===Li)),na(),so(),e){if(ho(),t||(Ci="vertical"===Li?"split-vertical":"split-horizontal",us({lastExportPreviewMode:Ci})),So(),qr){const e=$r.find(e=>e.id===qr);e&&Po(e,{preserveImage:!0})}}else zo(t),Ca&&(Ca.style.flex=""),t||(Ci=Ci.startsWith("split")?"none":Ci,us({lastExportPreviewMode:Ci}));Do()}function fo(e,t=!1){if("single"===e){if(!hi)return;return void po(!1,t)}const n="split-vertical"===e?"vertical":"horizontal";hi&&Li===n||po(!0,t,n)}function mo(){const e=document.getElementById("previewPane");if(!e||!e.classList.contains("active"))return Wi=!1,document.body.classList.remove("preview-fullscreen"),void lo();if(document.fullscreenElement)return void(document.fullscreenElement===e&&(uo(!0),document.exitFullscreen()));if(e.requestFullscreen)return uo(!1),Oi=!0,Si=null,Ai=null,void e.requestFullscreen().catch(()=>{const e=Wi;uo(!!e),Wi=!Wi,document.body.classList.toggle("preview-fullscreen",Wi),lo(),Do(),ho(),!e&&Wi&&(Oi=!0,Si=null,Ai=null,uo(!0))});const t=Wi;uo(!!t),Wi=!Wi,document.body.classList.toggle("preview-fullscreen",Wi),Wi&&(Oi=!0,Si=null,Ai=null),lo(),ho(),Do(),!t&&Wi&&uo(!0)}function go(e,t,n){const r=e.parentElement;if(!r)return;const i=r.querySelector(".image-preview, .preview-image");if(!i)return;if(!i.complete||0===i.naturalWidth)return void setTimeout(()=>go(e,t,n),50);const a=_o(r,t);if(!a)return void requestAnimationFrame(()=>go(e,t,n));const{scale:o,offsetX:s,offsetY:l}=a;e.style.position="absolute",e.style.left=`${s+t.crop.x*o}px`,e.style.top=`${l+t.crop.y*o}px`,e.style.width=t.crop.width*o+"px",e.style.height=t.crop.height*o+"px",!n&&$i&&Ga(t)}function _o(e,t){const n=e.getBoundingClientRect(),r=n.width,i=n.height;if(!r||!i)return null;const a=t.width/t.height;let o,s;return a>r/i?(o=r,s=r/a):(s=i,o=i*a),{scale:o/t.width,offsetX:(r-o)/2,offsetY:(i-s)/2}}function wo(e){if(!qr||qr!==e.id)return;const t=document.getElementById("previewWrapper");if(!t)return;const n=t.querySelector(".crop-box");n&&go(n,e,!0)}function bo(e){const t=document.getElementById("imagesGrid");if(!t)return;const n=t.querySelector(`[data-image-id="${e.id}"]`);if(!n)return;const r=n.querySelector(".crop-box");r&&go(r,e,!1)}function yo(e,t){const n={...e};return n.x<0&&(n.width+=n.x,n.x=0),n.y<0&&(n.height+=n.y,n.y=0),n.x+n.width>t.width&&(n.width=t.width-n.x),n.y+n.height>t.height&&(n.height=t.height-n.y),n}function vo(e,t,n,r){const i=e.crop||{x:0,y:0,width:e.width,height:e.height},a=20,o=i.x+i.width/2,s=i.y+i.height/2;let l=i.width+2*t*n,c=i.height+2*t*n;if(r)if(r>=1){const e=Math.max(a,a*r);l=Math.max(e,l),c=l/r}else{const e=Math.max(a,a/r);c=Math.max(e,c),l=c*r}else l=Math.max(a,l),c=Math.max(a,c);let u={x:o-l/2,y:s-c/2,width:l,height:c};return u=r?function(e,t,n){const r={...e},i=t.width,a=t.height;return r.width>i&&(r.width=i,r.height=r.width/n),r.height>a&&(r.height=a,r.width=r.height*n),r.width>i&&(r.width=i,r.height=r.width/n),r.x=Math.max(0,Math.min(r.x,t.width-r.width)),r.y=Math.max(0,Math.min(r.y,t.height-r.height)),r}(u,e,r):yo(u,e),u}function xo(){const e=document.getElementById("previewFooter");if(!e)return;const t=document.getElementById("previewPane"),n=Boolean(t?.classList.contains("active")&&qr&&ua());e.classList.toggle("hidden",!n)}function Eo(e,t,n,r,i){const a={...e},o=n.includes("w"),s=n.includes("n"),l=n.includes("e"),c=n.includes("s");return o&&(a.width=t.x+t.width-a.x),s&&(a.height=t.y+t.height-a.y),l||o?(a.height=a.width/i,s&&(a.y=t.y+t.height-a.height)):(c||s)&&(a.width=a.height*i,o&&(a.x=t.x+t.width-a.width)),a.x<0&&(a.x=0,a.width=t.x+t.width,a.height=a.width/i),a.y<0&&(a.y=0,a.height=t.y+t.height,a.width=a.height*i),a.x+a.width>r.width&&(a.width=r.width-a.x,a.height=a.width/i,s&&(a.y=t.y+t.height-a.height)),a.y+a.height>r.height&&(a.height=r.height-a.y,a.width=a.height*i,o&&(a.x=t.x+t.width-a.width)),a}function Io(e){qr=e;const t=$r.find(t=>t.id===e),n=document.getElementById("previewPane"),r=document.getElementById("previewWrapper"),i=document.getElementById("previewTitle"),a=document.querySelector(".export-preview-overlay");if(!t)return void Bo();if(!n||!r||!i)return;di&&(clearTimeout(di),di=null),n.classList.add("active"),document.body.classList.add("preview-active"),Ma(),lo(),i.dataset.baseTitle=t.name,i.textContent=t.name,r.innerHTML="";const o=document.createElement("div");o.style.position="relative",o.style.display="block",o.style.lineHeight="0",o.style.width="100%",o.style.height="100%";const s=document.createElement("img");s.className="preview-image",s.style.width="100%",s.style.height="100%",s.style.objectFit="contain",s.style.position="relative",o.appendChild(s),r.appendChild(o),s.onload=()=>{Ja(o,s,t,!0),requestAnimationFrame(()=>{const e=o.querySelector(".crop-box");e&&go(e,t,!0),Do()})},s.src=t.src,s.complete&&s.naturalWidth>0&&requestAnimationFrame(()=>{Ja(o,s,t,!0)}),eo(),xo();const l=window.innerWidth<La;if(Ni=l,l&&(hi&&po(!1,!0),co()||mo()),("split"===Ci||"split-horizontal"===Ci||"split-vertical"===Ci)&&!l){const e="split-vertical"===Ci?"vertical":"horizontal";return hi&&Li===e?void Po(t,{preserveImage:!0}):void po(!0,!0,e)}"full"===Ci?(hi&&po(!1,!0),Po(t,{preserveImage:!0})):(hi||a)&&Po(t,{preserveImage:!0})}function ko(e=!1){document.getElementById("previewPane").classList.remove("active"),document.body.classList.remove("preview-active"),Ma(),qr=null,Ni=!1,Wi=!1,document.body.classList.remove("preview-fullscreen"),lo(),pi+=1,di&&(clearTimeout(di),di=null),fi=!1,na();const t=hi;if(!e)if(t)po(!1),Ci="vertical"===Li?"split-vertical":"split-horizontal";else{hi=!1;const e=document.getElementById("previewContent");e&&(e.classList.remove("split-active"),e.classList.remove("split-vertical")),na(),so(),Ci="none"}if(t){const e=document.getElementById("exportPreviewHost");e&&(e.innerHTML="")}hi=!1,Ca&&(Ca.style.flex=""),Ia&&(Ia.style.flex="");const n=document.getElementById("previewContent");n&&(n.classList.remove("split-active"),n.classList.remove("split-vertical")),eo(),xo()}function Co(e=!1){const t=document.getElementById("previewPane");if(document.fullscreenElement&&document.fullscreenElement===t)return Di={skipSplitReset:e},void document.exitFullscreen().catch(()=>{const e=Di;Di=null,ko(Boolean(e?.skipSplitReset))});ko(e)}function Bo(){const e=document.getElementById("previewPane"),t=document.getElementById("previewContent"),n=document.getElementById("previewWrapper"),r=document.getElementById("exportPreviewHost"),i=document.querySelector(".export-preview-overlay");i&&i.remove(),r&&(r.innerHTML=""),n&&(n.innerHTML=""),e&&e.classList.remove("active"),document.body.classList.remove("preview-active"),t&&(t.classList.remove("split-active"),t.classList.remove("split-vertical")),Ca&&(Ca.style.flex=""),Ia&&(Ia.style.flex=""),hi=!1,fi=!1,Ci="none",qr=null,Ni=!1,Ma(),na(),so(),xo(),ds({lastExportPreviewMode:"none"})}function zo(e=!1){const t=document.querySelector(".export-preview-overlay");t&&t.remove(),So(),fi=!1,na(),e||(Ci="none"),!hi&&qr&&$r.find(e=>e.id===qr)&&Io(qr)}function So(){if(!hi)return;const e=document.getElementById("exportPreviewHost");e&&(e.querySelector(".export-preview-overlay")||(e.innerHTML='<div class="export-preview-placeholder">Test Export to compare</div>'))}function Ao(e,t,n,r,i){if(!e||!t)return;const a=e.querySelector(".export-preview-size");if(!a)return;const o=t.naturalWidth,s=t.naturalHeight,l=[];Number.isFinite(n)&&n>=0&&l.push(`${(n/1024).toFixed(1)} KB`),Number.isFinite(o)&&Number.isFinite(s)&&o>0&&s>0&&l.push(`${o}x${s}`);const c=Number.isFinite(r)&&Number.isFinite(i)&&r>0&&i>0&&Number.isFinite(o)&&Number.isFinite(s)&&o>0&&s>0&&(r!==o||i!==s);if(c&&(l.push(`expected ${r}x${i}`),console.warn("Export preview size mismatch",{expected:{width:r,height:i},actual:{width:o,height:s}})),a.style.color=c?"var(--warning)":"var(--text-secondary)",l.length){const e=c?`MISMATCH: ${l.join("  ")}`:l.join("  ");a.textContent=`(${e})`}else a.textContent=""}function Lo(e,t,n={}){if(!e)return;const r=e.querySelector(".export-preview-scroll");if(!r)return;const i=["fit","100","200","400"].includes(t)?t:"fit";e.dataset.zoomMode=i,r.classList.toggle("zoom-actual","fit"!==i);const a=e.querySelector(".export-preview-zoom-controls");a&&a.querySelectorAll("button[data-zoom]").forEach(e=>{e.classList.toggle("active",e.dataset.zoom===i)}),"fit"===i&&!1!==n.resetScroll&&(r.scrollLeft=0,r.scrollTop=0)}function Ro(e,t){if(!e||!t)return 1;const n=e.dataset.zoomMode||"fit";return"fit"===n?function(e,t){if(!(e&&t&&t.naturalWidth&&t.naturalHeight))return 1;const n=function(e){if(!e)return{width:0,height:0};const t=window.getComputedStyle(e),n=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),r=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),i=e.clientWidth-(Number.isFinite(n)?n:0),a=e.clientHeight-(Number.isFinite(r)?r:0);return{width:Math.max(0,i),height:Math.max(0,a)}}(e);if(n.width<=0||n.height<=0)return 1;const r=Math.min(n.width/t.naturalWidth,n.height/t.naturalHeight,1);return Number.isFinite(r)?r:1}(e.querySelector(".export-preview-scroll"),t):"200"===n?2:"400"===n?4:1}function To(e,t){if(!e)return;const n=e.querySelector(".export-preview-scroll"),r=e.querySelector(".export-preview-zoom-controls");n&&r&&(r.style.display="inline-flex",Lo(e,e.dataset.zoomMode||"fit",{resetScroll:!1}),function(e,t){if(!(e&&t&&t.naturalWidth&&t.naturalHeight))return;const n=e.dataset.zoomMode||"fit";if("fit"===n)return t.style.width="",void(t.style.height="");let r=1;"200"===n&&(r=2),"400"===n&&(r=4),t.style.width=`${Math.max(1,Math.round(t.naturalWidth*r))}px`,t.style.height=`${Math.max(1,Math.round(t.naturalHeight*r))}px`}(e,t))}function Fo(e){if(!e||e.dataset.panBound)return;e.dataset.panBound="true";let t=!1,n=0,r=0,i=0,a=0;e.addEventListener("pointerdown",o=>{0===o.button&&(t=!0,n=o.clientX,r=o.clientY,i=e.scrollLeft,a=e.scrollTop,e.classList.add("panning"),e.setPointerCapture(o.pointerId),o.preventDefault())}),e.addEventListener("pointermove",o=>{if(!t)return;const s=o.clientX-n,l=o.clientY-r;e.scrollLeft=i-s,e.scrollTop=a-l});const o=n=>{t&&(t=!1,e.classList.remove("panning"),n&&e.hasPointerCapture?.(n.pointerId)&&e.releasePointerCapture(n.pointerId))};e.addEventListener("pointerup",o),e.addEventListener("pointercancel",o)}function Mo(e){if(!e||e.dataset.zoomBound)return;e.dataset.zoomBound="true";const t=e.querySelector(".export-preview-zoom-controls");t&&t.addEventListener("click",t=>{const n=t.target.closest("button[data-zoom]");if(!n)return;const r=e.querySelector(".export-preview-scroll"),i=e.querySelector(".export-preview-image");let a=null,o=null;if(r&&i){const t=Ro(e,i)||1;t>0&&(a=(r.scrollLeft+r.clientWidth/2)/t,o=(r.scrollTop+r.clientHeight/2)/t)}Lo(e,n.dataset.zoom,{resetScroll:!1}),To(e,i),r&&i&&null!==a&&null!==o&&requestAnimationFrame(()=>{const t=Ro(e,i)||1,n=a*t-r.clientWidth/2,s=o*t-r.clientHeight/2,l=Math.max(0,r.scrollWidth-r.clientWidth),c=Math.max(0,r.scrollHeight-r.clientHeight);r.scrollLeft=Math.min(l,Math.max(0,n)),r.scrollTop=Math.min(c,Math.max(0,s))}),Do()})}function Po(e,t={}){const{preserveImage:n=!1}=t,r=document.getElementById("previewContent"),i=document.getElementById("exportPreviewHost"),a=function(){const e=document.getElementById("previewContent"),t=document.getElementById("exportPreviewHost");return hi&&t?t:e}();let o,s=a?a.querySelector(".export-preview-overlay"):null;const l=!hi&&a===r,c=++pi;if(!s&&i&&r){const e=(a===r?i:r).querySelector(".export-preview-overlay");e&&e.remove()}if(s){o=s.querySelector(".export-preview-content"),fi=!0,na();let e=s.querySelector(".export-preview-scroll");!e&&o&&(e=document.createElement("div"),e.className="export-preview-scroll",e.innerHTML=o.innerHTML,o.innerHTML="",o.appendChild(e)),Fo(e),Mo(s)}else{s=document.createElement("div"),s.className="export-preview-overlay";const e=document.createElement("div");e.className="export-preview-header";const t=document.createElement("div");t.className="export-preview-title-row";const n=document.createElement("span");n.className="export-preview-title",n.dataset.baseTitle="Export Preview",n.textContent="Export Preview";const r=document.createElement("span");r.className="export-preview-size",t.appendChild(n),t.appendChild(r);const i=document.createElement("div");i.className="export-preview-header-actions";const c=document.createElement("div");c.className="export-preview-zoom-controls",c.style.display="none";const u=document.createElement("button");u.className="btn export-zoom-btn",u.dataset.zoom="fit",u.textContent="Fit";const d=document.createElement("button");d.className="btn export-zoom-btn",d.dataset.zoom="100",d.textContent="100%";const h=document.createElement("button");h.className="btn export-zoom-btn",h.dataset.zoom="200",h.textContent="200%";const p=document.createElement("button");if(p.className="btn export-zoom-btn",p.dataset.zoom="400",p.textContent="400%",c.appendChild(u),c.appendChild(d),c.appendChild(h),c.appendChild(p),i.appendChild(c),!hi){const e=document.createElement("button");e.className="icon-btn",e.textContent="",e.type="button",e.addEventListener("pointerdown",e=>{e.stopPropagation()}),e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),zo(),na()}),i.appendChild(e)}e.appendChild(t),e.appendChild(i),o=document.createElement("div"),o.className="export-preview-content";const f=document.createElement("div");f.className="export-preview-scroll",o.appendChild(f),s.appendChild(e),s.appendChild(o),a&&(l||(a.innerHTML=""),a.appendChild(s)),fi=!0,na(),Fo(f),Mo(s),Lo(s,"fit")}if(function(e){if(!bi.blobUrl)return!1;if(bi.imageId!==e.id)return!1;const t=e._lastCropChangeId||0;return bi.cropChangeId===t&&bi.settingsChangeId===wi}(e)){const t=s?.querySelector(".export-preview-scroll");if(t){t.innerHTML="";const n=document.createElement("img");n.src=bi.blobUrl,n.className="export-preview-image",n.dataset.blobUrl=bi.blobUrl,n.draggable=!1,n.onload=()=>{s.classList.remove("loading");const{width:t,height:r}=_a(e);Ao(s,n,bi.sizeBytes,t,r),To(s,n),Do()},t.appendChild(n)}return}const u=s?.querySelector(".export-preview-scroll"),d=u?u.querySelector(".export-preview-image"):null,h=bi&&bi.imageId===e.id;if(s&&(s.classList.remove("loading"),s.dataset.requestId=String(c)),s){const e=s.querySelector(".export-preview-size");e&&(e.textContent="",e.style.color="var(--text-secondary)")}d&&n&&h?s.classList.add("loading"):u&&(u.innerHTML='<div style="color: var(--text-secondary);">Processing...</div>');const p=da(e);Uo(e,{cancelOnChange:!0,snapshot:p,yieldMs:1}).then(t=>{if(!s||s.dataset.requestId!==String(c))return;const r=URL.createObjectURL(t),{width:i,height:a}=_a(e);if(bi={imageId:e.id,cropChangeId:e._lastCropChangeId||0,settingsChangeId:wi,blobUrl:r,sizeBytes:t.size,width:i,height:a},d&&n&&h){const e=d.dataset.blobUrl;e&&URL.revokeObjectURL(e),d.onload=()=>{s&&s.dataset.requestId===String(c)&&(s.classList.remove("loading"),Ao(s,d,t.size,i,a),To(s,d),Do())},d.draggable=!1,d.src=r,d.dataset.blobUrl=r}else{const e=document.createElement("img");e.src=r,e.className="export-preview-image",e.dataset.blobUrl=r,e.draggable=!1,e.onload=()=>{s&&s.dataset.requestId===String(c)&&(u&&(u.innerHTML="",u.appendChild(e)),s.classList.remove("loading"),Ao(s,e,t.size,i,a),To(s,e),Do())}}}).catch(e=>{if(s&&s.dataset.requestId===String(c)){if(e&&("INTERRUPTED"===e.code||"Interrupted"===e.message))return u&&(u.innerHTML='<div style="color: var(--warning);">Interrupted</div>'),void s.classList.remove("loading");u&&(u.innerHTML=`<div style="color: var(--danger);">Error: ${e.message}</div>`),s.classList.remove("loading")}})}function No(e={},t=180,n=null){null!==t&&(null!==n&&(mi=n),di&&clearTimeout(di),di=setTimeout(()=>{di=null,null!==n&&(gi=n),function(e={}){if(!fi||!qr)return;if(!document.querySelector(".export-preview-overlay"))return;const t=$r.find(e=>e.id===qr);t&&Po(t,e)}(e)},t))}function Wo(){wi+=1,$i&&Xa()}function Oo(e,t){if(!e)return;const n=e.dataset.baseTitle||e.textContent,r=function(e){if(!e||!e.naturalWidth||!e.naturalHeight)return null;const t=e.getBoundingClientRect();if(!t.width||!t.height)return null;const n=Math.min(t.width/e.naturalWidth,t.height/e.naturalHeight);return Math.round(100*n)}(t),i=e.querySelector(".preview-title-text"),a=e.querySelector(".preview-title-zoom");if(i&&a)return i.textContent=n,void(a.textContent=r&&r<100?`[${r}%]`:"");e.textContent=r&&r<100?`${n} [${r}%]`:n}function Do(){Oo(document.getElementById("previewTitle"),document.querySelector("#previewWrapper .preview-image"));const e=document.querySelector(".export-preview-title"),t=document.querySelector(".export-preview-image");Oo(e,t);const n=document.querySelector(".export-preview-overlay");n&&t&&To(n,t)}async function jo(){ui||(ui=fe()),await ui}async function Uo(e,t={}){try{const{cancelOnChange:n=!1,snapshot:r,yieldMs:i=0,shouldCancel:a=null}=t,o=r||da(e);n&&ha(o,e),pa(a);const{usePhotonResize:s,jsquashMethod:l,photonSamplingFilter:c}=ma(),u=s?"Photon":"jSquash";console.log(`=== Processing Image with ${u} ===`),console.time("processImage total");const d=aa(),{width:h,height:p,shouldResize:f,crop:m}=_a(e,d),g=document.getElementById("exportFormat").value;console.log(`Target: ${h}x${p}, Format: ${g}`);const _=e.file;if(!_)throw new Error("No file available to process");const w=m||e.crop;console.log(`Source crop: ${w.width}x${w.height} at (${w.x}, ${w.y})`),console.time("processImage decode");const b=await createImageBitmap(_);console.timeEnd("processImage decode"),i>0&&await fa(i),n&&ha(o,e),pa(a),console.time("processImage crop");const y=document.createElement("canvas");y.width=Math.round(w.width),y.height=Math.round(w.height);const v=y.getContext("2d",{alpha:!0});v.drawImage(b,w.x,w.y,w.width,w.height,0,0,y.width,y.height),b.close();const x=v.getImageData(0,0,y.width,y.height);console.timeEnd("processImage crop"),console.log(`Cropped ImageData: ${x.width}x${x.height}`),i>0&&await fa(i),n&&ha(o,e),pa(a);let E=x;if(f&&h&&p&&(x.width!==h||x.height!==p)){try{console.time("processImage resize");const e=Ki();if("resize"===e||"both"===e)throw new Error("Forced fallback (resize)");s?(E=await async function(e,t,n,r){const i=await ra();if(!i||"function"!=typeof i.open_image)throw new Error("Photon wasm not loaded");const a=document.createElement("canvas");a.width=e.width,a.height=e.height;const o=a.getContext("2d",{alpha:!0});o.putImageData(e,0,0);const s=i.open_image(a,o),l=Number.isFinite(r)?r:5;if("function"==typeof i.resize){const e=i.resize(s,t,n,l);return i.to_image_data(e)}if("function"==typeof i.resize_img_browser)return i.resize_img_browser(s,t,n,l).getContext("2d",{alpha:!0}).getImageData(0,0,t,n);throw new Error("Photon resize API not available")}(x,h,p,c),console.log("Photon resize complete")):(E=await H(x,{width:h,height:p,method:l||Vr}),console.log("jSquash resize complete")),console.timeEnd("processImage resize")}catch(e){console.timeEnd("processImage resize"),console.warn(`${u} resize failed, falling back to canvas resize`,e),ia("resize"),console.time("processImage resizeCanvas"),E=function(e,t,n){const r=document.createElement("canvas");r.width=t,r.height=n;const i=r.getContext("2d",{alpha:!0});return i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high",i.drawImage(e,0,0,t,n),i.getImageData(0,0,t,n)}(y,h,p),console.timeEnd("processImage resizeCanvas")}i>0&&await fa(i)}else f?f&&h&&p&&console.log("Resize skipped (already at target size)"):console.log(`Resize skipped (${aa()})`);i>0&&await fa(i),n&&ha(o,e),pa(a);try{const t=Boolean(document.getElementById("enableSharpening")?.checked);let r=E;t?(console.time("processImage sharpen"),r=await async function(e){if(!document.getElementById("enableSharpening").checked)return e;const t=parseInt(document.getElementById("sharpenAmount").value,10)||0,n=parseFloat(document.getElementById("sharpenRadius").value)||1,r=parseInt(document.getElementById("sharpenThreshold").value,10)||0,i=document.getElementById("adaptiveSharpening").checked;let a=t/100;if(a*=Math.max(.3,Math.min(2.5,n)),i){const t=Math.min(e.width,e.height);a*=Math.max(.6,Math.min(1.5,t/1e3))}if(a=Math.max(0,Math.min(2,a)),0===a)return console.log("Sharpening skipped (strength 0)"),e;try{console.log("Sharpening enabled",{amount:t,radius:n,threshold:r,adaptive:i,strength:a});const o=await ra(),s=document.createElement("canvas");s.width=e.width,s.height=e.height;const l=s.getContext("2d",{alpha:!0});if(l.putImageData(e,0,0),!o||"function"!=typeof o.open_image)throw new Error("Photon wasm not loaded");const c=o.open_image(s,l);o.conv&&"function"==typeof o.conv.sharpen?o.conv.sharpen(c):"function"==typeof o.sharpen&&o.sharpen(c);const u=o.to_image_data(c);return console.log("Sharpening applied"),function(e,t,n,r){const i=e.data,a=t.data||t,o=new Uint8ClampedArray(i.length),s=Math.max(0,Math.min(255,r||0)),l=Math.max(0,Math.min(2,n||0));for(let e=0;e<i.length;e+=4){for(let t=0;t<3;t+=1){const n=i[e+t],r=a[e+t];if(Math.abs(r-n)<s)o[e+t]=n;else{const i=n+(r-n)*l;o[e+t]=Math.max(0,Math.min(255,Math.round(i)))}}o[e+3]=i[e+3]}return new ImageData(o,e.width,e.height)}(e,u,a,r)}catch(t){return console.warn("Sharpening failed, returning original image data.",t),e}}(E),console.timeEnd("processImage sharpen"),i>0&&await fa(i),n&&ha(o,e),pa(a)):console.log("Sharpening skipped (disabled)"),console.time("processImage encode");const s=Ki();if("encode"===s||"both"===s)throw new Error("Forced fallback (encode)");const{data:l,mimeType:c}=await async function(e,t){switch(t){case"jpeg":return{mimeType:"image/jpeg",data:await Y(e,{quality:parseInt(document.getElementById("jpegQuality").value)})};case"webp":return{mimeType:"image/webp",data:await ee(e,{quality:parseInt(document.getElementById("webpQuality").value)})};case"avif":return{mimeType:"image/avif",data:await ae(e,{quality:parseInt(document.getElementById("avifQuality").value)})};case"png":await jo();{const t=he(e.data,e.width,e.height,2,li,ci);return{mimeType:"image/png",data:t instanceof Uint8Array?t:new Uint8Array(t)}}case"gif":await jo();{const t=he(e.data,e.width,e.height,2,li,ci);return{mimeType:"image/png",data:t instanceof Uint8Array?t:new Uint8Array(t)}}default:await jo();{const t=he(e.data,e.width,e.height,2,li,ci);return{mimeType:"image/png",data:t instanceof Uint8Array?t:new Uint8Array(t)}}}}(r,g);console.timeEnd("processImage encode");const d=new Blob([l],{type:c});return console.log(`${u} blob created: ${d.size} bytes`),console.log("=== Processing Complete ==="),console.timeEnd("processImage total"),d}catch(e){console.warn(`${u} encode failed, falling back to canvas encoding`,e),ia("encode"),console.time("processImage encodeFallback");const t=await function(e,t){return new Promise((n,r)=>{const i=document.createElement("canvas");let a,o;switch(i.width=e.width,i.height=e.height,i.getContext("2d",{alpha:!0}).putImageData(e,0,0),t){case"jpeg":o="image/jpeg",a=parseInt(document.getElementById("jpegQuality").value)/100;break;case"webp":o="image/webp",a=parseInt(document.getElementById("webpQuality").value)/100;break;case"avif":o="image/avif",a=parseInt(document.getElementById("avifQuality").value)/100;break;default:o="image/png",a=1}i.toBlob(e=>{e?n(e):r(new Error("Failed to create blob"))},o,a)})}(E,g);return console.timeEnd("processImage encodeFallback"),console.log(`Fallback blob created: ${t.size} bytes`),console.log("=== Processing Complete ==="),console.timeEnd("processImage total"),t}}catch(e){throw console.timeEnd("processImage total"),console.error("Process image error:",e),e}}function $o(e,t){if(!t.has(e))return t.add(e),e;const n=e.lastIndexOf("."),r=n>0&&n<e.length-1,i=r?e.slice(0,n):e,a=r?e.slice(n):"";let o=2,s=`${i} (${o})${a}`;for(;t.has(s);)o+=1,s=`${i} (${o})${a}`;return t.add(s),s}function Ho(){const e=document.getElementById("imagesGrid");e&&(e.style.setProperty("--grid-image-size",`${Hr}px`),e.style.gridTemplateColumns=`repeat(auto-fill, minmax(${Hr}px, 1fr))`,Hi&&Va())}function qo(e,t,n){const r=aa();if(r!==Kr&&r!==Jr)return;if(Qr=e/t,$r.forEach(e=>{e.crop=Ha(e.width,e.height)}),r===Kr||r===Jr){const e=parseInt(document.getElementById("exportWidth").value,10);if(Number.isFinite(e)&&e>0){const t=Math.round(e/Qr);document.getElementById("exportHeight").value=t}}hs(0,e,t);const i=document.getElementById("aspectW"),a=document.getElementById("aspectH");i&&a&&(i.value=e,a.value=t),io(),ds({aspectRatio:{width:e,height:t}}),Wo(),ts(),no(),No({preserveImage:!0},Ji(!0))}function Qo(e=!0){const t=document.getElementById("exportFormat").value;document.getElementById("jpegSettings").style.display="jpeg"===t?"block":"none",document.getElementById("pngSettings").style.display="png"===t?"block":"none",document.getElementById("webpSettings").style.display="webp"===t?"block":"none",document.getElementById("avifSettings").style.display="avif"===t?"block":"none",document.getElementById("gifSettings").style.display="gif"===t?"block":"none",e&&(ds(),ts()),Wo(),No({preserveImage:!0},Ji(!0))}function Zo(){document.getElementById("exportBtn").disabled=0===$r.length||Ti}function Go(){const e=document.getElementById("exportCancelBtn");e&&(e.disabled=!Ti||Fi,e.textContent=Fi?"Cancelling...":"Cancel")}function Xo(e){Ti=e,document.body.classList.toggle("exporting",e),Zo(),Go()}function Yo(){ga(),ds(),Wo(),No({preserveImage:!0},Ji(!0))}function Vo(){try{const e=localStorage.getItem(Yr);return e?JSON.parse(e):{}}catch(e){return{}}}function Ko(){const e=Vo();return Array.isArray(e.profiles)?e.profiles:[]}function Jo(e){ds({profiles:e}),is()}function es(){const e=document.getElementById("profileNameDisplay");if(!e)return;xi?(e.textContent=Ei?`${xi} (modified)`:xi,e.classList.remove("muted")):(e.textContent="(no profile selected)",e.classList.add("muted"));const t=document.getElementById("profileClearAction"),n=document.getElementById("profileRevertAction");t&&(t.style.display=xi?"inline":"none"),n&&(n.style.display=Ei&&ki?"inline":"none")}function ts(){Ii||(Ei=!0,es())}function ns(e,t={}){if(!e)return;const{applyDefaults:n=!1,setProfileName:r=!0,setLastLoaded:i=!0}=t,a=n?function(e){const t={...Wr,...e};return(Wr.aspectRatio||e.aspectRatio)&&(t.aspectRatio={...Wr.aspectRatio||{},...e.aspectRatio||{}}),t}(e):e;let o=a.resizeMode;if(o||"boolean"!=typeof a.lockAspect||(o=a.lockAspect?Kr:ei),o=o||si,Ii=!0,Number.isFinite(a.exportWidth)&&(document.getElementById("exportWidth").value=a.exportWidth),Number.isFinite(a.exportHeight)&&(document.getElementById("exportHeight").value=a.exportHeight),Number.isFinite(a.scalePercent)){const e=document.getElementById("scalePercent");e&&(e.value=oa(a.scalePercent))}const s=document.getElementById("resizeMode");if(s&&(s.value=o,s.value||(s.value=si,o=si)),a.exportFormat&&(document.getElementById("exportFormat").value=a.exportFormat),Number.isFinite(a.jpegQuality)&&(document.getElementById("jpegQuality").value=a.jpegQuality,document.getElementById("jpegQualityNumber").value=a.jpegQuality),Number.isFinite(a.webpQuality)&&(document.getElementById("webpQuality").value=a.webpQuality,document.getElementById("webpQualityNumber").value=a.webpQuality),Number.isFinite(a.avifQuality)&&(document.getElementById("avifQuality").value=a.avifQuality,document.getElementById("avifQualityNumber").value=a.avifQuality),"boolean"==typeof a.pngTransparency&&(document.getElementById("pngTransparency").checked=a.pngTransparency),"boolean"==typeof a.enableSharpening&&(document.getElementById("enableSharpening").checked=a.enableSharpening),"boolean"==typeof a.adaptiveSharpening&&(document.getElementById("adaptiveSharpening").checked=a.adaptiveSharpening),Number.isFinite(a.sharpenAmount)&&(document.getElementById("sharpenAmount").value=a.sharpenAmount,document.getElementById("sharpenAmountNumber").value=a.sharpenAmount),Number.isFinite(a.sharpenRadius)&&(document.getElementById("sharpenRadius").value=a.sharpenRadius,document.getElementById("sharpenRadiusNumber").value=a.sharpenRadius),Number.isFinite(a.sharpenThreshold)&&(document.getElementById("sharpenThreshold").value=a.sharpenThreshold,document.getElementById("sharpenThresholdNumber").value=a.sharpenThreshold),a.aspectRatio&&Number.isFinite(a.aspectRatio.width)&&Number.isFinite(a.aspectRatio.height)){Qr=a.aspectRatio.width/a.aspectRatio.height,hs(0,a.aspectRatio.width,a.aspectRatio.height);const e=document.getElementById("aspectW"),t=document.getElementById("aspectH");e&&t&&(e.value=a.aspectRatio.width,t.value=a.aspectRatio.height)}else{const e=parseInt(document.getElementById("exportWidth").value),t=parseInt(document.getElementById("exportHeight").value);e&&t&&(Qr=e/t,ro())}ca(o)&&$r.forEach(e=>{e.crop=Ha(e.width,e.height)}),Qo(!1),la(!1),Ri=o,ba(),ds(),ua(o)&&no(),Wo(),No({preserveImage:!0},Ji(!0)),xi=r&&a.name||"",Ei=!1,ki=i?{...a}:null,es(),Ii=!1}function rs(){const e=document.getElementById("profilesList");if(!e)return;const t=Ko();e.innerHTML="",is();const n=(e,t)=>{const n=document.createElement("section");n.className="profiles-section "+(t?"expanded":"collapsed");const r=document.createElement("button");r.type="button",r.className="profiles-section-title",r.setAttribute("aria-expanded",t?"true":"false");const i=document.createElement("span");i.className="profiles-section-label",i.textContent=e,r.appendChild(i);const a=document.createElement("span");a.className="profiles-section-chevron",a.textContent="",r.appendChild(a);const o=document.createElement("div");return o.className="profiles-section-body",r.onclick=()=>{const e=n.classList.toggle("expanded");n.classList.toggle("collapsed",!e),r.setAttribute("aria-expanded",e?"true":"false")},n.appendChild(r),n.appendChild(o),{section:n,body:o}},r=(e,t,n)=>{const r=document.createElement("div");r.className="profile-card";const i=document.createElement("div");i.className="profile-info";const a=document.createElement("div");a.className="profile-name",a.textContent=e.name||`Profile ${t+1}`;const o=document.createElement("div");o.className="profile-meta";const s=function(e){if(e.aspectRatio&&e.aspectRatio.width&&e.aspectRatio.height){const t=e.aspectRatio.width,n=e.aspectRatio.height,{arW:r,arH:i}=jr(t,n,{includePortrait:!1});for(const e of Nr)if(e.w===r&&e.h===i)return e.label||`${e.w}:${e.h}`;return Ur(t,n)}return e.exportWidth&&e.exportHeight?Ur(e.exportWidth,e.exportHeight):""}(e),l=[`${e.exportWidth||""}x${e.exportHeight||""}`.trim(),String(e.exportFormat||"").toUpperCase(),s].filter(Boolean);e.enableSharpening&&l.push("Sharpening"),e.resizeMode===oi&&Number.isFinite(e.scalePercent)&&l.push(`${oa(e.scalePercent)}%`),o.textContent=l.join("  "),i.appendChild(a),i.appendChild(o);const c=document.createElement("div");c.className="profile-actions";const u=document.createElement("button");if(u.className="btn",u.textContent="Load",u.onclick=()=>{ns(e),vi&&os()},c.appendChild(u),n){const n=document.createElement("button");n.className="btn",n.textContent="Delete",n.onclick=()=>{const n=e.name||`Profile ${t+1}`;window.confirm(`Delete profile "${n}"?`)&&(Jo(Ko().filter((e,n)=>n!==t)),rs())},c.appendChild(n)}return r.appendChild(i),r.appendChild(c),r},i=document.createElement("div");if(i.className="profiles-list",t.length)t.forEach((e,t)=>i.appendChild(r(e,t,!0)));else{const e=document.createElement("div");e.style.color="var(--text-secondary)",e.style.fontSize="12px",e.textContent="No profiles saved yet.",i.appendChild(e)}const a=n("User Profiles",!0);a.body.appendChild(i),e.appendChild(a.section),(Array.isArray(Pr)?[{title:"Default Profiles",profiles:Pr}]:Object.entries(Pr||{}).map(([e,t])=>({title:e,profiles:Array.isArray(t)?t:[]})).filter(e=>e.profiles.length>0)).forEach((t,i)=>{const a=document.createElement("div");a.className="profiles-list",t.profiles.forEach((e,t)=>{const n=r(e,t,!1),i=n.querySelector("button.btn");i&&(i.onclick=()=>{ns(e,{applyDefaults:!0}),vi&&os()}),a.appendChild(n)});const o=n(t.title||`Profiles ${i+1}`,!1);o.body.appendChild(a),e.appendChild(o.section)})}function is(){const e=document.getElementById("exportProfilesBtn");if(!e)return;const t=Ko();e.disabled=!t.length}function as(e){return e&&"object"==typeof e?"string"!=typeof e.name?"":e.name.trim():""}function os(){vi=!vi;const e=document.getElementById("profilesPanel"),t=document.getElementById("openProfilesBtn"),n=document.getElementById("loadProfileBtn");e&&e.classList.toggle("active",vi),to(),t&&(t.textContent=vi?"Back to Images":"Open Profiles",t.classList.toggle("active",vi)),n&&(n.textContent=vi?"Back to images":"Load Profile",n.classList.toggle("active",vi)),vi&&rs(),Ya()}function ss(e,t,n=e=>Number(e)){const r=document.getElementById(e),i=document.getElementById(t);if(!r||!i)return;const a=Number(r.min),o=Number(r.max),s=()=>{i.value=r.value};r.addEventListener("input",()=>{s()}),i.addEventListener("input",()=>{(()=>{const e=n(i.value);if(!Number.isFinite(e))return;const t=(s=e,Math.min(o,Math.max(a,s)));var s;r.value=t,i.value=t})()}),s()}function ls(e){Mi=e}function cs(){ls(!1)}function us(e={}){const t=Pi;Pi=!0,ds(e),Pi=t}function ds(e={}){const t=Vo(),n=ma(),r=document.getElementById("exportWidth"),i=document.getElementById("exportHeight"),a=parseInt(r?.value),o=parseInt(i?.value),s=parseInt(r?.dataset.stashedValue),l=parseInt(i?.dataset.stashedValue),c={...t,exportWidth:Number.isFinite(a)?a:Number.isFinite(s)?s:null,exportHeight:Number.isFinite(o)?o:Number.isFinite(l)?l:null,scalePercent:sa(),resizeMode:aa(),exportFormat:document.getElementById("exportFormat").value,jpegQuality:parseInt(document.getElementById("jpegQuality").value),webpQuality:parseInt(document.getElementById("webpQuality").value),avifQuality:parseInt(document.getElementById("avifQuality").value),pngTransparency:document.getElementById("pngTransparency").checked,previewDelay:document.getElementById("previewDelay").value,lightMode:document.body.classList.contains("light"),lastExportPreviewMode:Ci,showAboutOnLoad:document.getElementById("aboutAutoShow").checked,enableSharpening:document.getElementById("enableSharpening").checked,adaptiveSharpening:document.getElementById("adaptiveSharpening").checked,sharpenAmount:parseInt(document.getElementById("sharpenAmount").value),sharpenRadius:parseFloat(document.getElementById("sharpenRadius").value),sharpenThreshold:parseInt(document.getElementById("sharpenThreshold").value),resizeEngine:n.engine,usePhotonResize:n.usePhotonResize,jsquashResizeMethod:n.jsquashMethod,photonSamplingFilter:n.photonSamplingFilter,showGridSizeInfo:$i,showFilenameTip:Hi,gridItemSize:Hr,...e};localStorage.setItem(Yr,JSON.stringify(c)),Pi||ls(!0)}function hs(e,t,n){const r=document.getElementById("aspectPresetSelect");if(!r)return;const i=Array.from(r.options).find(e=>{const r=parseInt(e.dataset.aspectW),i=parseInt(e.dataset.aspectH);return r===t&&i===n});r.value=i?i.value:""}function ps(){const e=Vo(),t=document.getElementById("aboutAutoShow");"boolean"==typeof e.showAboutOnLoad?t.checked=e.showAboutOnLoad:t.checked=!0}Ea.addEventListener("mousedown",e=>{Fa()&&(Zr=!0,Gr=e.clientX,Xr=Ia.offsetWidth,Ea.classList.add("resizing"),document.body.classList.add("resizing"),e.preventDefault())}),Ea.addEventListener("pointerdown",e=>{"mouse"!==e.pointerType&&Fa()&&(Zr=!0,Gr=e.clientX,Xr=Ia.offsetWidth,Ea.classList.add("resizing"),document.body.classList.add("resizing"),Ea.setPointerCapture&&Ea.setPointerCapture(e.pointerId),e.preventDefault())}),document.addEventListener("mousemove",e=>{if(!Zr)return;if(!Fa())return Zr=!1,Ea.classList.remove("resizing"),void document.body.classList.remove("resizing");const t=e.clientX-Gr,n=Ta(Xr+t);Ia.style.flex=`0 0 ${n}px`,Do(),hi&&ho()}),document.addEventListener("pointermove",e=>{if("mouse"===e.pointerType)return;if(!Zr)return;if(!Fa())return Zr=!1,Ea.classList.remove("resizing"),void document.body.classList.remove("resizing");const t=e.clientX-Gr,n=Ta(Xr+t);Ia.style.flex=`0 0 ${n}px`,Do(),hi&&ho()}),document.addEventListener("mouseup",()=>{Zr&&(Zr=!1,Ea.classList.remove("resizing"),document.body.classList.remove("resizing"),Do(),hi&&ho())}),document.addEventListener("pointerup",e=>{"mouse"!==e.pointerType&&Zr&&(Zr=!1,Ea.classList.remove("resizing"),document.body.classList.remove("resizing"),Do(),hi&&ho())}),window.addEventListener("resize",()=>{if(!Fa()||!Ia)return;const e=Ia.getBoundingClientRect().width,t=Ta(e);Math.abs(t-e)>1&&(Ia.style.flex=`0 0 ${t}px`),Do(),hi&&ho()}),ka&&(ka.addEventListener("mousedown",e=>{Ba&&Ca&&Pa()&&(za=!0,"vertical"===Li?(Sa=e.clientY,Aa=Ca.getBoundingClientRect().height,document.body.classList.add("resizing-vertical")):(Sa=e.clientX,Aa=Ca.getBoundingClientRect().width,document.body.classList.add("resizing")),ka.classList.add("resizing"),e.preventDefault())}),ka.addEventListener("pointerdown",e=>{"mouse"!==e.pointerType&&Ba&&Ca&&Pa()&&(za=!0,"vertical"===Li?(Sa=e.clientY,Aa=Ca.getBoundingClientRect().height,document.body.classList.add("resizing-vertical")):(Sa=e.clientX,Aa=Ca.getBoundingClientRect().width,document.body.classList.add("resizing")),ka.classList.add("resizing"),ka.setPointerCapture&&ka.setPointerCapture(e.pointerId),e.preventDefault())})),document.addEventListener("mousemove",e=>{if(!za||!Ba||!Ca)return;if(!Pa())return za=!1,ka?.classList.remove("resizing"),document.body.classList.remove("resizing"),void document.body.classList.remove("resizing-vertical");const t=co();if("vertical"===Li){const n=e.clientY-Sa,r=Ra(Ba.getBoundingClientRect().height,ka?ka.getBoundingClientRect().height:6);let i=Aa+n;i=Math.max(r.min,Math.min(r.max,i)),Ca.style.flex=`0 0 ${i}px`,t?Ai=i:zi=i}else{const n=e.clientX-Sa,r=Ra(Ba.getBoundingClientRect().width,ka?ka.getBoundingClientRect().width:6);let i=Aa+n;i=Math.max(r.min,Math.min(r.max,i)),Ca.style.flex=`0 0 ${i}px`,t?Si=i:Bi=i}Do()}),document.addEventListener("pointermove",e=>{if("mouse"===e.pointerType)return;if(!za||!Ba||!Ca)return;if(!Pa())return za=!1,ka?.classList.remove("resizing"),document.body.classList.remove("resizing"),void document.body.classList.remove("resizing-vertical");const t=co();if("vertical"===Li){const n=e.clientY-Sa,r=Ra(Ba.getBoundingClientRect().height,ka?ka.getBoundingClientRect().height:6);let i=Aa+n;i=Math.max(r.min,Math.min(r.max,i)),Ca.style.flex=`0 0 ${i}px`,t?Ai=i:zi=i}else{const n=e.clientX-Sa,r=Ra(Ba.getBoundingClientRect().width,ka?ka.getBoundingClientRect().width:6);let i=Aa+n;i=Math.max(r.min,Math.min(r.max,i)),Ca.style.flex=`0 0 ${i}px`,t?Si=i:Bi=i}Do()}),document.addEventListener("mouseup",()=>{za&&(za=!1,ka?.classList.remove("resizing"),document.body.classList.remove("resizing"),document.body.classList.remove("resizing-vertical"),Do())}),document.addEventListener("pointerup",e=>{"mouse"!==e.pointerType&&za&&(za=!1,ka?.classList.remove("resizing"),document.body.classList.remove("resizing"),document.body.classList.remove("resizing-vertical"),Do())}),document.addEventListener("fullscreenchange",()=>{const e=document.getElementById("previewPane"),t=e&&document.fullscreenElement===e;if(Wi=Boolean(t),!t&&Di){const e=Di;return Di=null,void ko(Boolean(e.skipSplitReset))}!t&&Ni&&window.innerWidth<La&&e?.classList.contains("active")?Co():(t?(document.body.classList.remove("preview-fullscreen"),Oi=!0,Si=null,Ai=null):document.body.classList.remove("preview-fullscreen"),lo(),requestAnimationFrame(()=>{ho(),t&&uo(!0),Do()}))}),document.getElementById("exportWidth").addEventListener("input",()=>{const e=aa();if(e===Kr){const e=parseInt(document.getElementById("exportWidth").value),t=Math.round(e/Qr);document.getElementById("exportHeight").value=t}else e===ei&&(ro(),ao());io(),ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("exportHeight").addEventListener("input",()=>{const e=aa();if(e===Kr){const e=parseInt(document.getElementById("exportHeight").value),t=Math.round(e*Qr);document.getElementById("exportWidth").value=t}else e===ei&&(ro(),ao());io(),ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("jpegQuality").addEventListener("input",()=>{ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("jpegQualityNumber").addEventListener("input",()=>{ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("webpQuality").addEventListener("input",()=>{ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("webpQualityNumber").addEventListener("input",()=>{ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("avifQuality").addEventListener("input",()=>{ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("avifQualityNumber").addEventListener("input",()=>{ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("pngTransparency").addEventListener("change",()=>{ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("previewDelay").addEventListener("change",()=>{us()}),document.getElementById("resizeMode").addEventListener("change",function(){ba(),Ka(),xo(),ds(),ts(),Wo(),No({preserveImage:!0},Ji(!0))}),document.getElementById("resizeEngine").addEventListener("change",Yo),document.getElementById("jsquashResizeMethod").addEventListener("change",Yo),document.getElementById("photonResizeFilter").addEventListener("change",Yo),document.getElementById("scalePercent").addEventListener("input",()=>{la(!0)}),document.getElementById("aspectW").addEventListener("input",oo),document.getElementById("aspectH").addEventListener("input",oo),document.getElementById("aboutAutoShow").addEventListener("change",()=>{us()}),document.getElementById("enableSharpening").addEventListener("change",()=>{ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("adaptiveSharpening").addEventListener("change",()=>{ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("sharpenAmount").addEventListener("input",()=>{ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("sharpenRadius").addEventListener("input",()=>{ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("sharpenThreshold").addEventListener("input",()=>{ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("sharpenAmountNumber").addEventListener("input",()=>{ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("previewFooter").addEventListener("click",e=>{const t=e.target.closest("button[data-crop-action]");if(!t)return;e.preventDefault();const n=e.shiftKey||Qi?10:1;!function(e,t){if(!qr)return;if(!ua())return;const n=$r.find(e=>e.id===qr);if(!n||!n.crop)return;const r=ca()?Qr:null;let i={...{...n.crop}};switch(e){case"up":i.y-=t,i=yo(i,n);break;case"down":i.y+=t,i=yo(i,n);break;case"left":i.x-=t,i=yo(i,n);break;case"right":i.x+=t,i=yo(i,n);break;case"grow":i=vo(n,1,t,r);break;case"shrink":i=vo(n,-1,t,r);break;default:return}!function(e,t){if(!e||!t)return;e.crop=t;const n=++_i;e._lastCropChangeId=n,wo(e),bo(e),No({preserveImage:!0},ta(),n)}(n,i)}(t.dataset.cropAction,n)}),document.getElementById("nudgeBoostToggle")?.addEventListener("click",e=>{e.preventDefault(),Qi=!Qi;const t=e.currentTarget;t.classList.toggle("active",Qi),t.setAttribute("aria-pressed",String(Qi))}),document.getElementById("filenameTipDismiss").addEventListener("click",e=>{e.preventDefault(),Hi=!1,us({showFilenameTip:!1}),Ya()}),document.getElementById("gridContainer").addEventListener("scroll",()=>{Hi&&Va()}),document.addEventListener("visibilitychange",()=>{document.hidden||Qa()}),window.addEventListener("pageshow",()=>{Qa()}),window.addEventListener("resize",()=>{Hi&&Va()}),document.getElementById("profileImportInput").addEventListener("change",async e=>{const t=e.target,n=t?.files?.[0];if(n)try{const e=await n.text(),t=JSON.parse(e);if(!Array.isArray(t))return void window.alert("Invalid profiles JSON. Expected an array of profiles.");const r=t.filter(e=>e&&"object"==typeof e);if(!r.length)return void window.alert("No valid profiles found in the JSON.");const i=Ko(),a=function(e,t){const n=new Set,r=new Set,i=new Set(t.map(as).filter(Boolean));return e.forEach(e=>{const t=as(e);t&&((r.has(t)||i.has(t))&&n.add(t),r.add(t))}),Array.from(n)}(r,i);if(a.length){const e=`Duplicate profile names detected:\n${a.join(", ")}\n\nIf you continue, the current profiles will be overridden.`;if(!window.confirm(e))return}const o=function(e,t){const n=[...t],r=new Map;return n.forEach((e,t)=>{const n=as(e);n&&r.set(n,t)}),e.forEach(e=>{if(!e||"object"!=typeof e)return;const t=as(e);t&&r.has(t)?n[r.get(t)]=e:(n.push(e),t&&r.set(t,n.length-1))}),n}(r,i);Jo(o),vi&&rs()}catch(e){console.error("Profile import failed",e),window.alert("Failed to import profiles. Please check the file and try again.")}finally{t.value=""}}),document.getElementById("sharpenRadiusNumber").addEventListener("input",()=>{ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),document.getElementById("sharpenThresholdNumber").addEventListener("input",()=>{ds(),Wo(),ts(),No({preserveImage:!0},Ji(!0))}),window.addEventListener("resize",Do),ss("jpegQuality","jpegQualityNumber",e=>parseInt(e,10)),ss("webpQuality","webpQualityNumber",e=>parseInt(e,10)),ss("avifQuality","avifQualityNumber",e=>parseInt(e,10)),ss("sharpenAmount","sharpenAmountNumber",e=>parseInt(e,10)),ss("sharpenRadius","sharpenRadiusNumber",e=>parseFloat(e)),ss("sharpenThreshold","sharpenThresholdNumber",e=>parseInt(e,10)),Object.assign(window,{openAbout:Wa,openFiles:Na,openFilesFromHeader:function(){vi&&os(),Na()},exportImages:async function(){if(Ti||0===$r.length)return;Fi=!1,Xo(!0);const e=1===$r.length,t=e?null:new(n()),r=e?null:new Set,i=document.getElementById("exportFormat").value,a=document.getElementById("exportProgress"),o=document.getElementById("exportProgressBar"),s=document.getElementById("exportProgressText");let l=0,c=null,u="";a&&a.classList.add("active"),o&&(o.style.width="0%"),s&&(s.textContent=`Processing Image 1/${$r.length}`);try{for(let n=0;n<$r.length;n++){Fi&&pa(()=>!0);const a=$r[n],d=await Uo(a,{cancelOnChange:!1,shouldCancel:()=>Fi,yieldMs:1}),h=`${a.name.replace(/\.[^/.]+$/,"")}.${i}`,p=e?h:$o(h,r);e?(c=d,u=p):t.file(p,d),l+=1,o&&(o.style.width=`${Math.round((n+1)/$r.length*100)}%`),s&&(s.textContent=`Processing Image ${n+1}/${$r.length}`)}Fi&&pa(()=>!0),s&&(s.textContent="Preparing download...");const n=e?c:await t.generateAsync({type:"blob"}),a=URL.createObjectURL(n),d=document.createElement("a");d.href=a,d.download=e?u:"processed-images.zip",d.click(),URL.revokeObjectURL(a),cs(),o&&(o.style.width="100%")}catch(n){if("CANCELLED"===n?.code)if(e)s&&(s.textContent="Export cancelled"),o&&(o.style.width="0%");else if(l>0)if(window.confirm("Download images produced so far?")){s&&(s.textContent="Preparing download...");const e=await t.generateAsync({type:"blob"}),n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download="processed-images-partial.zip",r.click(),URL.revokeObjectURL(n),o&&(o.style.width="100%")}else s&&(s.textContent="Export cancelled"),o&&(o.style.width="0%");else s&&(s.textContent="Export cancelled"),o&&(o.style.width="0%");else console.error("Export failed:",n),s&&(s.textContent="Export failed")}finally{Fi=!1,Xo(!1),a&&setTimeout(()=>{a.classList.remove("active"),o&&(o.style.width="0%"),s&&(s.textContent="")},400)}},cancelExport:function(){if(!Ti)return;Fi=!0,Go();const e=document.getElementById("exportProgressText");e&&(e.textContent="Cancelling...")},clearAllImages:function(){$r=[],qr=null,zo(),Co(),qa(),Zo(),ya&&ya.classList.remove("hidden"),to(),Bo(),ls(!0)},toggleDrawer:function(){const e=document.getElementById("drawer"),t=document.getElementById("drawerToggleIcon");e.classList.toggle("collapsed"),t.textContent=e.classList.contains("collapsed")?"":""},setAspectRatio:qo,updateFormatSettings:Qo,adjustZoom:function(e){const t=e>=0?1:-1;Hr=Math.max(160,Math.min(800,Hr+40*t)),Ho(),us({gridItemSize:Hr})},resetZoom:function(){Hr=240,Ho(),us({gridItemSize:Hr})},setScalePercentPreset:function(e){const t=document.getElementById("scalePercent");t&&(t.value=oa(e),la(!0))},toggleTheme:function(){const e=document.getElementById("themeToggle")?.checked;document.documentElement.classList.toggle("light",Boolean(e)),document.body.classList.toggle("light",Boolean(e)),us()},toggleGridInfo:function(){$i=!$i,us({showGridSizeInfo:$i}),Xa()},alignAllCrops:function(e){$r.forEach(t=>{switch(e){case"top":t.crop.y=0;break;case"middle":t.crop.y=(t.height-t.crop.height)/2;break;case"bottom":t.crop.y=t.height-t.crop.height}}),no()},toggleSplitPreview:function(){fo(hi?"single":"split-horizontal")},setPreviewLayout:fo,togglePreviewFullscreen:mo,closePreview:Co,testExport:function(){if(qr)return fi&&!hi?(zo(),Ci="none",void na()):(Po($r.find(e=>e.id===qr)),Ci="full",void na())},toggleProfiles:os,saveProfile:function(){const e=function(){const e=document.getElementById("exportWidth").value,t=document.getElementById("exportHeight").value,n=sa(),r=document.getElementById("exportFormat").value.toUpperCase(),i=aa(),a=parseFloat(document.getElementById("aspectW").value),o=parseFloat(document.getElementById("aspectH").value),s=Number.isFinite(a)&&Number.isFinite(o)&&o>0;let l="";(i===Kr||i===ei)&&e&&t?l=`${e}:${t}`:i===Jr&&s&&(l=`${a}:${o}`);const c=[];return i===oi?c.push(`${n}%`):e&&t&&i!==Jr&&c.push(`${e}x${t}`),l&&c.push(`${l}`),c.push(r),c.join(" ")}(),t=xi||e,n=window.prompt("Profile name",t);if(null===n)return;const r=n.trim()||xi||e,i={name:r,exportWidth:parseInt(document.getElementById("exportWidth").value),exportHeight:parseInt(document.getElementById("exportHeight").value),scalePercent:sa(),resizeMode:aa(),aspectRatio:{width:1e3*Qr,height:1e3},exportFormat:document.getElementById("exportFormat").value,jpegQuality:parseInt(document.getElementById("jpegQuality").value),webpQuality:parseInt(document.getElementById("webpQuality").value),avifQuality:parseInt(document.getElementById("avifQuality").value),pngTransparency:document.getElementById("pngTransparency").checked,enableSharpening:document.getElementById("enableSharpening").checked,adaptiveSharpening:document.getElementById("adaptiveSharpening").checked,sharpenAmount:parseInt(document.getElementById("sharpenAmount").value),sharpenRadius:parseFloat(document.getElementById("sharpenRadius").value),sharpenThreshold:parseInt(document.getElementById("sharpenThreshold").value)},a=Ko(),o=a.findIndex(e=>e.name===r);if(-1!==o){if(!window.confirm(`Profile "${r}" exists. Overwrite it?`))return;a.splice(o,1,i)}else a.push(i);Jo(a),xi=r,Ei=!1,ki={...i},es(),vi&&rs()},clearProfileName:function(){xi="",Ei=!1,es()},revertProfileSettings:function(){ki&&ns(ki)},resetProfileToDefault:function(){ns(Wr,{applyDefaults:!0,setProfileName:!1,setLastLoaded:!1})},resetPreferences:function(){const e=Ko();localStorage.removeItem(Yr),Ii=!0;const t=Number.isFinite(Wr.exportWidth)?Wr.exportWidth:1920,n=Number.isFinite(Wr.exportHeight)?Wr.exportHeight:1080,r=Wr.aspectRatio&&Number.isFinite(Wr.aspectRatio.width)&&Number.isFinite(Wr.aspectRatio.height)?Wr.aspectRatio:{width:t,height:n};document.getElementById("exportWidth").value=t,document.getElementById("exportHeight").value=n;const i=document.getElementById("resizeMode");i&&(i.value=Wr.resizeMode||si,i.value||(i.value=si)),document.getElementById("exportFormat").value=Wr.exportFormat||"jpeg",document.getElementById("jpegQuality").value=Number.isFinite(Wr.jpegQuality)?Wr.jpegQuality:90,document.getElementById("webpQuality").value=Number.isFinite(Wr.webpQuality)?Wr.webpQuality:90,document.getElementById("avifQuality").value=Number.isFinite(Wr.avifQuality)?Wr.avifQuality:60,document.getElementById("jpegQualityNumber").value=Number.isFinite(Wr.jpegQuality)?Wr.jpegQuality:90,document.getElementById("webpQualityNumber").value=Number.isFinite(Wr.webpQuality)?Wr.webpQuality:90,document.getElementById("avifQualityNumber").value=Number.isFinite(Wr.avifQuality)?Wr.avifQuality:60,document.getElementById("pngTransparency").checked="boolean"!=typeof Wr.pngTransparency||Wr.pngTransparency,document.getElementById("previewDelay").value="0.5",document.getElementById("aboutAutoShow").checked=!0,document.getElementById("enableSharpening").checked="boolean"==typeof Wr.enableSharpening&&Wr.enableSharpening,document.getElementById("adaptiveSharpening").checked="boolean"==typeof Wr.adaptiveSharpening&&Wr.adaptiveSharpening,document.getElementById("sharpenAmount").value=Number.isFinite(Wr.sharpenAmount)?Wr.sharpenAmount:120,document.getElementById("sharpenRadius").value=Number.isFinite(Wr.sharpenRadius)?Wr.sharpenRadius:1,document.getElementById("sharpenThreshold").value=Number.isFinite(Wr.sharpenThreshold)?Wr.sharpenThreshold:10,document.getElementById("sharpenAmountNumber").value=Number.isFinite(Wr.sharpenAmount)?Wr.sharpenAmount:120,document.getElementById("sharpenRadiusNumber").value=Number.isFinite(Wr.sharpenRadius)?Wr.sharpenRadius:1,document.getElementById("sharpenThresholdNumber").value=Number.isFinite(Wr.sharpenThreshold)?Wr.sharpenThreshold:10;const a=document.getElementById("resizeEngine");a&&(a.value="jsquash");const o=document.getElementById("jsquashResizeMethod");o&&(o.value=Vr);const s=document.getElementById("photonResizeFilter");s&&(s.value=String(5));const l=document.getElementById("scalePercent");if(l){const e=Number.isFinite(Wr.scalePercent)?Wr.scalePercent:100;l.value=oa(e)}const c=document.getElementById("aspectW"),u=document.getElementById("aspectH");c&&u&&(c.value=r.width,u.value=r.height);const d=document.getElementById("themeToggle");d&&(d.checked=!1),$i=!1,Hi=!0,Hr=240,Xa(),document.documentElement.classList.remove("light"),document.body.classList.remove("light"),Qr=r.width/r.height,hs(0,r.width,r.height),Qo(!1),ga(),ba(),us({aspectRatio:{width:r.width,height:r.height},showGridSizeInfo:!1,showFilenameTip:!0,gridItemSize:240,profiles:e}),xi="",Ei=!1,ki=null,Ci="none",Ii=!1,es()},exportUserProfiles:function(){const e=Ko();if(!e.length)return;const t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download="batch-image-profiles.json",document.body.appendChild(i),i.click(),i.remove(),URL.revokeObjectURL(r)},importUserProfiles:function(){const e=document.getElementById("profileImportInput");e&&(e.value="",e.click())},closeAbout:Oa,openChangelog:function(){Oa(),document.getElementById("changelogModal").classList.add("active")},closeChangelog:Da,closeMobileWarning:function(){const e=document.getElementById("mobileWarning");e&&e.remove();const t=Pi;Pi=!0,ds({mobileWarningDismissed:!0}),Pi=t},closeExportPreview:zo}),function(){const e=document.getElementById("aspectPresetSelect");if(!e)return;e.innerHTML="";const t=document.createElement("option");t.value="",t.textContent="Select preset",e.appendChild(t),Nr.slice(0,30).forEach(t=>{const n=document.createElement("option");n.value=`${t.w}:${t.h}`,n.dataset.aspectW=t.w,n.dataset.aspectH=t.h,n.textContent=t.label||`${t.w}:${t.h}`,e.appendChild(n)}),e.addEventListener("change",()=>{const t=e.selectedOptions[0];t&&t.dataset.aspectW&&t.dataset.aspectH&&qo(parseInt(t.dataset.aspectW),parseInt(t.dataset.aspectH))})}(),function(){const e=Vo(),t=document.getElementById("mobileWarning");if(t&&(e.mobileWarningDismissed?t.remove():t.classList.remove("hidden")),document.documentElement.classList.add("no-theme-transition"),Ii=!0,Number.isFinite(e.exportWidth)&&(document.getElementById("exportWidth").value=e.exportWidth),Number.isFinite(e.exportHeight)&&(document.getElementById("exportHeight").value=e.exportHeight),Number.isFinite(e.scalePercent)){const t=document.getElementById("scalePercent");t&&(t.value=oa(e.scalePercent))}let n=e.resizeMode;n||"boolean"!=typeof e.lockAspect||(n=e.lockAspect?Kr:ei),n=n||si;const r=document.getElementById("resizeMode");r&&(r.value=n,r.value||(r.value=si)),e.exportFormat&&(document.getElementById("exportFormat").value=e.exportFormat),Number.isFinite(e.jpegQuality)&&(document.getElementById("jpegQuality").value=e.jpegQuality,document.getElementById("jpegQualityNumber").value=e.jpegQuality),Number.isFinite(e.webpQuality)&&(document.getElementById("webpQuality").value=e.webpQuality,document.getElementById("webpQualityNumber").value=e.webpQuality),Number.isFinite(e.avifQuality)&&(document.getElementById("avifQuality").value=e.avifQuality,document.getElementById("avifQualityNumber").value=e.avifQuality),"boolean"==typeof e.pngTransparency&&(document.getElementById("pngTransparency").checked=e.pngTransparency),e.previewDelay?document.getElementById("previewDelay").value=e.previewDelay:document.getElementById("previewDelay").value="0.5",$i=Boolean(e.showGridSizeInfo),Hi=!1!==e.showFilenameTip,Number.isFinite(e.gridItemSize)&&(Hr=Math.max(160,Math.min(800,Math.round(e.gridItemSize)))),e.lastExportPreviewMode&&(Ci=e.lastExportPreviewMode,"split"===Ci&&(Ci="split-horizontal")),"boolean"==typeof e.enableSharpening&&(document.getElementById("enableSharpening").checked=e.enableSharpening),"boolean"==typeof e.adaptiveSharpening&&(document.getElementById("adaptiveSharpening").checked=e.adaptiveSharpening),Number.isFinite(e.sharpenAmount)&&(document.getElementById("sharpenAmount").value=e.sharpenAmount,document.getElementById("sharpenAmountNumber").value=e.sharpenAmount),Number.isFinite(e.sharpenRadius)&&(document.getElementById("sharpenRadius").value=e.sharpenRadius,document.getElementById("sharpenRadiusNumber").value=e.sharpenRadius),Number.isFinite(e.sharpenThreshold)&&(document.getElementById("sharpenThreshold").value=e.sharpenThreshold,document.getElementById("sharpenThresholdNumber").value=e.sharpenThreshold);let i=e.resizeEngine;i||(i="boolean"==typeof e.usePhotonResize&&e.usePhotonResize?"photon":"jsquash");const a=document.getElementById("resizeEngine");a&&(a.value=i,a.value||(a.value="jsquash"));const o=document.getElementById("jsquashResizeMethod");if(o){const t=e.jsquashResizeMethod||Vr;o.value=t,o.value||(o.value=Vr)}const s=document.getElementById("photonResizeFilter");if(s){const t=Number.isFinite(e.photonSamplingFilter)?String(Math.min(5,Math.max(1,e.photonSamplingFilter))):String(5);s.value=t,s.value||(s.value=String(5))}if(e.aspectRatio&&Number.isFinite(e.aspectRatio.width)&&Number.isFinite(e.aspectRatio.height)){Qr=e.aspectRatio.width/e.aspectRatio.height,hs(0,e.aspectRatio.width,e.aspectRatio.height);const t=document.getElementById("aspectW"),n=document.getElementById("aspectH");t&&n&&(t.value=e.aspectRatio.width,n.value=e.aspectRatio.height)}else{const e=parseInt(document.getElementById("exportWidth").value),t=parseInt(document.getElementById("exportHeight").value);e&&t&&(Qr=e/t,ro())}if(aa()===ei){const e=parseInt(document.getElementById("exportWidth").value),t=parseInt(document.getElementById("exportHeight").value);Number.isFinite(e)&&Number.isFinite(t)&&t>0&&(Qr=e/t,ro())}if(Qo(!1),ga(),ba(),ps(),"boolean"==typeof e.lightMode){document.documentElement.classList.toggle("light",e.lightMode),document.body.classList.toggle("light",e.lightMode);const t=document.getElementById("themeToggle");t&&(t.checked=e.lightMode)}requestAnimationFrame(()=>{document.documentElement.classList.remove("no-theme-transition")}),Ii=!1,es(),Xa(),is(),Ka(),Ya(),Ho(),xo()}(),so(),lo(),na(),Ma(),function(){const e=Vo();return"boolean"!=typeof e.showAboutOnLoad||e.showAboutOnLoad}()&&Wa(),es(),Pi=!1,cs(),document.body.classList.remove("app-initializing")})()})();
//# sourceMappingURL=main.js.map